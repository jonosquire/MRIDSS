(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    359775,       9004]
NotebookOptionsPosition[    355828,       8866]
NotebookOutlinePosition[    356188,       8882]
CellTagsIndexPosition[    356145,       8879]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generate c++ equations", "Title",
 CellChangeTimes->{{3.613285659385439*^9, 3.613285672183166*^9}}],

Cell["\<\
A notebook to automatically generate the complex equations (in c++ syntax) \
required for CE2 implementations of the shearing box MHD equations\
\>", "Subtitle",
 CellChangeTimes->{{3.613285678399642*^9, 3.6132857387259073`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.61328575477813*^9, 3.6132857579772587`*^9}, {
  3.613289305138309*^9, 3.6132893099360237`*^9}}],

Cell[CellGroupData[{

Cell["Load packages, set notation, define derivative operators", \
"Subsubsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.61328647880902*^9, 3.6132864845926*^9}, {
  3.61328657764961*^9, 3.613286579073427*^9}, {3.614183666778463*^9, 
  3.614183671737118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "Notation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Notation`AutoLoadNotationPalette", "}"}], ",", "\n", "\t", 
     
     RowBox[{
      RowBox[{"Notation`AutoLoadNotationPalette", "=", "False"}], ";", "\n", 
      "\t", 
      RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], ";"}]}], "\n", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{OverscriptBox["\[Nu]", "\[Dash]"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"\[Nu]b"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{OverscriptBox["\[Eta]", "\[LongDash]"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"\[Eta]b"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"iLap2"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"iLapF"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Notation", "[", 
    RowBox[{
     TemplateBox[{SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]]},
      "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
     TemplateBox[{"iLapFColl"},
      "NotationTemplateTag"]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["\[PartialD]", "z"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"dz"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["\[PartialD]", "t"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"dt"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[ScriptCapitalR]", "x"], "B"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ReyBx"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[ScriptCapitalR]", "y"], "B"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ReyBy"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["B", "x"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"Bx"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["B", "y"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"By"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["B", "z0"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"B0z"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["k", "y"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ky"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["k", "x"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"kx"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"kxb"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{"\[SmallCircle]"},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ph"},
       "NotationTemplateTag"]}], "]"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Place", "-", 
     RowBox[{
     "holder", " ", "for", " ", "the", " ", "operator", " ", "matrix"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"C", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"a_", "\[InvisibleComma]", "b_"}]]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{RowBox[{"Cm", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Conjugates", " ", 
     RowBox[{"(", 
      RowBox[{"for", " ", "Reynolds", " ", "stress"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox["a_", "*"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{RowBox[{"conj", "[", "a_", "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "iLapF", ",", " ", "iLap2", ",", " ", "dz", ",", " ", "dt", ",", " ", 
     "properties"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "iLap2"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"iLap2", "[", "a", "]"}], "+", " ", 
      RowBox[{"iLap2", "[", "b", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"kxb", "^", "n"}], " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
     "security"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"ky", "^", "n"}], " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{"dz", "[", "a_", "]"}], "]"}], ":=", 
     RowBox[{"dz", "[", 
      RowBox[{"iLap2", "[", "a", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "dz"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"dz", "[", "a", "]"}], "+", " ", 
      RowBox[{"dz", "[", "b", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["kxb", "n"], " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
     "security"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"ky", "^", "n"}], " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dz", "[", "0", "]"}], ":=", "0"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Product", " ", 
     RowBox[{"rule", " ", "--"}], " ", "could", " ", "add", " ", "this"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "dt"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"dt", "[", "a", "]"}], "+", " ", 
      RowBox[{"dt", "[", "b", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"dt", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"kxb", "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"q", " ", "ky", " ", "a"}], "+", " ", 
      RowBox[{"kxb", " ", 
       RowBox[{"dt", "[", "a", "]"}]}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
     "security"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["ky", "n"], " ", 
      RowBox[{"dt", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"dt", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Goes", " ", "inside", " ", "iLap2", " ", "and", " ", "dz"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"dz", "[", "a_", "]"}], "]"}], ":=", 
     RowBox[{"dz", "[", 
      RowBox[{"dt", "[", "a", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"iLap2", "[", "a_", "]"}], "]"}], ":=", 
     RowBox[{"iLap2", "[", 
      RowBox[{"dt", "[", "a", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "iLapF"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"iLapF", "[", "a", "]"}], "+", " ", 
      RowBox[{"iLapF", "[", "b", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"kxb", "^", "n"}], " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
     "security"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"ky", "^", "n"}], " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Another", " ", "version", " ", "of", " ", "iLapF", " ", "to", " ", 
     "easily", " ", "collect", " ", "together", " ", "different", " ", 
     "terms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "iLapFColl"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iLapFColl", "/:", 
     RowBox[{
      RowBox[{"c_", "?", "NumericQ"}], "  ", 
      RowBox[{"iLapFColl", "[", "a_", "]"}]}], ":=", " ", 
     RowBox[{"iLapFColl", "[", 
      RowBox[{"c", " ", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iLapFColl", "/:", 
     RowBox[{
      RowBox[{"iLapFColl", "[", "a_", "]"}], "+", " ", 
      RowBox[{"iLapFColl", "[", "b_", "]"}]}], ":=", 
     RowBox[{"iLapFColl", "[", 
      RowBox[{"a", "+", "b"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"iLapFColl", "/:", 
    RowBox[{
     RowBox[{"kxb", "^", "n_."}], 
     RowBox[{"iLapFColl", "[", "a_", "]"}]}], ":=", 
    RowBox[{"iLapFColl", "[", 
     RowBox[{
      RowBox[{"kxb", "^", "n"}], "  ", "a"}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{"iLapFColl", "/:", 
    RowBox[{
     RowBox[{"ky", "^", "n_."}], 
     RowBox[{"iLapFColl", "[", "a_", "]"}]}], ":=", 
    RowBox[{"iLapFColl", "[", 
     RowBox[{
      RowBox[{"ky", "^", "n"}], "  ", "a"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"iLapFColl", "/:", 
    RowBox[{
     RowBox[{"q", "^", "n_."}], 
     RowBox[{"iLapFColl", "[", "a_", "]"}]}], ":=", 
    RowBox[{"iLapFColl", "[", 
     RowBox[{
      RowBox[{"q", "^", "n"}], "  ", "a"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.613286581090721*^9, 3.613286689545772*^9}, {
   3.613286889064035*^9, 3.613286908104281*^9}, {3.6132869482086487`*^9, 
   3.613287077374654*^9}, {3.613287138618946*^9, 3.613287140299769*^9}, {
   3.613287639148213*^9, 3.61328770120146*^9}, {3.613287743803678*^9, 
   3.613287773644068*^9}, {3.613288296843178*^9, 3.6132883066816053`*^9}, {
   3.613289870472352*^9, 3.6132898912000837`*^9}, {3.61328995953846*^9, 
   3.613290012328433*^9}, {3.613290091978758*^9, 3.613290110587739*^9}, {
   3.613291002983233*^9, 3.613291016787397*^9}, {3.613291128786306*^9, 
   3.613291140328432*^9}, {3.613291418191675*^9, 3.6132914298902397`*^9}, {
   3.613291787958507*^9, 3.613291883632246*^9}, {3.6132919180813*^9, 
   3.613291942156289*^9}, {3.613292008007991*^9, 3.613292106813635*^9}, {
   3.613293045356043*^9, 3.6132930675783167`*^9}, 3.613293376925857*^9, 
   3.613294621138084*^9, {3.613294694017054*^9, 3.6132947784060097`*^9}, {
   3.613294902803031*^9, 3.6132949806439133`*^9}, 3.6132950396930437`*^9, {
   3.613295346076227*^9, 3.613295481543404*^9}, {3.6132960472516212`*^9, 
   3.613296061097188*^9}, {3.6132961003100023`*^9, 3.613296118980667*^9}, {
   3.613297482407709*^9, 3.6132974934385366`*^9}, {3.613300728518897*^9, 
   3.613300783695135*^9}, {3.613304633293589*^9, 3.613304670793342*^9}, {
   3.613305007338643*^9, 3.613305011424444*^9}, {3.613305054166004*^9, 
   3.613305169291284*^9}, {3.6133262584563932`*^9, 3.613326328142644*^9}, {
   3.613327278627614*^9, 3.613327286046043*^9}, {3.613327328030073*^9, 
   3.613327350931031*^9}, {3.613327392030846*^9, 3.613327432040532*^9}, {
   3.6133292064048977`*^9, 3.613329250947644*^9}, {3.614183755836158*^9, 
   3.614183884767324*^9}, {3.614184743932043*^9, 3.614184895192746*^9}, {
   3.614185078050617*^9, 3.614185081522999*^9}, {3.6141859311896067`*^9, 
   3.614185935756172*^9}, {3.614967885563236*^9, 3.614967917730885*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Full incompressible nonlinear equations", "Subsubsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.613285885535736*^9, 3.613285889538149*^9}, {
  3.613286361952444*^9, 3.613286368230513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Standard", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xtv", "=", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xv", "=", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fullNLvars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "ux", ",", "uy", ",", "uz", ",", "bx", ",", "by", ",", "bz", ",", "p"}],
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"momeqn", ",", "adveqn", ",", "uv", ",", "Bv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uv", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "q"}], " ", "x"}], ",", "0"}], "}"}], "+", 
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ux", ",", "uy", ",", "uz"}], "}"}], "@@", "xtv"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "B0z"}], "}"}], "+", 
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bx", ",", "by", ",", "bz"}], "}"}], "@@", "xtv"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"momeqn", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"uv", ",", "t"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{"uv", ",", "xv"}], "]"}], ".", "uv"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "uv"}], 
            "]"}]}]}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", " ", 
           RowBox[{"Grad", "[", 
            RowBox[{
             RowBox[{"p", "@@", "xtv"}], ",", "xv"}], "]"}]}], "+", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Grad", "[", 
             RowBox[{"Bv", ",", "xv"}], "]"}], ".", "Bv"}], ")"}], "+", 
          RowBox[{"2", " ", "q", " ", "x", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "+", 
          RowBox[{"\[Nu]b", " ", 
           RowBox[{"Laplacian", "[", 
            RowBox[{"uv", ",", "xv"}], "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"adveqn", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Bv", ",", "t"}], "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"Curl", "[", 
             RowBox[{
              RowBox[{"Cross", "[", 
               RowBox[{"uv", ",", "Bv"}], "]"}], ",", "xv"}], "]"}], "+", 
            RowBox[{
             RowBox[{"1", "/", "ReB"}], " ", 
             RowBox[{"Laplacian", "[", 
              RowBox[{"Bv", ",", "xv"}], "]"}]}]}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"adveqn", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"Bv", ",", "t"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{"Bv", ",", "xv"}], "]"}], ".", "uv"}]}], "==", 
         RowBox[{
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{"uv", ",", "xv"}], "]"}], ".", "Bv"}], "+", 
          RowBox[{"\[Eta]b", " ", 
           RowBox[{"Laplacian", "[", 
            RowBox[{"Bv", ",", "xv"}], "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullNLeqns", " ", "=", " ", 
       RowBox[{"Subtract", "@@@", 
        RowBox[{"Join", "[", 
         RowBox[{"momeqn", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Div", "[", 
             RowBox[{"uv", ",", "xv"}], "]"}], "\[Equal]", "0"}], "}"}], ",", 
          "adveqn", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Div", "[", 
             RowBox[{"Bv", ",", "xv"}], "]"}], "\[Equal]", "0"}], "}"}]}], 
         "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Translation", " ", "to", " ", "Orr"}], "-", 
     RowBox[{"Somerfeld", " ", "variables"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toOrrSomerVars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ux", "\[Rule]", "u"}], ",", "\[IndentingNewLine]", 
       RowBox[{"uy", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", "ky", " ", 
             RowBox[{"u", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}], "+", 
            RowBox[{"dz", "[", 
             RowBox[{"\[Zeta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "]"}]}], "  ", "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"uz", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", 
             RowBox[{"dz", "[", 
              RowBox[{"u", "[", 
               RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
            RowBox[{"ky", " ", 
             RowBox[{"\[Zeta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}]}], "]"}]}], "  ", "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"bx", "\[Rule]", "b"}], ",", "\[IndentingNewLine]", 
       RowBox[{"by", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", "ky", " ", 
             RowBox[{"b", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}], "+", 
            RowBox[{"dz", "[", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "]"}]}], "  ", "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"bz", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", 
             RowBox[{"dz", "[", 
              RowBox[{"b", "[", 
               RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
            RowBox[{"ky", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}]}], "]"}]}], "  ", "]"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.6132862687853317`*^9, 3.613286292131226*^9}, {
   3.613286330331258*^9, 3.613286331235854*^9}, {3.613286373825049*^9, 
   3.613286475100573*^9}, {3.613286523742776*^9, 3.613286574022657*^9}, {
   3.6132867177659683`*^9, 3.613286844785708*^9}, {3.6132873426960707`*^9, 
   3.613287392767021*^9}, {3.613287431872316*^9, 3.613287444161961*^9}, {
   3.61328749525042*^9, 3.6132874981609697`*^9}, 3.6132875535430107`*^9, {
   3.613287602021194*^9, 3.613287632745328*^9}, {3.613287713936445*^9, 
   3.61328773864904*^9}, {3.6132877787380657`*^9, 3.613288005757513*^9}, {
   3.613288060071485*^9, 3.6132881345693483`*^9}, {3.613288346385255*^9, 
   3.6132883794041157`*^9}, {3.613288504050708*^9, 3.6132885207745028`*^9}, {
   3.6132887600893497`*^9, 3.613288768182979*^9}, {3.6132888149004593`*^9, 
   3.613288846333804*^9}, {3.613291099035706*^9, 3.613291118427603*^9}, {
   3.613291553896966*^9, 3.6132916298613873`*^9}, {3.613291661000248*^9, 
   3.6132917251562147`*^9}, {3.613294580957465*^9, 3.613294612091785*^9}}],

Cell["\<\
Generate rules to cancel iLap2 with kz and ky -- This \
doesn\[CloseCurlyQuote]t manage (ky^2+kz^2)^2 *iLap2^2 but only in diffusion?
Also, write down rule for iLapF\
\>", "Text",
 CellChangeTimes->{{3.613300877715733*^9, 3.613300900090197*^9}, {
  3.613301616734581*^9, 3.613301651038678*^9}, {3.613305186229371*^9, 
  3.6133052083324423`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"baseExplicitLap2Rule", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{"dz", "[", 
       RowBox[{"iLap2", "[", "f_", "]"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"ky", "^", "2"}], " ", 
      RowBox[{"iLap2", "[", "f_", "]"}]}]}], "\[RuleDelayed]", " ", "f"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", "combinations", ",", "r2l", ",", 
      "l2r", ",", "kyf", ",", "baseRule", ",", "operateOnRule"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Operates", " ", "with", " ", "dz", " ", "and", " ", "ky", " ", "to", 
      " ", "generalize", " ", "rule"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Generate", " ", "the", " ", "possible", " ", "combinations"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r2l", " ", "=", " ", 
      RowBox[{"RuleDelayed", "\[Rule]", "List"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"l2r", " ", "=", " ", 
      RowBox[{"List", "\[Rule]", "RuleDelayed"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kyf", " ", "=", " ", 
      RowBox[{
       RowBox[{"ky", " ", "#"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"combinations", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "order"}], "]"}], ",", "2"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a_", ",", "b_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"a", "+", "b"}], "\[LessEqual]", "order"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"combinations", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"dz", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"kyf", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "]"}]}], "}"}], "]"}], "&"}], "/@", "combinations"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "combinations", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"#", "&"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Function", " ", "to", " ", "operate", " ", "on", " ", "both", " ", 
       "sides", " ", "of", " ", "base", " ", "rule", " ", "with", " ", "a", 
       " ", "chosen", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"baseRule", "=", 
      RowBox[{"baseExplicitLap2Rule", "/.", "r2l"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"operateOnRule", " ", "=", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rule", ",", "func"}], "}"}], ",", 
        RowBox[{"(*", " ", 
         RowBox[{
         "func", " ", "is", " ", "function", " ", "with", " ", "which", " ", 
          "to", " ", "operate", " ", "of", " ", "each", " ", "side"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "/@", 
         RowBox[{"Expand", "/@", 
          RowBox[{"func", "/@", "rule"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"explicitLap2Rule", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "/.", "l2r"}], "&"}], "/@", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c_.", ",", "c"}], "}"}], " ", "#"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Fold", "[", 
             RowBox[{"operateOnRule", ",", "baseRule", ",", "#"}], "]"}], 
            "&"}], "/@", "combinations"}], ")"}]}], "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"explicitLapFRule", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "2"}], " ", "f_"}], "]"}], "+", 
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"ky", "^", "2"}], " ", "f_"}], "]"}], "+", 
     RowBox[{"iLapF", "[", 
      RowBox[{"dz", "[", 
       RowBox[{"dz", "[", "f_", "]"}], "]"}], "]"}]}], "\[RuleDelayed]", 
    "f"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.613301578032633*^9, 3.613301578138397*^9}, {
  3.6133016143342333`*^9, 3.613301614494217*^9}, {3.613305212858172*^9, 
  3.6133052855307627`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Useful functions", "Subsubsection",
 CellChangeTimes->{{3.613289315465055*^9, 3.613289319164629*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Better", " ", "version", " ", "of", " ", "linearize"}], ",", " ", 
    RowBox[{
    "works", " ", "on", " ", "expressions", " ", "in", " ", "denominator", 
     " ", "and", " ", "multiple", " ", "variables"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"Remove", "[", "linearize", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"linearize", "[", 
     RowBox[{"expr_", ",", "vars_List", ",", "indvars_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dlist", ",", "fullvars", ",", "t"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "full", " ", "list"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dlist", "=", 
        RowBox[{"Permutations", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"indvars", ",", "4"}], "]"}], "]"}], ",", "4"}], "]"}]}], 
       ";", 
       RowBox[{"fullvars", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"vars", "@@", "indvars"}], "]"}], ",", 
             RowBox[{"Sequence", "@@", "#"}]}], "]"}], "&"}], "/@", "dlist"}],
          "]"}]}], ";", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"expr", "/.", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "->", 
                 RowBox[{"t", " ", "#"}]}], "&"}], "/@", "fullvars"}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
         RowBox[{"t", "->", "1"}]}], "]"}]}]}], "\n", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "plusToList"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plusToList", "::", "unrecExpr"}], " ", "=", " ", 
     "\"\<Warning: head is not Times, Plus or Symbol\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plusToList", "[", "expr_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "expr", "]"}], "===", "Plus"}], ",", " ", 
       RowBox[{"List", "@@", "expr"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "expr", "]"}], "===", "Times"}], " ", "||", 
          RowBox[{
           RowBox[{"Head", "[", "expr", "]"}], "===", "Symbol"}]}], ",", 
         RowBox[{"{", "expr", "}"}], ",", " ", 
         RowBox[{"Message", "[", 
          RowBox[{"plusToList", "::", "unrecExpr"}], "]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "MapMatrix"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapMatrix", "[", 
     RowBox[{"f_", ",", "list_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{"f", ",", "list", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Convert", " ", "products", " ", "of", " ", "terms", " ", "to", " ", "a", 
     " ", "string", " ", "that", " ", "can", " ", "be", " ", "used", " ", 
     "as", " ", "a", " ", "variable", " ", "in", " ", 
     RowBox[{"c", "++"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "convertProdToString"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"convertProdToString", "[", "term_", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<T\>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"term", ",", 
          RowBox[{"FormatType", "\[Rule]", "InputForm"}]}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<*\>\"", "\[Rule]", "\"\<T\>\""}], ",", 
        RowBox[{"\"\<-\>\"", "\[Rule]", "\"\<m\>\""}], ",", 
        RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<\>\""}], ",", 
        RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<\>\""}], ",", 
        RowBox[{"\"\<^\>\"", "\[Rule]", "\"\<P\>\""}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.61328934611686*^9, 3.613289382147559*^9}, {
  3.613291155498661*^9, 3.6132911618903112`*^9}, {3.6133280970501957`*^9, 
  3.6133283216730957`*^9}, {3.614192140790101*^9, 3.614192148272378*^9}, {
  3.614194375038121*^9, 3.614194397693001*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic Quasi-linear", "Section",
 CellChangeTimes->{{3.6132857813215227`*^9, 3.613285785435519*^9}}],

Cell[TextData[{
 "Quasi-linear equations including only interactions of fluctuations with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "y"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.613285788264741*^9, 3.613285816975567*^9}, {
  3.6132858538148127`*^9, 3.613285857694859*^9}}],

Cell[CellGroupData[{

Cell["Derive equations", "Subsection",
 CellChangeTimes->{{3.613285862743395*^9, 3.613285865310978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numVariables", " ", "=", " ", "4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zt", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"z", ",", "t"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanFields", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "By", ",", "0", ",", "0"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanFieldsWDerivs", " ", "=", " ", 
   RowBox[{"Rest", "@", 
    RowBox[{"Union", "[", 
     RowBox[{"Join", "[", 
      RowBox[{"meanFields", ",", 
       RowBox[{"dz", "/@", "meanFields"}], ",", 
       RowBox[{"dz", "/@", 
        RowBox[{"dz", "/@", "meanFields"}]}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanFieldQ", " ", "=", " ", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"meanFieldsWDerivs", ",", "#"}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullMFeqns", " ", "=", " ", 
    RowBox[{"Subtract", "@@@", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Bx", "@@", "zt"}], ",", "t"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"ReyBx", "@@", "zt"}], "+", 
         RowBox[{"\[Eta]b", " ", 
          RowBox[{"Bx", "@@", "zt"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"By", "@@", "zt"}], ",", "t"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q"}], " ", 
          RowBox[{"Bx", "@@", "zt"}]}], "+", 
         RowBox[{"ReyBy", "@@", "zt"}], "+", 
         RowBox[{"\[Eta]b", " ", 
          RowBox[{"By", "@@", "zt"}]}]}]}], ",", "0"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plug", " ", "in", " ", "mean", " ", "field"}], " ", "+", " ", 
    RowBox[{
    "fluctuations", " ", "into", " ", "NL", " ", "equations", " ", "and", " ",
      "linearize"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NL2fluct", ",", "fourierRules"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NL2fluct", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "fullNLvars", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "meanFields", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "@@", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "t"}], "}"}]}], "+", 
               RowBox[{
                RowBox[{
                "fullNLvars", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "@@", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}]}]}], "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0", "[", "__", "]"}], ")"}], "\[Rule]", "0"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "fullNLvars", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Plug", " ", "in", " ", "to", " ", "full", " ", "equations", " ", 
        "and", " ", "linearize"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"linearize", "[", 
          RowBox[{"#", ",", "fullNLvars", ",", "xtv"}], "]"}], "&"}], "/@", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"fullNLeqns", "/.", "NL2fluct"}], "/.", 
          RowBox[{"B0z", "\[Rule]", "0"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "fullFluctEqs", " ", "still", " ", "contain", " ", "a", " ", "mean", 
        " ", "field", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Shearing", " ", "wave", " ", "expansion"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fourierRules", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "var", "}"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"var", "\[Rule]", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"Evaluate", "@", "xtv"}], ",", 
              RowBox[{
               RowBox[{"var", "[", 
                RowBox[{"z", ",", "t"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"kx", "+", 
                    RowBox[{"q", " ", "t", " ", "ky"}]}], ")"}], "x"}], " ", 
                 "+", " ", 
                 RowBox[{"\[ImaginaryI]", " ", "ky", " ", "y"}]}], "]"}]}]}], 
             "]"}]}], "]"}]}], "]"}], "/@", "fullNLvars"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fullFluctEqs", "/.", "fourierRules"}], ")"}], "/", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"kx", "+", 
              RowBox[{"q", " ", "t", " ", "ky"}]}], ")"}], "x"}], " ", "+", 
           " ", 
           RowBox[{"\[ImaginaryI]", " ", "ky", " ", "y"}]}], "]"}]}], "]"}]}],
       ";", 
      RowBox[{"(*", 
       RowBox[{
       "Shearing", " ", "wave", " ", "in", " ", "x", " ", "and", " ", "y"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{"fullFluctEqs", "/.", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["k", "x"], "+", 
              RowBox[{
               SubscriptBox["k", "y"], " ", "q", " ", "t"}]}], ")"}], " ", 
            "x"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["k", "y"], " ", "y"}]}]], "\[Rule]", "0"}]}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Remove", " ", "mean", " ", "components"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"fullFluctEqs", "/.", 
          RowBox[{"kx", "\[Rule]", 
           RowBox[{"kxb", "-", 
            RowBox[{"q", " ", "t", " ", "ky"}]}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kxb", "\[Rule]", 
            RowBox[{"kxb", "/", "\[ImaginaryI]"}]}], ",", 
           RowBox[{"ky", "\[Rule]", 
            RowBox[{"ky", "/", "\[ImaginaryI]"}]}]}], "}"}]}], "//", 
        "Expand"}]}]}]}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Use", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "_"]}], "=", 
      RowBox[{
       SubscriptBox["k", "x"], "+", 
       RowBox[{
        SubscriptBox["qtk", "y"], " ", "as", " ", "in", " ", 
        RowBox[{"c", "++"}], " ", "code"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Derive", " ", "Orr"}], "-", 
     RowBox[{"Somerfeld", " ", "like", " ", "equations"}]}], ",", " ", 
    RowBox[{
     RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "reduce", " ", 
     "other", " ", "equations"}], ",", " ", 
    RowBox[{
    "just", " ", "write", " ", "down", " ", "equations", " ", "for", " ", 
     RowBox[{"Lap", "[", "u", "]"}]}], ",", "\[Zeta]", ",", "b", ",", 
    "\[Eta]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"derivRules", ",", "LapMGradDiv1", ",", "manualSub"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"derivRules", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"n_", ",", "m_"}], "]"}], "[", "a_", "]"}], "[", "vs__", 
         "]"}], "\[RuleDelayed]", 
        RowBox[{"Nest", "[", 
         RowBox[{"dt", ",", 
          RowBox[{"Nest", "[", 
           RowBox[{"dz", ",", 
            RowBox[{"a", "[", "vs", "]"}], ",", "n"}], "]"}], ",", "m"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LapMGradDiv1", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kxb", "^", "2"}], "+", 
            RowBox[{"ky", "^", "2"}]}], ")"}], 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "z", ",", "z"}], "]"}], "-", 
         RowBox[{"kxb", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kxb", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"ky", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              ",", "z"}], "]"}]}], ")"}]}]}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"finalEqs", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"iLapF", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"LapMGradDiv1", "[", 
                 RowBox[{"fullFluctEqs", "/.", 
                  RowBox[{"\[Nu]b", "\[Rule]", "0"}]}], "]"}], "/.", 
                "derivRules"}], "/.", "toOrrSomerVars"}], "]"}], "//.", 
             "explicitLap2Rule"}], "]"}], "/.", "explicitLapFRule"}], "//", 
          "Expand"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                 "fullFluctEqs", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "-", 
               RowBox[{"ky", " ", 
                RowBox[{
                "fullFluctEqs", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Nu]b", "\[Rule]", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "fullFluctEqs", "\[LeftDoubleBracket]", "5", 
               "\[RightDoubleBracket]"}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Eta]b", "\[Rule]", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                 "fullFluctEqs", "\[LeftDoubleBracket]", "6", 
                  "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "-", 
               RowBox[{"ky", " ", 
                RowBox[{
                "fullFluctEqs", "\[LeftDoubleBracket]", "7", 
                 "\[RightDoubleBracket]"}]}]}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Eta]b", "\[Rule]", "0"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Fix", " ", "these", " ", "up", " ", "manually"}], " ", "-", 
        " ", 
        RowBox[{"sometimes", " ", "much", " ", "easier"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"This", " ", "is", " ", "plugging", " ", "in", " ", 
         RowBox[{"iLapF", "[", "lapF", "]"}]}], " ", "=", " ", 
        RowBox[{
        "1", " ", "in", " ", "the", " ", "more", " ", "complicated", " ", 
         "situation"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"finalEqs", "=", 
       RowBox[{"finalEqs", "/.", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"-", "ky"}], " ", 
           RowBox[{"iLapF", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["kxb", "2"], " ", "#"}], "+", 
                  RowBox[{
                   RowBox[{"ky", "^", "2"}], " ", "#"}], "+", 
                  RowBox[{"D", "[", 
                   RowBox[{"#", ",", "z", ",", "z"}], "]"}]}], ")"}], "&"}], 
               "[", 
               RowBox[{
                RowBox[{"b", "[", 
                 RowBox[{"z", ",", "t"}], "]"}], " ", 
                RowBox[{"By", "[", 
                 RowBox[{"z", ",", "t"}], "]"}]}], "]"}], ")"}], "/.", 
             "derivRules"}], "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"-", " ", "ky"}], " ", 
          RowBox[{"b", "[", 
           RowBox[{"z", ",", "t"}], "]"}], 
          RowBox[{"By", "[", 
           RowBox[{"z", ",", "t"}], "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", ",", " ", 
    RowBox[{"form", " ", "the", " ", "A", " ", "matrix"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"redvars", " ", "=", 
   RowBox[{"{", 
    RowBox[{"u", ",", "\[Zeta]", ",", "b", ",", "\[Eta]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"finalEqs", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"finalEqs", "\[Equal]", "0"}], "]"}], ",", 
       RowBox[{"dt", "/@", 
        RowBox[{"(", 
         RowBox[{"Through", "[", 
          RowBox[{"redvars", "@@", 
           RowBox[{"{", 
            RowBox[{"z", ",", "t"}], "}"}]}], "]"}], ")"}]}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";"}], 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Solve", " ", "for", " ", "time"}], "-", "derivatives"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Aop", " ", "=", " ", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "var", "}"}], ",", 
          RowBox[{
           RowBox[{"Plus", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"var", "[", 
                    RowBox[{"z", ",", "t"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
                 "#", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{"plusToList", "@", 
                RowBox[{
                "finalEqs", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ")"}]}], "]"}]}], "/.", 
           RowBox[{
            RowBox[{"var", "[", 
             RowBox[{"z", ",", "t"}], "]"}], "\[Rule]", "ph"}]}]}], "]"}], "/@",
         "redvars"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}], "//", 
   "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "matches", " ", "my", " ", "previously", " ", "derived", " ", 
    
    RowBox[{"(", 
     RowBox[{"by", " ", "hand"}], ")"}], " ", "version"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.613288323045455*^9, 3.613288326117752*^9}, {
   3.613288389643783*^9, 3.613288407039393*^9}, {3.613288479968417*^9, 
   3.613288487728981*^9}, {3.613288573589717*^9, 3.613288752358992*^9}, {
   3.613288852631976*^9, 3.613288916198966*^9}, {3.613288986990489*^9, 
   3.6132891926695137`*^9}, {3.613289423308837*^9, 3.613289432319971*^9}, {
   3.613289540309534*^9, 3.613289551704471*^9}, {3.613289593180532*^9, 
   3.613289597516069*^9}, {3.6132897828569527`*^9, 3.613289799551094*^9}, {
   3.613289832684938*^9, 3.613289857392364*^9}, {3.613289899387167*^9, 
   3.613289949003064*^9}, {3.613290022566579*^9, 3.613290072980708*^9}, {
   3.6132901333440037`*^9, 3.6132902277049723`*^9}, {3.613290347360075*^9, 
   3.613290348877283*^9}, {3.613290407662169*^9, 3.6132904199021072`*^9}, {
   3.613290617515009*^9, 3.613290693570179*^9}, {3.6132907374778633`*^9, 
   3.613290807808112*^9}, {3.6132911924799023`*^9, 3.613291195598812*^9}, {
   3.6132912379815063`*^9, 3.613291248693972*^9}, {3.613291280284522*^9, 
   3.613291408458893*^9}, {3.613291458080309*^9, 3.613291470927746*^9}, {
   3.6132915090035563`*^9, 3.613291525286358*^9}, {3.6132921232255783`*^9, 
   3.613292144859001*^9}, {3.613292297867838*^9, 3.613292316012755*^9}, 
   3.6132930883268547`*^9, {3.613293312306075*^9, 3.61329333079275*^9}, {
   3.6133006141405077`*^9, 3.61330070673322*^9}, {3.613300799309185*^9, 
   3.613300851120187*^9}, {3.613300912016116*^9, 3.6133009327016172`*^9}, {
   3.6133010023231773`*^9, 3.613301012699256*^9}, {3.6133010441561947`*^9, 
   3.613301156627*^9}, 3.6133013078550577`*^9, {3.613301447081024*^9, 
   3.613301449877001*^9}, {3.6133015415117207`*^9, 3.6133015541220617`*^9}, {
   3.6133016618658733`*^9, 3.613301704111124*^9}, {3.61330185743235*^9, 
   3.613301871088355*^9}, {3.613301910782558*^9, 3.6133019246441307`*^9}, {
   3.613301999871911*^9, 3.6133020708752737`*^9}, {3.61330239110786*^9, 
   3.613302487596188*^9}, {3.613302551646475*^9, 3.61330262406814*^9}, {
   3.6133045173899403`*^9, 3.6133045479377737`*^9}, {3.6133047488389683`*^9, 
   3.6133047694867353`*^9}, {3.613304829996623*^9, 3.613304868581319*^9}, {
   3.613304943519965*^9, 3.613304948407606*^9}, {3.6133053005957613`*^9, 
   3.613305319748056*^9}, {3.6133261571880493`*^9, 3.613326178299334*^9}, {
   3.613326367599222*^9, 3.613326560664708*^9}, {3.613326591582814*^9, 
   3.613326696955864*^9}, {3.613327160076173*^9, 3.613327161075317*^9}, {
   3.61332757642347*^9, 3.613327611115761*^9}, {3.613327657453199*^9, 
   3.613327813791049*^9}, {3.61332805091748*^9, 3.6133280531810827`*^9}, {
   3.613328083202976*^9, 3.613328090811761*^9}, 3.613328347059229*^9, {
   3.613328833019064*^9, 3.6133288553167562`*^9}, {3.6133291560666847`*^9, 
   3.613329177719489*^9}, 3.6141771183999968`*^9, {3.614189292301111*^9, 
   3.614189302092698*^9}, {3.614361699979642*^9, 3.614361719890554*^9}, {
   3.614504566104581*^9, 3.614504591016654*^9}, {3.614504663864559*^9, 
   3.614504666982682*^9}, {3.614545423593639*^9, 3.614545467974424*^9}, {
   3.614545503295141*^9, 3.614545505932638*^9}, {3.6145455804415207`*^9, 
   3.614545585925158*^9}, {3.614545671972193*^9, 3.614545700909773*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["k", "y"], " ", "q", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}], 
        "]"}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "y"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], 
         "]"}]}]}], 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}], 
       "+", 
       RowBox[{"q", " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}]}], 
      "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"]}], " ", "\[SmallCircle]", 
        " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "-", 
       RowBox[{
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}]},
     {
      RowBox[{
       SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}]}], "0", "0", "0"},
     {
      RowBox[{
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}], "]"}]}],
        "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "-", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        SubsuperscriptBox["k", "y", "2"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "q"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}], 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.613304869590173*^9, 3.6133049495007257`*^9, 3.6133053207405367`*^9, {
   3.613326485387342*^9, 3.613326561490202*^9}, {3.613326595815199*^9, 
   3.6133266040226097`*^9}, 3.613326660026622*^9, 3.61332716201223*^9, {
   3.6133275947793913`*^9, 3.613327612121537*^9}, {3.613327744727991*^9, 
   3.613327815555489*^9}, 3.613328054239262*^9, 3.613328356531164*^9, 
   3.613328856170669*^9, {3.613329165606255*^9, 3.613329178601987*^9}, 
   3.614177119713147*^9, 3.614189304110643*^9, 3.6143617220896473`*^9, 
   3.614504591952222*^9, 3.614504668409453*^9, 3.614542661480213*^9, 
   3.614545459261648*^9, 3.6145455874121523`*^9, {3.614545678856031*^9, 
   3.614545702075966*^9}, 3.614615776227653*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Working out the matrix product, and getting things into a \
\[OpenCurlyDoubleQuote]code convenient\[CloseCurlyDoubleQuote] form\
\>", "Subsection",
 CellChangeTimes->{{3.613329080723421*^9, 3.613329105297495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Cmat", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Cm", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numVariables"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "numVariables"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullMatrixEquations", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Aop", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"ph", "->", 
          RowBox[{"Cmat", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "numVariables"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "numVariables"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "numVariables"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Redefine", " ", "lapF", " ", "to", " ", "collect", " ", "as", " ", 
     "many", " ", "terms", " ", "as", " ", "possible"}], ",", " ", 
    RowBox[{"collect", " ", "in", " ", "mean", " ", "fields"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullMatrixEquations", "=", 
   RowBox[{"MapAll", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", "meanFieldsWDerivs"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"fullMatrixEquations", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Through", "[", 
          RowBox[{"meanFields", "@@", 
           RowBox[{"{", 
            RowBox[{"z", ",", "t"}], "}"}]}], "]"}], "->", "meanFields"}], 
        "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"Easier", " ", "to", " ", "look", " ", "at"}], "*)"}], "/.", 
      "\[IndentingNewLine]", 
      RowBox[{"iLapF", "\[Rule]", "iLapFColl"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"Collect", " ", "iLapF", " ", "terms"}], "*)"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fullMatrixEquations", "=", 
  RowBox[{"fullMatrixEquations", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dz", "[", 
       RowBox[{"a_", "/;", 
        RowBox[{"!", 
         RowBox[{"meanFieldQ", "[", "a", "]"}]}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"dz", " ", "a"}]}], ",", 
     RowBox[{
      RowBox[{"iLap2", "[", "a_", "]"}], "\[RuleDelayed]", 
      RowBox[{"iLap2", " ", "a"}]}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.614183523653407*^9, 3.614183619973299*^9}, {
   3.6141837102104187`*^9, 3.61418374185849*^9}, {3.6141849032639017`*^9, 
   3.614184910371166*^9}, {3.6141856403035383`*^9, 3.614185671246872*^9}, {
   3.614185814106379*^9, 3.614185877677721*^9}, {3.614186008201589*^9, 
   3.6141860563838873`*^9}, {3.6141861298094*^9, 3.614186133404842*^9}, {
   3.614186265993711*^9, 3.614186266722341*^9}, {3.61418645140637*^9, 
   3.61418648051291*^9}, {3.614186552940997*^9, 3.6141865737590837`*^9}, {
   3.614188523622821*^9, 3.6141885248935966`*^9}, {3.614189283362381*^9, 
   3.614189315179832*^9}, {3.614189422729567*^9, 3.614189433440941*^9}, {
   3.614189677743164*^9, 3.61418967848466*^9}, {3.6141967572921963`*^9, 
   3.6141967583883953`*^9}, {3.6141989228199043`*^9, 3.614198945631775*^9}, 
   3.614198982104651*^9, {3.614361772710515*^9, 3.6143618063669567`*^9}, {
   3.614504631869879*^9, 3.614504678095435*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "4"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.614186133917675*^9, 3.614186267048477*^9, 3.614186481926425*^9, 
   3.6141885255283833`*^9, 3.614189319838678*^9, {3.6141894304574347`*^9, 
   3.614189433941032*^9}, 3.614189678940024*^9, 3.614195966966*^9, 
   3.614196761527596*^9, {3.61419892962738*^9, 3.614198946179511*^9}, 
   3.61419898388535*^9, {3.614361787735118*^9, 3.614361807137169*^9}, 
   3.614504597712901*^9, {3.614504637573621*^9, 3.6145046797962427`*^9}, 
   3.614542667785318*^9, 3.614545623141712*^9, 3.614545706505865*^9, 
   3.614545743858747*^9, 3.6146157788524723`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "1"}]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "2"}]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "3"}]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "4"}]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "1"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "1"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "2"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "2"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "3"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "3"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "4"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "4"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["B", "y"], " ", 
      SubscriptBox["k", "y"], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"1", "\[InvisibleComma]", "1"}]]}], ",", 
     RowBox[{
      SubscriptBox["B", "y"], " ", 
      SubscriptBox["k", "y"], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"1", "\[InvisibleComma]", "2"}]]}], ",", 
     RowBox[{
      SubscriptBox["B", "y"], " ", 
      SubscriptBox["k", "y"], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"1", "\[InvisibleComma]", "3"}]]}], ",", 
     RowBox[{
      SubscriptBox["B", "y"], " ", 
      SubscriptBox["k", "y"], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"1", "\[InvisibleComma]", "4"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "1"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "2"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "3"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "4"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.614186133917675*^9, 3.614186267048477*^9, 3.614186481926425*^9, 
   3.6141885255283833`*^9, 3.614189319838678*^9, {3.6141894304574347`*^9, 
   3.614189433941032*^9}, 3.614189678940024*^9, 3.614195966966*^9, 
   3.614196761527596*^9, {3.61419892962738*^9, 3.614198946179511*^9}, 
   3.61419898388535*^9, {3.614361787735118*^9, 3.614361807137169*^9}, 
   3.614504597712901*^9, {3.614504637573621*^9, 3.6145046797962427`*^9}, 
   3.614542667785318*^9, 3.614545623141712*^9, 3.614545706505865*^9, 
   3.614545743858747*^9, 3.614615778864291*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Put everything into c++ form, including taking the Fourier transforms\
\>", "Subsection",
 CellChangeTimes->{{3.614195675973181*^9, 3.614195696141123*^9}}],

Cell[CellGroupData[{

Cell["Define the various functions and variables to use in c++", \
"Subsubsection",
 CellChangeTimes->{
  3.614200068915313*^9, {3.6145427017460127`*^9, 3.614542707265788*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CklOut", " ", "=", " ", "\"\<Ckl_out[i]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CklIn", " ", "=", " ", "\"\<Ckl_in[i]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ifft", " ", "=", " ", "\"\<fft_.back_2DFull\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fft", " ", "=", " ", "\"\<fft_.for_2DFull\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dealias", " ", "=", " ", "\"\<dealias\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cppProducts", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<.asDiagonal()*\>\"", ",", "\"\<*\>\""}], "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Second", " ", "one", " ", "is", " ", "for", " ", "scalars"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MFcppVariables", " ", "=", 
  RowBox[{"Thread", "[", " ", 
   RowBox[{"meanFieldsWDerivs", "->", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<_\>\""}], "&"}], "/@",
        "meanFieldsWDerivs"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<\>\""}], ",", 
        RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iLapFvar", " ", "=", " ", "\"\<ilapFtmp_.matrix()\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vectorVars", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"iLap2", ",", "dz", ",", "iLapFColl"}], "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Variables", " ", "that", " ", "are", " ", "vectors", " ", "in", " ", 
    RowBox[{"c", "++"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"variablesInCpp", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ky", "\[Rule]", "\"\<kyctmp_\>\""}], ",", 
    RowBox[{"kxb", "\[Rule]", "\"\<kxctmp_\>\""}], ",", 
    RowBox[{"dz", "\[Rule]", "\"\<kz_\>\""}], ",", 
    RowBox[{"q", "\[Rule]", "\"\<q_\>\""}], ",", 
    RowBox[{"iLap2", "\[Rule]", "\"\<ilap2tmp_\>\""}]}], "}"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQfeAVS0/H21eOxxt/zwXRZ6ReLQLRei+VFoNoHuZ9
G0H02kWzN4NoK0MzhS4gbSbCoQiiTxxtKO4G0iKTZ5SBaE9PiakgWiflPpje
8tLnGIhuKvx+AkRHCK0X6AHS7xT3CILowDYLcRCd8MlSDkT3XXDSBNFOlRfA
dCuHgz6IjkqcAKYDJi4zBtFyfE/BtJjZj5BTQPpHl1w4iHbJrTgPopsWPLoM
oi083O+A6Jr/8x6D6Fct7K9AtJaZOpjeJvbL9jSQLltWYg+ipxgdmg+iNayW
LQDRHf06U84DaY+qhqkg+sauSx8ugMJnvv9HEB344sOev0DaLvvOARAtuOrr
DxAtJFr/C0Tf+xhp8g9k3+eJYDrg4MrbPO9eOUYH+t4B0dNs//6UA9K+Ze6/
QTQAkwjtMQ==
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["B", "y"], "\[Rule]", "\<\"By_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     SubscriptBox["B", "y"], "]"}], "\[Rule]", "\<\"dzBy_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "[", 
      SubscriptBox["B", "y"], "]"}], "]"}], "\[Rule]", "\<\"dzdzBy_\"\>"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6141968971191683`*^9, {3.614196955865787*^9, 3.614196976553069*^9}, 
   3.6141970176273737`*^9, {3.614197140642284*^9, 3.6141971499528723`*^9}, 
   3.61420280515613*^9, 3.6142041474039993`*^9, 3.61420432093274*^9, 
   3.614332753782305*^9, 3.6143334373897533`*^9, 3.614334227966806*^9, 
   3.614335330770611*^9, {3.614342317980378*^9, 3.6143423257325563`*^9}, 
   3.614345100654113*^9, 3.614361816160263*^9, 3.614385394517193*^9, 
   3.614436871615592*^9, 3.6144373337998466`*^9, 3.614437922414172*^9, 
   3.61446781112652*^9, 3.614504610070334*^9, 3.614504924258411*^9, 
   3.614542674887701*^9, 3.61454565515012*^9, 3.614545745944592*^9, 
   3.614615781190735*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["k", "y"], "\[Rule]", "\<\"kyctmp_\"\>"}], ",", 
   RowBox[{
    OverscriptBox[
     SubscriptBox["k", "x"], "\[LongDash]"], "\[Rule]", "\<\"kxctmp_\"\>"}], 
   ",", 
   RowBox[{
    SubscriptBox["\[PartialD]", "z"], "\[Rule]", "\<\"kz_\"\>"}], ",", 
   RowBox[{"q", "\[Rule]", "\<\"q_\"\>"}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[EmptyUpTriangle]", "2"], 
     RowBox[{"-", "1"}]], "\[Rule]", "\<\"ilap2tmp_\"\>"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6141968971191683`*^9, {3.614196955865787*^9, 3.614196976553069*^9}, 
   3.6141970176273737`*^9, {3.614197140642284*^9, 3.6141971499528723`*^9}, 
   3.61420280515613*^9, 3.6142041474039993`*^9, 3.61420432093274*^9, 
   3.614332753782305*^9, 3.6143334373897533`*^9, 3.614334227966806*^9, 
   3.614335330770611*^9, {3.614342317980378*^9, 3.6143423257325563`*^9}, 
   3.614345100654113*^9, 3.614361816160263*^9, 3.614385394517193*^9, 
   3.614436871615592*^9, 3.6144373337998466`*^9, 3.614437922414172*^9, 
   3.61446781112652*^9, 3.614504610070334*^9, 3.614504924258411*^9, 
   3.614542674887701*^9, 3.61454565515012*^9, 3.614545745944592*^9, 
   3.614615781195306*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Setup functions to find all the coefficients and replace by c++ variables, \
save these variables to automatically compute later\
\>", "Subsubsection",
 CellChangeTimes->{{3.6142001576080503`*^9, 3.6142001733730717`*^9}, {
  3.614542687579644*^9, 3.6145426929862757`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "main", " ", "stuff", " ", "you", " ", "might", " ", "want", 
    " ", "to", " ", "change", " ", "is", " ", "in", " ", "this", " ", 
    RowBox[{"Module", ".", " ", "Defines"}], " ", "various", " ", "functions",
     " ", "and", " ", "lists", " ", "to", " ", "identify", " ", "different", 
    " ", "variable", " ", "types"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coeffList", ",", "fullCppMultVariableList", ",", "scalarCppVars", ",", 
       "vectorCppVars", ",", 
       RowBox[{"ftFactorVar", "=", "\"\<fft2Dfac_\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeffList", "=", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"MapMatrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"coeff_", " ", 
                RowBox[{"Cm", "[", 
                 RowBox[{"i1_", ",", "i2_"}], "]"}]}], "\[RuleDelayed]", 
               "coeff"}], ",", "\[Infinity]"}], "]"}], "&"}], ",", 
           "fullMatrixEquations"}], "]"}], "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"meanFieldsWDerivs", "\[Rule]", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeffList", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"coeff_", "\[RuleDelayed]", 
           RowBox[{"Rule", "[", 
            RowBox[{"coeff", ",", 
             RowBox[{"convertProdToString", "[", "coeff", "]"}]}], "]"}]}]}], 
         "&"}], "/@", "coeffList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coeffList", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"coeffList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", 
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ">", 
            RowBox[{"StringLength", "[", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Make", " ", "sure", " ", "longest", " ", "products", " ", "are", " ",
          "first"}], ",", " ", 
        RowBox[{
        "otherwise", " ", "it", " ", "replaces", " ", "others", " ", "too", 
         " ", "early", " ", "and", " ", "they", " ", 
         RowBox[{"don", "'"}], "t", " ", "get", " ", "recognized"}]}], "*)"}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fullMatrixEquationsC", "=", 
       RowBox[{
        RowBox[{"fullMatrixEquations", "/.", "coeffList"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"str1_String", " ", 
           RowBox[{"Cm", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "+", 
          RowBox[{"str2_String", " ", 
           RowBox[{"Cm", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"str1", ",", "\"\<PLUS\>\"", ",", "str2"}], "]"}], " ", 
          RowBox[{"Cm", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Now", " ", "there", " ", "are", " ", "only"}], ",", " ", 
        RowBox[{"Mean", " ", "fields", " ", 
         RowBox[{"(", 
          RowBox[{"and", " ", "derivatives"}], ")"}]}], ",", " ", 
        RowBox[{"C", " ", "matrices"}], ",", " ", 
        RowBox[{"string", " ", "variables"}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
       "Second", " ", "replacment", " ", "is", " ", "for", " ", "sums"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Before", " ", "going", " ", "on"}], ",", " ", 
        RowBox[{
         RowBox[{
         "keep", " ", "the", " ", "list", " ", "of", " ", "string", " ", 
          "variables"}], " ", "-", " ", 
         RowBox[{
         "some", " ", "of", " ", "these", " ", "get", " ", "rather", " ", 
          RowBox[{"long", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullCppMultVariableList", " ", "=", 
       RowBox[{"Union", "[", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{
         "fullMatrixEquationsC", ",", "str_String", ",", "\[Infinity]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"scalarCppVars", " ", "=", " ", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"coeffList", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"Alternatives", "@@", "vectorVars"}], ",", 
              "\[Infinity]"}], "]"}]}], "&"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Separate", " ", "out", " ", "the", " ", "scalar", " ", "variables"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vectorCppVars", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"fullCppMultVariableList", ",", "scalarCppVars"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", 
       RowBox[{"scalarCppQ", ",", "vectorCppQ"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"scalarCppQ", "[", "_", "]"}], "=", "False"}], ";", 
      RowBox[{
       RowBox[{"vectorCppQ", "[", "_", "]"}], "=", "False"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"scalarCppQ", "[", "#", "]"}], "=", "True"}], ")"}], "&"}], 
       "/@", "scalarCppVars"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vectorCppQ", "[", "#", "]"}], "=", "True"}], ")"}], "&"}], 
       "/@", "vectorCppVars"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Q", " ", "functions", " ", "for", " ", "vectors", " ", "and", " ", 
        "scalars"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "rescaleForFFT", "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Adds", " ", "in", " ", "ftfac", " ", "multiplying", " ", "vector", 
        " ", "for", " ", "more", " ", "efficient", " ", "fft", " ", 
        "rescaling"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rescaleForFFT", "[", "a_", "]"}], ":=", "\[IndentingNewLine]", 
       RowBox[{"a", "/.", 
        RowBox[{
         RowBox[{"var_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"scalarCppQ", "[", "#", "]"}], "||", 
             RowBox[{"vectorCppQ", "[", "#", "]"}]}], "&"}], ")"}]}], 
         "\[RuleDelayed]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"newvar", "=", 
             RowBox[{
             "\"\<(\>\"", "<>", "ftFactorVar", "<>", "\"\<*\>\"", "<>", "var",
               "<>", "\"\<)\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scalarCppQ", "[", "var", "]"}], ",", 
              RowBox[{
               RowBox[{"scalarCppQ", "[", "newvar", "]"}], "=", "True"}], ",", 
              RowBox[{
               RowBox[{"vectorCppQ", "[", "newvar", "]"}], "=", "True"}]}], 
             "]"}], ";", "\[IndentingNewLine]", "newvar"}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Product", " ", "to", " ", "use"}], " ", "-", " ", 
        RowBox[{
        "default", " ", "is", " ", "treating", " ", "object", " ", "as", " ", 
         "a", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "vec2DiagProd", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vec2DiagProd", "[", "]"}], "=", 
       RowBox[{
       "cppProducts", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vec2DiagProd", "[", "a_", "]"}], " ", ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"scalarCppQ", "@", "a"}], ",", 
         RowBox[{
         "cppProducts", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "cppProducts", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Replacement", " ", "rules", " ", "from", " ", 
        RowBox[{"c", "++"}], " ", "variables", " ", "to", " ", "real", " ", 
        "products"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CppToBasicVariables", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"fullCppMultVariableList", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{"fullCppMultVariableList", ",", 
              RowBox[{
               RowBox[{"a__", "~~", "\"\<PLUS\>\"", "~~", "b__"}], 
               "\[RuleDelayed]", 
               RowBox[{"a", "+", "b"}]}]}], "]"}], "/.", 
            RowBox[{"StringExpression", "\[Rule]", "Sequence"}]}], "/.", 
           RowBox[{"coeffList", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Collect", " ", "to", " ", "scalar", " ", "and", " ", "vector", " ", 
        "variables"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CppToBasicVariables", " ", "=", " ", 
       RowBox[{"Gather", "[", 
        RowBox[{"CppToBasicVariables", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"scalarCppQ", "[", 
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "===", 
           RowBox[{"scalarCppQ", "[", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "&"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "FUNCTIONS", " ", "TO", " ", "CONVERT", " ", "TO", " ", "CPP", " ", 
     "CODE"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"First", " ", "-", " ", 
     RowBox[{"convert", " ", "to", " ", "symbolic", " ", 
      RowBox[{"code", ".", " ", "Takes"}], " ", "a", " ", "single", " ", 
      "term", " ", "and", " ", "converts", " ", "it", " ", "to", " ", 
      "symbolic", " ", 
      RowBox[{
       RowBox[{"c", "++"}], "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", 
    RowBox[{"toPseudoCppCode", ",", "$numberOfTempsVars"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$numberOfTempsVars", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toPseudoCppCode", "[", 
     RowBox[{"expr_", ",", "index_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "term", ",", "mfgroups", ",", "pseudoCCode", ",", " ", "ntemps", ",", 
        "FFTpseudoCode"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Operators", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SetAttributes", "[", 
        RowBox[{"CPlus", ",", "Orderless"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"CTimes", ",", "Orderless"}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Set", " ", "these", " ", "as", " ", "commutative", " ", "but", " ", 
         "not", " ", "associative"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Replace", " ", "Times", " ", "and", " ", "Plus", " ", "with", " ", 
         "C", " ", "oeprators"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"term", "=", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"B_", "?", "meanFieldQ"}], ",", "b___"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"CTimes", "[", 
            RowBox[{"B", ",", 
             RowBox[{"a", " ", "b"}]}], "]"}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Plus", "\[Rule]", "CPlus"}], ",", 
           RowBox[{"Times", "\[Rule]", "CTimes"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "term", "]"}], "===", "CTimes"}], ",", 
         RowBox[{"term", " ", "=", " ", 
          RowBox[{"CPlus", "[", "term", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Find", " ", "terms", " ", "linear", " ", "in", " ", "the", " ", 
         "mean", " ", "fields"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mfgroups", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"term", ",", 
          RowBox[{"CTimes", "[", 
           RowBox[{
            RowBox[{"B_", "?", "meanFieldQ"}], ",", "subt_"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ntemps", " ", "=", " ", 
        RowBox[{"Length", "@", "mfgroups"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Store", " ", "the", " ", "maximum", " ", "number", " ", "of", " ", 
         "temp", " ", "variables", " ", "for", " ", "memory", " ", 
         "assignment", " ", "later"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"ntemps", ">", "$numberOfTempsVars"}], ",", 
         RowBox[{"$numberOfTempsVars", "=", "ntemps"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"First", " ", "stage"}], " ", "-", " ", 
         RowBox[{
         "assign", " ", "temp", " ", "variables", " ", "to", " ", 
          "groups"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pseudoCCode", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"CAssign", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "#", "]"}], ",", 
            RowBox[{"Extract", "[", 
             RowBox[{"term", ",", 
              RowBox[{
              "mfgroups", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "ntemps", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"term", " ", "=", " ", 
        RowBox[{"term", "/.", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Reverse", "/@", "pseudoCCode"}], "/.", 
           RowBox[{"CAssign", "\[Rule]", "Rule"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Replace", " ", "term", " ", "to", " ", "recognize", " ", "temp", " ",
          "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Next", " ", "stage"}], " ", "-", " ", 
         RowBox[{
         "add", " ", "in", " ", "Fourier", " ", "transforms", " ", "for", " ",
           "pseudospectral", " ", "products"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pseudoCCode", "=", 
        RowBox[{"pseudoCCode", "/.", 
         RowBox[{
          RowBox[{"CAssign", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "n_", "]"}], ",", 
            RowBox[{"CTimes", "[", 
             RowBox[{
              RowBox[{"B_", "?", "meanFieldQ"}], ",", "subt_"}], "]"}]}], 
           "]"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CAssign", "[", 
             RowBox[{
              RowBox[{"CTemp", "[", "n", "]"}], ",", 
              RowBox[{"rescaleForFFT", "@", "subt"}]}], "]"}], ",", 
            RowBox[{"Cifft", "[", 
             RowBox[{"CTemp", "[", "n", "]"}], "]"}], ",", 
            RowBox[{"CAssign", "[", 
             RowBox[{
              RowBox[{"CTemp", "[", "n", "]"}], ",", 
              RowBox[{"CTimes", "[", 
               RowBox[{"B", ",", 
                RowBox[{"CTemp", "[", "n", "]"}]}], "]"}]}], "]"}]}], 
           "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Add", " ", "a", " ", "CPlus", " ", "around", " ", "temp", " ", 
         "variables", " ", "to", " ", "find", " ", "bits", " ", "for", " ", 
         "taking", " ", "forward", " ", "ffts"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"term", " ", "=", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{"CPlus", "[", "a__", "]"}], "\[RuleDelayed]", 
             RowBox[{"CPlus", "[", 
              RowBox[{
               RowBox[{"CPlus", "[", 
                RowBox[{"CTemp", "[", "0", "]"}], "]"}], ",", "a"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//.", 
          RowBox[{
           RowBox[{"CPlus", "[", 
            RowBox[{
             RowBox[{"CPlus", "[", 
              RowBox[{"a___", ",", 
               RowBox[{"CTemp", "[", "0", "]"}]}], "]"}], ",", "tmp_CTemp", 
             ",", "b___"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"CPlus", "[", 
            RowBox[{
             RowBox[{"CPlus", "[", 
              RowBox[{"a", ",", 
               RowBox[{"CTemp", "[", "0", "]"}], ",", "tmp"}], "]"}], ",", 
             "b"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"CPlus", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "0", "]"}], ",", "tmp__"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"CPlus", "[", "tmp", "]"}]}]}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", " ", "rather", " ", "long"}], "-", 
         RowBox[{"winded", " ", "way", " ", "to", " ", "do", " ", "this"}], 
         " ", "-", " ", 
         RowBox[{"surprisingly", " ", "tricky"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Pseudocode", " ", "for", " ", "taking", " ", "forward", " ", 
         "ffts"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"FFTpseudoCode", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"CAssign", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", "#"}], "]"}], ",", 
             RowBox[{"Cfft", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{"term", ",", 
            RowBox[{"CPlus", "[", "tmp__CTemp", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Replace", " ", "temp", " ", "variables", " ", "in", " ", "term"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"term", " ", "=", " ", 
        RowBox[{"term", "/.", 
         RowBox[{"Cases", "[", 
          RowBox[{"FFTpseudoCode", ",", 
           RowBox[{
            RowBox[{"CAssign", "[", "a__", "]"}], "\[RuleDelayed]", 
            RowBox[{"Rule", "@@", 
             RowBox[{"Reverse", "[", 
              RowBox[{"{", "a", "}"}], "]"}]}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Add", " ", "fft", " ", "and", " ", "dealiasing", " ", "on", " ", 
         "the", " ", "end", " ", "and", " ", "remove", " ", "useless", " ", 
         "assignment"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pseudoCCode", " ", "=", " ", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"Join", "[", 
           RowBox[{"pseudoCCode", ",", "FFTpseudoCode", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"CAssign", "[", 
               RowBox[{
                RowBox[{"CTemp", "[", "ntemps", "]"}], ",", "term"}], "]"}], 
              ",", 
              RowBox[{"CDealias", "[", 
               RowBox[{"CTemp", "[", "ntemps", "]"}], "]"}], ",", 
              RowBox[{"CAssign", "[", 
               RowBox[{
                RowBox[{"CBlock", "@@", "index"}], ",", 
                RowBox[{"CTemp", "[", "ntemps", "]"}]}], "]"}]}], "}"}]}], 
           "]"}]}], "/.", 
         RowBox[{
          RowBox[{"CAssign", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "i_", "]"}], ",", 
            RowBox[{"CPlus", "[", 
             RowBox[{"CTemp", "[", "i_", "]"}], "]"}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"Sequence", "[", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Function", " ", "to", " ", "store", " ", "c", " ", "variable", " ", 
     "definitions", " ", "for", " ", "other", " ", "stuff"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "toCString", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cm", "/:", 
     RowBox[{"toCString", "[", 
      RowBox[{"Cm", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "]"}], ":=", 
     RowBox[{"\"\<C\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", 
      RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<_\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toCString", "[", "a_String", "]"}], ":=", "a"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CTemp", "/:", 
     RowBox[{"toCString", "[", 
      RowBox[{"CTemp", "[", "n_", "]"}], "]"}], ":=", 
     RowBox[{"\"\<Ctmp_\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<_\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toCString", "[", 
      RowBox[{"mf_", "?", "meanFieldQ"}], "]"}], ":=", 
     RowBox[{"mf", "/.", "MFcppVariables"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Function", " ", "to", " ", 
     RowBox[{"take", " ", ".", "block"}], 
     RowBox[{"(", ")"}], " ", "method", " ", "of", " ", "Ckl_out", " ", 
     "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "ind2EigenBlock"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ind2EigenBlock", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], ",", "cmat_"}], "]"}], ":=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"cmat", "<>", "\"\<.block( \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "NZ"}], ",", "InputForm"}], "]"}],
         "<>", "\"\<, \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "NZ"}], ",", "InputForm"}], "]"}],
         "<>", "\"\<, NZ, NZ)\>\""}], ",", 
       RowBox[{"\"\<NZ\>\"", "\[Rule]", "\"\<NZ_\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Rules", " ", "to", " ", "change", " ", "pseudoCCode", " ", "into", " ", 
     "real", " ", "Ccode"}], " ", "*)"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Must", " ", "be", " ", "used", " ", "with"}], " ", "//."}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"COperatorRules", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"CTimes", "[", 
         RowBox[{"a_String", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", 
         RowBox[{"vec2DiagProd", "[", "a", "]"}], "<>", 
         RowBox[{"toCString", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CTimes", "[", 
         RowBox[{
          RowBox[{"a_", "?", "meanFieldQ"}], ",", "b_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"toCString", "[", "a", "]"}], "<>", 
         RowBox[{"vec2DiagProd", "[", "a", "]"}], "<>", 
         RowBox[{"toCString", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CPlus", "[", "a__String", "]"}], "\[RuleDelayed]", 
        RowBox[{"ToString", "@", 
         RowBox[{"Row", "[", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", "\"\< + \>\""}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CPlus", "[", 
         RowBox[{"a___", ",", "tmp_CTemp", ",", "b___"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"CPlus", "[", 
         RowBox[{"a", ",", 
          RowBox[{"toCString", "[", "tmp", "]"}], ",", "b"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CAssign", "[", 
         RowBox[{"tmp_", ",", "b_String"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"toCString", "[", "tmp", "]"}], "<>", "\"\< = \>\"", "<>", 
         "b"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CAssign", "[", 
         RowBox[{"str_String", ",", "tmp_CTemp"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"CAssign", "[", 
         RowBox[{"str", ",", 
          RowBox[{"toCString", "[", "tmp", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cfft", "[", "a_CTemp", "]"}], "\[RuleDelayed]", 
        RowBox[{"fft", "<>", "\"\<( \>\"", "<>", 
         RowBox[{"toCString", "@", "a"}], "<>", " ", "\"\< )\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cifft", "[", "a_CTemp", "]"}], "\[RuleDelayed]", 
        RowBox[{"ifft", "<>", "\"\<( \>\"", "<>", 
         RowBox[{"toCString", "@", "a"}], "<>", " ", "\"\< )\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iLapFColl", "[", "str_String", "]"}], "\[RuleDelayed]", 
        RowBox[{"iLapFvar", "<>", 
         RowBox[{"vec2DiagProd", "[", "]"}], "<>", "\"\<(\>\"", "<>", "str", 
         "<>", "\"\<)\>\""}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CBlock", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
        RowBox[{"ind2EigenBlock", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], ",", "CklOut"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CDealias", "[", "tmp_CTemp", "]"}], "\[RuleDelayed]", 
        RowBox[{"dealias", "<>", "\"\<(\>\"", "<>", 
         RowBox[{"toCString", "[", "tmp", "]"}], "<>", "\"\<)\>\""}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.614199820333446*^9, 3.614199973544842*^9}, {
   3.614200154568696*^9, 3.614200177457288*^9}, {3.614203202742343*^9, 
   3.6142032132053423`*^9}, {3.614203687436726*^9, 3.614203694398652*^9}, {
   3.614204078926628*^9, 3.614204079422367*^9}, 3.6142041354989843`*^9, {
   3.614204166229424*^9, 3.6142042190601587`*^9}, {3.614204254561245*^9, 
   3.614204333690789*^9}, {3.614331697718234*^9, 3.61433174227547*^9}, {
   3.614331906693769*^9, 3.614331911117732*^9}, {3.614331987606147*^9, 
   3.614332000077257*^9}, {3.614332466912683*^9, 3.614332469135511*^9}, {
   3.614332812588958*^9, 3.614332843516348*^9}, {3.614332874370685*^9, 
   3.614332874698839*^9}, {3.614332908946308*^9, 3.6143329191369057`*^9}, {
   3.614333144869622*^9, 3.614333156472726*^9}, {3.6143332710284643`*^9, 
   3.614333279858944*^9}, {3.6143622085326366`*^9, 3.614362280097941*^9}, 
   3.614362399974094*^9, {3.614362430655244*^9, 3.614362460967514*^9}, {
   3.6143846802878942`*^9, 3.614384682302619*^9}, 3.614436190971469*^9, {
   3.614436331371933*^9, 3.6144363355680647`*^9}, {3.614437229054408*^9, 
   3.61443728430906*^9}, {3.614437337853598*^9, 3.614437440432015*^9}, {
   3.614437482905383*^9, 3.614437585144912*^9}, {3.614437630726707*^9, 
   3.614437785531118*^9}, {3.614437848964754*^9, 3.614437967122786*^9}, {
   3.6144380848799877`*^9, 3.6144381352511873`*^9}, {3.6144382227794724`*^9, 
   3.614438293388933*^9}, {3.61443989562008*^9, 3.614439938088032*^9}, {
   3.6144401493798637`*^9, 3.61444017699675*^9}, {3.61444021553305*^9, 
   3.614440310323646*^9}, {3.61444036659039*^9, 3.614440615353231*^9}, {
   3.614440664885353*^9, 3.6144407634596643`*^9}, {3.614466811204368*^9, 
   3.614466893555069*^9}, {3.614467338629237*^9, 3.614467397648348*^9}, {
   3.614467447634305*^9, 3.614467566346293*^9}, {3.614467600650503*^9, 
   3.6144676225940247`*^9}, {3.6144676700570917`*^9, 3.614467711185996*^9}, {
   3.614467791283551*^9, 3.614467797969377*^9}, {3.6144679149890614`*^9, 
   3.614467955286832*^9}, {3.614467991859248*^9, 3.6144679928261623`*^9}, {
   3.614504879859517*^9, 3.6145049079875603`*^9}, {3.61454283629358*^9, 
   3.614542837167223*^9}, {3.614542878595272*^9, 3.6145428815772047`*^9}, {
   3.614543175274213*^9, 3.614543217236944*^9}, {3.614543286011907*^9, 
   3.614543330056481*^9}, 3.614543427918807*^9, {3.614544016420259*^9, 
   3.614544016783902*^9}, {3.614545405652108*^9, 3.6145454062903223`*^9}, {
   3.614553685029169*^9, 3.614553713332426*^9}, {3.614553820920223*^9, 
   3.614553821614222*^9}, {3.614615907007505*^9, 3.614615911160202*^9}, {
   3.614616031382146*^9, 3.614616036012775*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Split up and assign to Ckl_out", "Subsubsection",
 CellChangeTimes->{{3.6142046790049763`*^9, 3.614204686099799*^9}, {
  3.6142051931686783`*^9, 3.614205195159081*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "variableDef", ",", "vecPreVarStringList", ",", "scalarPreVarStringList",
       ",", "vectorPreVarQ", ",", "scalarPreVarQ", ",", "ctempVars", ",", 
      "cmatVars"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Form", " ", "the", " ", "full", " ", "equations", " ", "as", " ", "a", 
      " ", "single", " ", "text", " ", "block"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullEquations", " ", "=", " ", 
      RowBox[{
       RowBox[{"StringJoin", "@@", 
        RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"StringJoin", "@@", 
              RowBox[{"Riffle", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"toPseudoCppCode", "[", 
                  RowBox[{
                   RowBox[{"fullMatrixEquationsC", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "//.", 
                 "COperatorRules"}], ",", "\"\<;\\n\>\""}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", "\"\<;\\n\\n\\n\\n\>\""}], "]"}]}], "<>", 
       "\"\<;\\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Form", " ", "the", " ", "variable", " ", "definitions"}], " ",
        "-", " ", 
       RowBox[{
       "the", " ", "functions", " ", "here", " ", "are", " ", "for", " ", 
        "pre"}], "-", 
       RowBox[{"defined", " ", "variables", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", ".", "g", "."}], ",", " ", "kxctmp_"}], ")"}], " ", 
        "not", " ", "the", " ", "automatically", " ", "generated", " ", 
        "ones"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vecPreVarStringList", " ", "=", 
      RowBox[{
       RowBox[{"List", "@@", "vectorVars"}], "/.", "variablesInCpp"}]}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "vector", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scalarPreVarStringList", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"variablesInCpp", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        "vecPreVarStringList"}], "]"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "vector", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vectorPreVarQ", " ", "=", " ", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "vecPreVarStringList", "]"}], ";",
            "vecPreVarStringList"}], ")"}], ",", "#"}], "]"}], "&"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Returns", " ", "true", " ", "for", " ", "vector", " ", "variable"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scalarPreVarQ", " ", "=", " ", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "scalarPreVarStringList", "]"}], 
           ";", "scalarPreVarStringList"}], ")"}], ",", "#"}], "]"}], " ", 
       "&"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Returns", " ", "true", " ", "for", " ", "scalar", " ", "variable"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Collect", " ", "matrix", " ", "bits", " ", "together"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CppToBasicVariables", "/.", "variablesInCpp"}], "/.", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "?", "vectorPreVarQ"}], "^", "2"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"vecPreVarStringList", ",", 
              RowBox[{"a", "<>", "\"\<*\>\"", "<>", "a"}]}], "]"}], ";", 
            RowBox[{"a", "<>", "\"\<*\>\"", "<>", "a"}]}], ")"}]}]}], "/.", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"a_", "?", "vectorPreVarQ"}], "  ", 
          RowBox[{"b_", "?", "vectorPreVarQ"}]}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<(\>\"", "<>", "a", "<>", "\"\<*\>\"", "<>", "b", "<>", 
          "\"\<).matrix()\>\""}]}]}], "/.", 
       RowBox[{
        RowBox[{"a_", "?", "vectorPreVarQ"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", "\"\<.matrix()\>\""}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Collect", " ", "scalar", " ", "bits", " ", "together"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fullCppVaribles", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_", "?", "scalarPreVarQ"}], "^", "2"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"scalarPreVarStringList", ",", 
               RowBox[{"a", "<>", "\"\<*\>\"", "<>", "a"}]}], "]"}], ";", 
             RowBox[{"a", "<>", "\"\<*\>\"", "<>", "a"}]}], ")"}]}]}], "/.", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "?", "scalarPreVarQ"}], " ", 
           RowBox[{"b_", "?", "scalarPreVarQ"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"scalarPreVarStringList", ",", 
              RowBox[{"a", "<>", "\"\<*\>\"", "<>", "b"}]}], "]"}], ";", 
            RowBox[{"a", "<>", "\"\<*\>\"", "<>", "b"}]}], ")"}]}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"n_", "?", "NumericQ"}], " ", 
          RowBox[{"a_", "?", "scalarPreVarQ"}]}], "\[RuleDelayed]", 
         RowBox[{"\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "n", "]"}], "]"}], "<>", "\"\<*\>\"", "<>", "a", 
          "<>", "\"\<)\>\""}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"n_", "?", "NumericQ"}], " ", "b_String"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"N", "[", "n", "]"}], "]"}], "<>", "\"\<*\>\"", "<>", 
         "b"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{"fullCppVaribles", "/.", 
        RowBox[{
         RowBox[{"a_String", " ", "b_String"}], "\[RuleDelayed]", 
         RowBox[{"a", "<>", "\"\<*\>\"", "<>", "b"}]}]}], "/.", 
       RowBox[{
        RowBox[{"a_String", " ", "+", " ", "b_String"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", "\"\< + \>\"", "<>", "b"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ctempVars", " ", "=", " ", 
      RowBox[{"toCString", "/@", 
       RowBox[{"(", 
        RowBox[{"CTemp", "/@", 
         RowBox[{"Range", "[", "$numberOfTempsVars", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cmatVars", " ", "=", 
      RowBox[{"toCString", "/@", 
       RowBox[{"Flatten", "[", "Cmat", "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"Declare", " ", "variables", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "class", " ", "definition"}], ")"}]}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"classVariableDec", " ", "=", " ", 
      RowBox[{"\"\<dcmplxVecM \>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"CppToBasicVariables", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
          ",", "\"\<, \>\""}], "]"}]}], "<>", "\"\<;\\n\\n\>\"", "<>", 
       "\[IndentingNewLine]", "\"\<dcmplx \>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"CppToBasicVariables", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
          ",", "\"\<, \>\""}], "]"}]}], "<>", "\"\<;\\n\\n\>\"", "<>", 
       "\[IndentingNewLine]", "\"\<dcmplxMat \>\"", "<>", " ", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{"ctempVars", ",", "\"\<, \>\""}], "]"}]}], "<>", 
       "\"\<;\\n\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<dcmplxMat \>\"", "<>",
        " ", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{"cmatVars", ",", "\"\<, \>\""}], "]"}]}], "<>", 
       "\"\<;\\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "memory", " ", "to", " ", "variables", " ", "in", " ", 
       "class", " ", "constructor"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"classConstrAssignMem", " ", "=", 
      RowBox[{
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< = dcmplxVecM(NZ_);\\n\>\""}], "&"}], "/@", 
          RowBox[{"CppToBasicVariables", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ")"}]}], "<>", "\"\<\\n\>\"", "<>", "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< = dcmplxMat(NZ_,NZ_);\\n\>\""}], "&"}], "/@",
           "ctempVars"}], ")"}]}], "<>", "\"\<\\n\>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< = dcmplxMat(NZ_,NZ_);\\n\>\""}], "&"}], "/@",
           "cmatVars"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "variables", " ", "inside", " ", "the", " ", 
       "equations"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"assignCppVarsInEqs", " ", "=", 
      RowBox[{
      "\"\<// Vector variable definition (automatic)\\n\>\"", "<>", " ", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "<>", "\"\< = \>\"", " ", "<>", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "<>", "\"\<;\\n\>\""}], "&"}], "/@", 
          RowBox[{
          "fullCppVaribles", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"assignCppVarsInEqs", " ", "=", 
      RowBox[{
      "\"\<// Scalar variable definition (automatic)\\n\>\"", "<>", " ", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "<>", "\"\< = \>\"", " ", "<>", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "<>", "\"\<;\\n\>\""}], "&"}], "/@", 
          RowBox[{
          "fullCppVaribles", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], ")"}]}], "<>", "\"\<\\n\>\"", "<>", 
       "assignCppVarsInEqs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assignCppVarsInEqs", " ", "=", " ", 
      RowBox[{
      "\"\<// Submatrix variable definition (automatic)\\n\>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"toCString", "[", 
                RowBox[{"Cm", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
               RowBox[{"ind2EigenBlock", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}], ",", "CklIn"}], "]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "numVariables"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "numVariables"}], "}"}]}], "]"}]}], ",", 
           "\"\<;\\n\>\""}], "]"}]}], ")"}], "<>", "\"\<;\\n\\n\>\"", "<>", 
       "assignCppVarsInEqs"}]}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Assign", " ", "the", " ", "C", " ", 
     RowBox[{"blocks", " ", "--"}], " ", "TO", " ", "ADD"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"REYNOLDS", " ", "STRESSES"}], " ", "-", " ", 
     RowBox[{"TO", " ", "ADD"}]}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
    "SAVE", " ", "ALL", " ", "THIS", " ", "STUFF", " ", "TO", " ", "FILE"}], 
    " ", "*)"}],
   FontColor->RGBColor[0.5, 0, 0.5]]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<~/Documents/MRIDSS/Mathematica/MMA_Generated_Equations_BQlin.cpp\>\"", 
   ",", "\[IndentingNewLine]", 
   RowBox[{
   "\"\<// Automatically generated temporary variables - class \
definition\\n\>\"", "<>", "\[IndentingNewLine]", "classVariableDec", "<>", 
    "\"\<\\n\\n\\n\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<// Automatically generated temporary variables - class \
constructor\\n\>\"", "<>", "\[IndentingNewLine]", "classConstrAssignMem", 
    "<>", "\"\<\\n\\n\\n\\n\\n\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<//Assign automatically generated variables in equations \\n\>\"", "<>",
     "\[IndentingNewLine]", "assignCppVarsInEqs", "<>", 
    "\"\<\\n\\n\\n\\n\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<////////////////////////////////////////////////////////\\n\>\"", "<>",
     "\[IndentingNewLine]", 
    "\"\<///       AUTOMATICALLY GENERATED EQUATIONS         /////\\n\>\"", "<>",
     "\[IndentingNewLine]", 
    "\"\<///       see GenerateC++Equations.nb in MMA        /////\\n\\n\>\"",
     "<>", "\[IndentingNewLine]", "fullEquations", "<>", 
    "\[IndentingNewLine]", 
    "\"\<///     AUTOMATICALLY GENERATED EQUATIONS - END       ///\\n\>\"", "<>",
     "\[IndentingNewLine]", 
    "\"\<////////////////////////////////////////////////////////\\n\>\""}], 
   ",", "\[IndentingNewLine]", "\"\<Text\>\""}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6142047962878428`*^9, 3.6142048287650623`*^9}, {
   3.6142048623685904`*^9, 3.614204871407317*^9}, {3.614204927104175*^9, 
   3.614205167284988*^9}, {3.6142056503063517`*^9, 3.61420569620709*^9}, {
   3.614205733874864*^9, 3.6142057372347527`*^9}, {3.614205801605402*^9, 
   3.6142058147158327`*^9}, {3.614205856654711*^9, 3.614205911695675*^9}, {
   3.614206098560555*^9, 3.6142061335704403`*^9}, {3.614206170108762*^9, 
   3.6142061881144047`*^9}, 3.614206293851531*^9, {3.614206461617001*^9, 
   3.614206486966379*^9}, {3.6142065247418213`*^9, 3.614206525340083*^9}, {
   3.6142065934740763`*^9, 3.6142066005860767`*^9}, {3.614206631795189*^9, 
   3.61420665105902*^9}, {3.6142067668503103`*^9, 3.614206811713435*^9}, {
   3.614206859537304*^9, 3.614206860286922*^9}, {3.6142944293493757`*^9, 
   3.6142944433506927`*^9}, {3.614333316719392*^9, 3.6143334120699873`*^9}, {
   3.614333444377398*^9, 3.614333520964388*^9}, {3.614334399437749*^9, 
   3.61433440340563*^9}, {3.6143353683089323`*^9, 3.614335386748166*^9}, {
   3.6143356115565863`*^9, 3.614335642695072*^9}, {3.614335677308119*^9, 
   3.6143357063543158`*^9}, {3.61433586767843*^9, 3.614336158690496*^9}, {
   3.614336266943084*^9, 3.614336291062385*^9}, {3.614336322628447*^9, 
   3.614336357271209*^9}, {3.614336422201798*^9, 3.61433649219413*^9}, {
   3.6143365411420527`*^9, 3.614336642975008*^9}, {3.614336674388867*^9, 
   3.6143367439724493`*^9}, {3.6143368053654327`*^9, 3.614336827572853*^9}, {
   3.614336871824078*^9, 3.6143368722227917`*^9}, {3.614336903252371*^9, 
   3.614336957793364*^9}, {3.614337118801602*^9, 3.614337369809972*^9}, {
   3.6143374183062*^9, 3.614337432720202*^9}, {3.6143375078514223`*^9, 
   3.6143375282046423`*^9}, {3.6143376036820707`*^9, 3.614337849225244*^9}, {
   3.6143384130703163`*^9, 3.6143384249236937`*^9}, {3.614342468760648*^9, 
   3.614342483795895*^9}, {3.614344870214403*^9, 3.6143448765804043`*^9}, {
   3.6144668024268312`*^9, 3.61446680622049*^9}, {3.614468473094071*^9, 
   3.614468475362665*^9}, {3.6144685580405807`*^9, 3.61446858694422*^9}, {
   3.614468765757752*^9, 3.614468940401372*^9}, {3.614468984586191*^9, 
   3.6144689917783127`*^9}, {3.6144690589896708`*^9, 3.614469059077342*^9}, {
   3.6144691527364483`*^9, 3.6144693667898083`*^9}, {3.614469425367859*^9, 
   3.614469464109496*^9}, {3.6144695490098*^9, 3.6144695491606627`*^9}, {
   3.6144696598494787`*^9, 3.614469660520706*^9}, {3.614469930003291*^9, 
   3.614469937711336*^9}, {3.6144705198149643`*^9, 3.6144705200068417`*^9}, {
   3.6144706655301447`*^9, 3.614470681320969*^9}, {3.614504720143795*^9, 
   3.614504863524947*^9}, {3.614505100915875*^9, 3.614505121919724*^9}, {
   3.614505152906884*^9, 3.614505155503438*^9}, {3.614505221394732*^9, 
   3.614505221833407*^9}, {3.614505263530373*^9, 3.614505263936371*^9}, 
   3.614505308586783*^9, {3.614542746037664*^9, 3.6145427529093513`*^9}}],

Cell[BoxData["\<\"~/Documents/MRIDSS/Mathematica/MMA_Generated_Equations_\
BQlin.cpp\"\>"], "Output",
 CellChangeTimes->{
  3.6143387121822042`*^9, 3.614342337188706*^9, 3.614342486239141*^9, {
   3.6143448771742496`*^9, 3.61434488321599*^9}, 3.6143450218542852`*^9, 
   3.6143451076824017`*^9, 3.6144684790958347`*^9, 3.614469003670755*^9, 
   3.614469059822981*^9, {3.614469192413805*^9, 3.6144692034064283`*^9}, 
   3.614469373655657*^9, 3.6144694649976387`*^9, 3.614469550711421*^9, 
   3.6144696641046753`*^9, 3.614469938679933*^9, 3.614470523412774*^9, {
   3.614505127983507*^9, 3.6145051571376143`*^9}, 3.6145052231571608`*^9, 
   3.614505266300125*^9, 3.614505313529387*^9, {3.6145427143213997`*^9, 
   3.614542725540413*^9}, 3.614542757103635*^9, 3.614542844817013*^9, 
   3.614542885049453*^9, 3.614543449184469*^9, {3.614545738357164*^9, 
   3.614545751438102*^9}, 3.6145539650685472`*^9, 3.614615781332468*^9, 
   3.6146160441739893`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["B-field Quasi-linear", "Section",
 CellChangeTimes->{{3.6132857813215227`*^9, 3.613285785435519*^9}, {
  3.614613863421791*^9, 3.614613866708189*^9}}],

Cell[TextData[{
 "Quasi-linear equations including only interactions of fluctuations with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["B", "x"], ",", " ", 
    SubscriptBox["B", "y"]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.613285788264741*^9, 3.613285816975567*^9}, {
  3.6132858538148127`*^9, 3.613285857694859*^9}, {3.614613871740099*^9, 
  3.6146138827358103`*^9}}],

Cell[CellGroupData[{

Cell["Derive equations", "Subsection",
 CellChangeTimes->{{3.613285862743395*^9, 3.613285865310978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numVariables", " ", "=", " ", "4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zt", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"z", ",", "t"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanFields", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "Bx", ",", "By", ",", "0", ",", "0"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanFieldsWDerivs", " ", "=", " ", 
   RowBox[{"Rest", "@", 
    RowBox[{"Union", "[", 
     RowBox[{"Join", "[", 
      RowBox[{"meanFields", ",", 
       RowBox[{"dz", "/@", "meanFields"}], ",", 
       RowBox[{"dz", "/@", 
        RowBox[{"dz", "/@", "meanFields"}]}], ",", 
       RowBox[{"dz", "/@", 
        RowBox[{"dz", "/@", 
         RowBox[{"dz", "/@", "meanFields"}]}]}], ",", 
       RowBox[{"dz", "/@", 
        RowBox[{"dz", "/@", 
         RowBox[{"dz", "/@", 
          RowBox[{"dz", "/@", "meanFields"}]}]}]}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanFieldQ", " ", "=", " ", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"meanFieldsWDerivs", ",", "#"}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullMFeqns", " ", "=", " ", 
    RowBox[{"Subtract", "@@@", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Bx", "@@", "zt"}], ",", "t"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"ReyBx", "@@", "zt"}], "+", 
         RowBox[{"\[Eta]b", " ", 
          RowBox[{"Bx", "@@", "zt"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"By", "@@", "zt"}], ",", "t"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q"}], " ", 
          RowBox[{"Bx", "@@", "zt"}]}], "+", 
         RowBox[{"ReyBy", "@@", "zt"}], "+", 
         RowBox[{"\[Eta]b", " ", 
          RowBox[{"By", "@@", "zt"}]}]}]}], ",", "0"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plug", " ", "in", " ", "mean", " ", "field"}], " ", "+", " ", 
    RowBox[{
    "fluctuations", " ", "into", " ", "NL", " ", "equations", " ", "and", " ",
      "linearize"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NL2fluct", ",", "fourierRules"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NL2fluct", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "fullNLvars", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "meanFields", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "@@", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "t"}], "}"}]}], "+", 
               RowBox[{
                RowBox[{
                "fullNLvars", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "@@", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}]}]}], "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0", "[", "__", "]"}], ")"}], "\[Rule]", "0"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "fullNLvars", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Plug", " ", "in", " ", "to", " ", "full", " ", "equations", " ", 
        "and", " ", "linearize"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"linearize", "[", 
          RowBox[{"#", ",", "fullNLvars", ",", "xtv"}], "]"}], "&"}], "/@", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"fullNLeqns", "/.", "NL2fluct"}], "/.", 
          RowBox[{"B0z", "\[Rule]", "0"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "fullFluctEqs", " ", "still", " ", "contain", " ", "a", " ", "mean", 
        " ", "field", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Shearing", " ", "wave", " ", "expansion"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fourierRules", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "var", "}"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"var", "\[Rule]", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"Evaluate", "@", "xtv"}], ",", 
              RowBox[{
               RowBox[{"var", "[", 
                RowBox[{"z", ",", "t"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"kx", "+", 
                    RowBox[{"q", " ", "t", " ", "ky"}]}], ")"}], "x"}], " ", 
                 "+", " ", 
                 RowBox[{"\[ImaginaryI]", " ", "ky", " ", "y"}]}], "]"}]}]}], 
             "]"}]}], "]"}]}], "]"}], "/@", "fullNLvars"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fullFluctEqs", "/.", "fourierRules"}], ")"}], "/", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"kx", "+", 
              RowBox[{"q", " ", "t", " ", "ky"}]}], ")"}], "x"}], " ", "+", 
           " ", 
           RowBox[{"\[ImaginaryI]", " ", "ky", " ", "y"}]}], "]"}]}], "]"}]}],
       ";", 
      RowBox[{"(*", 
       RowBox[{
       "Shearing", " ", "wave", " ", "in", " ", "x", " ", "and", " ", "y"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{"fullFluctEqs", "/.", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["k", "x"], "+", 
              RowBox[{
               SubscriptBox["k", "y"], " ", "q", " ", "t"}]}], ")"}], " ", 
            "x"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["k", "y"], " ", "y"}]}]], "\[Rule]", "0"}]}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Remove", " ", "mean", " ", "components"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"fullFluctEqs", "/.", 
          RowBox[{"kx", "\[Rule]", 
           RowBox[{"kxb", "-", 
            RowBox[{"q", " ", "t", " ", "ky"}]}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kxb", "\[Rule]", 
            RowBox[{"kxb", "/", "\[ImaginaryI]"}]}], ",", 
           RowBox[{"ky", "\[Rule]", 
            RowBox[{"ky", "/", "\[ImaginaryI]"}]}]}], "}"}]}], "//", 
        "Expand"}]}]}]}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Use", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "_"]}], "=", 
      RowBox[{
       SubscriptBox["k", "x"], "+", 
       RowBox[{
        SubscriptBox["qtk", "y"], " ", "as", " ", "in", " ", 
        RowBox[{"c", "++"}], " ", "code"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Derive", " ", "Orr"}], "-", 
     RowBox[{"Somerfeld", " ", "like", " ", "equations"}]}], ",", " ", 
    RowBox[{
     RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "reduce", " ", 
     "other", " ", "equations"}], ",", " ", 
    RowBox[{
    "just", " ", "write", " ", "down", " ", "equations", " ", "for", " ", 
     RowBox[{"Lap", "[", "u", "]"}]}], ",", "\[Zeta]", ",", "b", ",", 
    "\[Eta]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"derivRules", ",", "LapMGradDiv1", ",", "manualSub"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"derivRules", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"n_", ",", "m_"}], "]"}], "[", "a_", "]"}], "[", "vs__", 
         "]"}], "\[RuleDelayed]", 
        RowBox[{"Nest", "[", 
         RowBox[{"dt", ",", 
          RowBox[{"Nest", "[", 
           RowBox[{"dz", ",", 
            RowBox[{"a", "[", "vs", "]"}], ",", "n"}], "]"}], ",", "m"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LapMGradDiv1", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kxb", "^", "2"}], "+", 
            RowBox[{"ky", "^", "2"}]}], ")"}], 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "z", ",", "z"}], "]"}], "-", 
         RowBox[{"kxb", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kxb", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"ky", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              ",", "z"}], "]"}]}], ")"}]}]}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"finalEqs", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"iLapF", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"LapMGradDiv1", "[", 
                 RowBox[{"fullFluctEqs", "/.", 
                  RowBox[{"\[Nu]b", "\[Rule]", "0"}]}], "]"}], "/.", 
                "derivRules"}], "/.", "toOrrSomerVars"}], "]"}], "//.", 
             "explicitLap2Rule"}], "]"}], "/.", "explicitLapFRule"}], "//", 
          "Expand"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                 "fullFluctEqs", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "-", 
               RowBox[{"ky", " ", 
                RowBox[{
                "fullFluctEqs", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Nu]b", "\[Rule]", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "fullFluctEqs", "\[LeftDoubleBracket]", "5", 
               "\[RightDoubleBracket]"}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Eta]b", "\[Rule]", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                 "fullFluctEqs", "\[LeftDoubleBracket]", "6", 
                  "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "-", 
               RowBox[{"ky", " ", 
                RowBox[{
                "fullFluctEqs", "\[LeftDoubleBracket]", "7", 
                 "\[RightDoubleBracket]"}]}]}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Eta]b", "\[Rule]", "0"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Fix", " ", "these", " ", "up", " ", "manually"}], " ", "-", 
        " ", 
        RowBox[{"sometimes", " ", "much", " ", "easier"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"This", " ", "is", " ", "plugging", " ", "in", " ", 
         RowBox[{"iLapF", "[", "lapF", "]"}]}], " ", "=", " ", 
        RowBox[{
        "1", " ", "in", " ", "the", " ", "more", " ", "complicated", " ", 
         "situation"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"finalEqs", "=", 
       RowBox[{"finalEqs", "/.", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"-", "ky"}], " ", 
           RowBox[{"iLapF", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["kxb", "2"], " ", "#"}], "+", 
                  RowBox[{
                   RowBox[{"ky", "^", "2"}], " ", "#"}], "+", 
                  RowBox[{"D", "[", 
                   RowBox[{"#", ",", "z", ",", "z"}], "]"}]}], ")"}], "&"}], 
               "[", 
               RowBox[{
                RowBox[{"b", "[", 
                 RowBox[{"z", ",", "t"}], "]"}], " ", 
                RowBox[{"By", "[", 
                 RowBox[{"z", ",", "t"}], "]"}]}], "]"}], ")"}], "/.", 
             "derivRules"}], "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"-", " ", "ky"}], " ", 
          RowBox[{"b", "[", 
           RowBox[{"z", ",", "t"}], "]"}], 
          RowBox[{"By", "[", 
           RowBox[{"z", ",", "t"}], "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", ",", " ", 
    RowBox[{"form", " ", "the", " ", "A", " ", "matrix"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"redvars", " ", "=", 
   RowBox[{"{", 
    RowBox[{"u", ",", "\[Zeta]", ",", "b", ",", "\[Eta]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"finalEqs", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"finalEqs", "\[Equal]", "0"}], "]"}], ",", 
       RowBox[{"dt", "/@", 
        RowBox[{"(", 
         RowBox[{"Through", "[", 
          RowBox[{"redvars", "@@", 
           RowBox[{"{", 
            RowBox[{"z", ",", "t"}], "}"}]}], "]"}], ")"}]}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Solve", " ", "for", " ", "time"}], "-", "derivatives"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Aop", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "var", "}"}], ",", 
           RowBox[{
            RowBox[{"Plus", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"var", "[", 
                    RowBox[{"z", ",", "t"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
                  "#", ",", 
                  RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"plusToList", "@", 
                 RowBox[{
                 "finalEqs", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], "]"}]}], "/.", 
            RowBox[{
             RowBox[{"var", "[", 
              RowBox[{"z", ",", "t"}], "]"}], "\[Rule]", "ph"}]}]}], "]"}], "/@",
          "redvars"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}], "//", 
    "MatrixForm"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "matches", " ", "my", " ", "previously", " ", "derived", " ", 
    
    RowBox[{"(", 
     RowBox[{"by", " ", "hand"}], ")"}], " ", "version"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.613288323045455*^9, 3.613288326117752*^9}, {
   3.613288389643783*^9, 3.613288407039393*^9}, {3.613288479968417*^9, 
   3.613288487728981*^9}, {3.613288573589717*^9, 3.613288752358992*^9}, {
   3.613288852631976*^9, 3.613288916198966*^9}, {3.613288986990489*^9, 
   3.6132891926695137`*^9}, {3.613289423308837*^9, 3.613289432319971*^9}, {
   3.613289540309534*^9, 3.613289551704471*^9}, {3.613289593180532*^9, 
   3.613289597516069*^9}, {3.6132897828569527`*^9, 3.613289799551094*^9}, {
   3.613289832684938*^9, 3.613289857392364*^9}, {3.613289899387167*^9, 
   3.613289949003064*^9}, {3.613290022566579*^9, 3.613290072980708*^9}, {
   3.6132901333440037`*^9, 3.6132902277049723`*^9}, {3.613290347360075*^9, 
   3.613290348877283*^9}, {3.613290407662169*^9, 3.6132904199021072`*^9}, {
   3.613290617515009*^9, 3.613290693570179*^9}, {3.6132907374778633`*^9, 
   3.613290807808112*^9}, {3.6132911924799023`*^9, 3.613291195598812*^9}, {
   3.6132912379815063`*^9, 3.613291248693972*^9}, {3.613291280284522*^9, 
   3.613291408458893*^9}, {3.613291458080309*^9, 3.613291470927746*^9}, {
   3.6132915090035563`*^9, 3.613291525286358*^9}, {3.6132921232255783`*^9, 
   3.613292144859001*^9}, {3.613292297867838*^9, 3.613292316012755*^9}, 
   3.6132930883268547`*^9, {3.613293312306075*^9, 3.61329333079275*^9}, {
   3.6133006141405077`*^9, 3.61330070673322*^9}, {3.613300799309185*^9, 
   3.613300851120187*^9}, {3.613300912016116*^9, 3.6133009327016172`*^9}, {
   3.6133010023231773`*^9, 3.613301012699256*^9}, {3.6133010441561947`*^9, 
   3.613301156627*^9}, 3.6133013078550577`*^9, {3.613301447081024*^9, 
   3.613301449877001*^9}, {3.6133015415117207`*^9, 3.6133015541220617`*^9}, {
   3.6133016618658733`*^9, 3.613301704111124*^9}, {3.61330185743235*^9, 
   3.613301871088355*^9}, {3.613301910782558*^9, 3.6133019246441307`*^9}, {
   3.613301999871911*^9, 3.6133020708752737`*^9}, {3.61330239110786*^9, 
   3.613302487596188*^9}, {3.613302551646475*^9, 3.61330262406814*^9}, {
   3.6133045173899403`*^9, 3.6133045479377737`*^9}, {3.6133047488389683`*^9, 
   3.6133047694867353`*^9}, {3.613304829996623*^9, 3.613304868581319*^9}, {
   3.613304943519965*^9, 3.613304948407606*^9}, {3.6133053005957613`*^9, 
   3.613305319748056*^9}, {3.6133261571880493`*^9, 3.613326178299334*^9}, {
   3.613326367599222*^9, 3.613326560664708*^9}, {3.613326591582814*^9, 
   3.613326696955864*^9}, {3.613327160076173*^9, 3.613327161075317*^9}, {
   3.61332757642347*^9, 3.613327611115761*^9}, {3.613327657453199*^9, 
   3.613327813791049*^9}, {3.61332805091748*^9, 3.6133280531810827`*^9}, {
   3.613328083202976*^9, 3.613328090811761*^9}, 3.613328347059229*^9, {
   3.613328833019064*^9, 3.6133288553167562`*^9}, {3.6133291560666847`*^9, 
   3.613329177719489*^9}, 3.6141771183999968`*^9, {3.614189292301111*^9, 
   3.614189302092698*^9}, {3.614361699979642*^9, 3.614361719890554*^9}, {
   3.614504566104581*^9, 3.614504591016654*^9}, {3.614504663864559*^9, 
   3.614504666982682*^9}, {3.614545423593639*^9, 3.614545467974424*^9}, {
   3.614545503295141*^9, 3.614545505932638*^9}, {3.6145455804415207`*^9, 
   3.614545585925158*^9}, {3.614545671972193*^9, 3.614545700909773*^9}, {
   3.61461389665655*^9, 3.6146138980964413`*^9}, {3.614614204204667*^9, 
   3.6146142157163477`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["k", "y"], " ", "q", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}], 
        "]"}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{"\[SmallCircle]", " ", 
          RowBox[{
           SubscriptBox["B", "x"], "[", 
           RowBox[{"z", ",", "t"}], "]"}]}], "]"}]}], "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        SubsuperscriptBox["k", "y", "2"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{"\[SmallCircle]", " ", 
          RowBox[{
           SubscriptBox["B", "x"], "[", 
           RowBox[{"z", ",", "t"}], "]"}]}], "]"}]}], "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}], 
          " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "x"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "]"}]}], "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["B", "x"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}], 
           "]"}]}], "]"}]}], "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{"\[SmallCircle]", " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            RowBox[{
             SubscriptBox["B", "x"], "[", 
             RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            RowBox[{
             SubscriptBox["B", "x"], "[", 
             RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["\[EmptyUpTriangle]", "2"], 
              RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}], 
           "]"}]}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "x"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], 
         "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "y"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], 
         "]"}]}], "-", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], "[", 
             RowBox[{
              SubscriptBox["B", "x"], "[", 
              RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], 
         "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["k", "y"]}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{"\[SmallCircle]", " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "x"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            RowBox[{
             SubscriptBox["B", "x"], "[", 
             RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], 
         "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "x"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        SubsuperscriptBox["k", "y", "2"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "y"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], "]"}]}], "-", 
       RowBox[{
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            RowBox[{
             SubscriptBox["\[PartialD]", "z"], "[", 
             RowBox[{
              SubscriptBox["B", "x"], "[", 
              RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}], 
       "+", 
       RowBox[{"q", " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}]}], 
      "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"]}], " ", "\[SmallCircle]", 
        " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "x"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "x"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "x"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "-", 
       RowBox[{
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "x"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "x"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}]}], 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "x"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}], "]"}]}],
        "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "x"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], "-", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        SubsuperscriptBox["k", "y", "2"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "x"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "x"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "q"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}], 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.613304869590173*^9, 3.6133049495007257`*^9, 3.6133053207405367`*^9, {
   3.613326485387342*^9, 3.613326561490202*^9}, {3.613326595815199*^9, 
   3.6133266040226097`*^9}, 3.613326660026622*^9, 3.61332716201223*^9, {
   3.6133275947793913`*^9, 3.613327612121537*^9}, {3.613327744727991*^9, 
   3.613327815555489*^9}, 3.613328054239262*^9, 3.613328356531164*^9, 
   3.613328856170669*^9, {3.613329165606255*^9, 3.613329178601987*^9}, 
   3.614177119713147*^9, 3.614189304110643*^9, 3.6143617220896473`*^9, 
   3.614504591952222*^9, 3.614504668409453*^9, 3.614542661480213*^9, 
   3.614545459261648*^9, 3.6145455874121523`*^9, {3.614545678856031*^9, 
   3.614545702075966*^9}, 3.614613916915284*^9, 3.6146142165153627`*^9, 
   3.614615738904825*^9, 3.614616051270179*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Working out the matrix product, and getting things into a \
\[OpenCurlyDoubleQuote]code convenient\[CloseCurlyDoubleQuote] form\
\>", "Subsection",
 CellChangeTimes->{{3.613329080723421*^9, 3.613329105297495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Cmat", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Cm", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "numVariables"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "numVariables"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullMatrixEquations", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Aop", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"ph", "->", 
          RowBox[{"Cmat", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "numVariables"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "numVariables"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "numVariables"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Redefine", " ", "lapF", " ", "to", " ", "collect", " ", "as", " ", 
     "many", " ", "terms", " ", "as", " ", "possible"}], ",", " ", 
    RowBox[{"collect", " ", "in", " ", "mean", " ", "fields"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullMatrixEquations", "=", 
   RowBox[{"MapAll", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{"#", ",", "meanFieldsWDerivs"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"fullMatrixEquations", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Through", "[", 
          RowBox[{"meanFields", "@@", 
           RowBox[{"{", 
            RowBox[{"z", ",", "t"}], "}"}]}], "]"}], "->", "meanFields"}], 
        "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"Easier", " ", "to", " ", "look", " ", "at"}], "*)"}], "/.", 
      "\[IndentingNewLine]", 
      RowBox[{"iLapF", "\[Rule]", "iLapFColl"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"Collect", " ", "iLapF", " ", "terms"}], "*)"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fullMatrixEquations", "=", 
  RowBox[{"fullMatrixEquations", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dz", "[", 
       RowBox[{"a_", "/;", 
        RowBox[{"!", 
         RowBox[{"meanFieldQ", "[", "a", "]"}]}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"dz", " ", "a"}]}], ",", 
     RowBox[{
      RowBox[{"iLap2", "[", "a_", "]"}], "\[RuleDelayed]", 
      RowBox[{"iLap2", " ", "a"}]}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.614183523653407*^9, 3.614183619973299*^9}, {
   3.6141837102104187`*^9, 3.61418374185849*^9}, {3.6141849032639017`*^9, 
   3.614184910371166*^9}, {3.6141856403035383`*^9, 3.614185671246872*^9}, {
   3.614185814106379*^9, 3.614185877677721*^9}, {3.614186008201589*^9, 
   3.6141860563838873`*^9}, {3.6141861298094*^9, 3.614186133404842*^9}, {
   3.614186265993711*^9, 3.614186266722341*^9}, {3.61418645140637*^9, 
   3.61418648051291*^9}, {3.614186552940997*^9, 3.6141865737590837`*^9}, {
   3.614188523622821*^9, 3.6141885248935966`*^9}, {3.614189283362381*^9, 
   3.614189315179832*^9}, {3.614189422729567*^9, 3.614189433440941*^9}, {
   3.614189677743164*^9, 3.61418967848466*^9}, {3.6141967572921963`*^9, 
   3.6141967583883953`*^9}, {3.6141989228199043`*^9, 3.614198945631775*^9}, 
   3.614198982104651*^9, {3.614361772710515*^9, 3.6143618063669567`*^9}, {
   3.614504631869879*^9, 3.614504678095435*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"2", "\[InvisibleComma]", "4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "1"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "2"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "3"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"4", "\[InvisibleComma]", "4"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.614186133917675*^9, 3.614186267048477*^9, 3.614186481926425*^9, 
   3.6141885255283833`*^9, 3.614189319838678*^9, {3.6141894304574347`*^9, 
   3.614189433941032*^9}, 3.614189678940024*^9, 3.614195966966*^9, 
   3.614196761527596*^9, {3.61419892962738*^9, 3.614198946179511*^9}, 
   3.61419898388535*^9, {3.614361787735118*^9, 3.614361807137169*^9}, 
   3.614504597712901*^9, {3.614504637573621*^9, 3.6145046797962427`*^9}, 
   3.614542667785318*^9, 3.614545623141712*^9, 3.614545706505865*^9, 
   3.614545743858747*^9, 3.61461400100451*^9, 3.6146142242536373`*^9, 
   3.614615742538946*^9, 3.614616053498505*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["B", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "-", 
           RowBox[{
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "1"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "x"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "-", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           SubscriptBox["B", "x"], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["\[PartialD]", "z"]}], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "-", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            SubscriptBox["B", "x"], "]"}], "]"}], "]"}]}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "2"}]]}], "+", 
        RowBox[{
         SubscriptBox["B", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "-", 
           RowBox[{
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "2"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "x"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "-", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           SubscriptBox["B", "x"], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["\[PartialD]", "z"]}], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "-", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            SubscriptBox["B", "x"], "]"}], "]"}], "]"}]}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "3"}]]}], "+", 
        RowBox[{
         SubscriptBox["B", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "-", 
           RowBox[{
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "3"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "x"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "-", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           SubscriptBox["B", "x"], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["\[PartialD]", "z"]}], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "-", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            SubscriptBox["B", "x"], "]"}], "]"}], "]"}]}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[EmptyUpTriangle]", "Fc"], 
        RowBox[{"-", "1"}]], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], " ", 
         SubscriptBox["k", "y"], " ", "q", " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["\[PartialD]", "z"], " ", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"2", "\[InvisibleComma]", "4"}]]}], "+", 
        RowBox[{
         SubscriptBox["B", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "3"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "-", 
           RowBox[{
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "4"}]]}], "+", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "x"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SuperscriptBox[
             OverscriptBox[
              SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubsuperscriptBox["k", "y", "2"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          SubscriptBox["B", "y"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "-", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[PartialD]", "z"], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           SubscriptBox["B", "x"], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["\[PartialD]", "z"]}], " ", 
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            OverscriptBox[
             SubscriptBox["k", "x"], "\[LongDash]"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "-", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], " ", 
            SubscriptBox["k", "y"], " ", 
            SubscriptBox["\[ScriptCapitalC]", 
             RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["\[PartialD]", "z"], "[", 
            SubscriptBox["B", "x"], "]"}], "]"}], "]"}]}]}], "]"}]}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "1"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "2"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "3"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["\[PartialD]", "z"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"4", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "4"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["\[PartialD]", "z"]}], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"4", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "1"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "1"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "1"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "1"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "2"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "2"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "2"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "2"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "3"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "3"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "3"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "3"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "x"], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       SubscriptBox["B", "y"], " ", 
       SubscriptBox["k", "y"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"2", "\[InvisibleComma]", "4"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], " ", "q", " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"3", "\[InvisibleComma]", "4"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]]}], " ", 
          SuperscriptBox[
           OverscriptBox[
            SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubsuperscriptBox["\[PartialD]", "z", "2"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubsuperscriptBox["k", "y", "2"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], " ", 
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          OverscriptBox[
           SubscriptBox["k", "x"], "\[LongDash]"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"1", "\[InvisibleComma]", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], " ", 
          SubscriptBox["k", "y"], " ", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"2", "\[InvisibleComma]", "4"}]]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["B", "y"], "]"}], "]"}]}]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.614186133917675*^9, 3.614186267048477*^9, 3.614186481926425*^9, 
   3.6141885255283833`*^9, 3.614189319838678*^9, {3.6141894304574347`*^9, 
   3.614189433941032*^9}, 3.614189678940024*^9, 3.614195966966*^9, 
   3.614196761527596*^9, {3.61419892962738*^9, 3.614198946179511*^9}, 
   3.61419898388535*^9, {3.614361787735118*^9, 3.614361807137169*^9}, 
   3.614504597712901*^9, {3.614504637573621*^9, 3.6145046797962427`*^9}, 
   3.614542667785318*^9, 3.614545623141712*^9, 3.614545706505865*^9, 
   3.614545743858747*^9, 3.61461400100451*^9, 3.6146142242536373`*^9, 
   3.614615742538946*^9, 3.6146160535530643`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Put everything into c++ form, including taking the Fourier transforms\
\>", "Subsection",
 CellChangeTimes->{{3.614195675973181*^9, 3.614195696141123*^9}}],

Cell[CellGroupData[{

Cell["Define the various functions and variables to use in c++", \
"Subsubsection",
 CellChangeTimes->{
  3.614200068915313*^9, {3.6145427017460127`*^9, 3.614542707265788*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CklOut", " ", "=", " ", "\"\<Ckl_out[i]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CklIn", " ", "=", " ", "\"\<Ckl_in[i]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ifft", " ", "=", " ", "\"\<fft_.back_2DFull\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fft", " ", "=", " ", "\"\<fft_.for_2DFull\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dealias", " ", "=", " ", "\"\<dealias\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cppProducts", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<.asDiagonal()*\>\"", ",", "\"\<*\>\""}], "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Second", " ", "one", " ", "is", " ", "for", " ", "scalars"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MFcppVariables", " ", "=", 
  RowBox[{"Thread", "[", " ", 
   RowBox[{"meanFieldsWDerivs", "->", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<_\>\""}], "&"}], "/@",
        "meanFieldsWDerivs"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<\>\""}], ",", 
        RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iLapFvar", " ", "=", " ", "\"\<ilapFtmp_.matrix()\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vectorVars", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"iLap2", ",", "dz", ",", "iLapFColl"}], "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Variables", " ", "that", " ", "are", " ", "vectors", " ", "in", " ", 
    RowBox[{"c", "++"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"variablesInCpp", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ky", "\[Rule]", "\"\<kyctmp_\>\""}], ",", 
    RowBox[{"kxb", "\[Rule]", "\"\<kxctmp_\>\""}], ",", 
    RowBox[{"dz", "\[Rule]", "\"\<kz_\>\""}], ",", 
    RowBox[{"q", "\[Rule]", "\"\<q_\>\""}], ",", 
    RowBox[{"iLap2", "\[Rule]", "\"\<ilap2tmp_\>\""}]}], "}"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQfeAVS0/H21eOxxt/zwXRZ6ReLQLRei+VFoNoHuZ9
G0H02kWzN4NoK0MzhS4gbSbCoQiiTxxtKO4G0iKTZ5SBaE9PiakgWiflPpje
8tLnGIhuKvx+AkRHCK0X6AHS7xT3CILowDYLcRCd8MlSDkT3XXDSBNFOlRfA
dCuHgz6IjkqcAKYDJi4zBtFyfE/BtJjZj5BTQPpHl1w4iHbJrTgPopsWPLoM
oi083O+A6Jr/8x6D6Fct7K9AtJaZOpjeJvbL9jSQLltWYg+ipxgdmg+iNayW
LQDRHf06U84DaY+qhqkg+sauSx8ugMJnvv9HEB344sOev0DaLvvOARAtuOrr
DxAtJFr/C0Tf+xhp8g9k3+eJYDrg4MrbPO9eOUYH+t4B0dNs//6UA9K+Ze6/
QTQAkwjtMQ==
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["B", "x"], "\[Rule]", "\<\"Bx_\"\>"}], ",", 
   RowBox[{
    SubscriptBox["B", "y"], "\[Rule]", "\<\"By_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     SubscriptBox["B", "x"], "]"}], "\[Rule]", "\<\"dzBx_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     SubscriptBox["B", "y"], "]"}], "\[Rule]", "\<\"dzBy_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "[", 
      SubscriptBox["B", "x"], "]"}], "]"}], "\[Rule]", "\<\"dzdzBx_\"\>"}], 
   ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "[", 
      SubscriptBox["B", "y"], "]"}], "]"}], "\[Rule]", "\<\"dzdzBy_\"\>"}], 
   ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "[", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "[", 
       SubscriptBox["B", "x"], "]"}], "]"}], "]"}], 
    "\[Rule]", "\<\"dzdzdzBx_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "[", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "[", 
       SubscriptBox["B", "y"], "]"}], "]"}], "]"}], 
    "\[Rule]", "\<\"dzdzdzBy_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "[", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "[", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "x"], "]"}], "]"}], "]"}], "]"}], 
    "\[Rule]", "\<\"dzdzdzdzBx_\"\>"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "z"], "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "z"], "[", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "[", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["B", "y"], "]"}], "]"}], "]"}], "]"}], 
    "\[Rule]", "\<\"dzdzdzdzBy_\"\>"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6141968971191683`*^9, {3.614196955865787*^9, 3.614196976553069*^9}, 
   3.6141970176273737`*^9, {3.614197140642284*^9, 3.6141971499528723`*^9}, 
   3.61420280515613*^9, 3.6142041474039993`*^9, 3.61420432093274*^9, 
   3.614332753782305*^9, 3.6143334373897533`*^9, 3.614334227966806*^9, 
   3.614335330770611*^9, {3.614342317980378*^9, 3.6143423257325563`*^9}, 
   3.614345100654113*^9, 3.614361816160263*^9, 3.614385394517193*^9, 
   3.614436871615592*^9, 3.6144373337998466`*^9, 3.614437922414172*^9, 
   3.61446781112652*^9, 3.614504610070334*^9, 3.614504924258411*^9, 
   3.614542674887701*^9, 3.61454565515012*^9, 3.614545745944592*^9, 
   3.614614011389887*^9, 3.6146142272975397`*^9, 3.61461574625896*^9, 
   3.6146160687533283`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["k", "y"], "\[Rule]", "\<\"kyctmp_\"\>"}], ",", 
   RowBox[{
    OverscriptBox[
     SubscriptBox["k", "x"], "\[LongDash]"], "\[Rule]", "\<\"kxctmp_\"\>"}], 
   ",", 
   RowBox[{
    SubscriptBox["\[PartialD]", "z"], "\[Rule]", "\<\"kz_\"\>"}], ",", 
   RowBox[{"q", "\[Rule]", "\<\"q_\"\>"}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[EmptyUpTriangle]", "2"], 
     RowBox[{"-", "1"}]], "\[Rule]", "\<\"ilap2tmp_\"\>"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6141968971191683`*^9, {3.614196955865787*^9, 3.614196976553069*^9}, 
   3.6141970176273737`*^9, {3.614197140642284*^9, 3.6141971499528723`*^9}, 
   3.61420280515613*^9, 3.6142041474039993`*^9, 3.61420432093274*^9, 
   3.614332753782305*^9, 3.6143334373897533`*^9, 3.614334227966806*^9, 
   3.614335330770611*^9, {3.614342317980378*^9, 3.6143423257325563`*^9}, 
   3.614345100654113*^9, 3.614361816160263*^9, 3.614385394517193*^9, 
   3.614436871615592*^9, 3.6144373337998466`*^9, 3.614437922414172*^9, 
   3.61446781112652*^9, 3.614504610070334*^9, 3.614504924258411*^9, 
   3.614542674887701*^9, 3.61454565515012*^9, 3.614545745944592*^9, 
   3.614614011389887*^9, 3.6146142272975397`*^9, 3.61461574625896*^9, 
   3.61461606875729*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Setup functions to find all the coefficients and replace by c++ variables, \
save these variables to automatically compute later\
\>", "Subsubsection",
 CellChangeTimes->{{3.6142001576080503`*^9, 3.6142001733730717`*^9}, {
  3.614542687579644*^9, 3.6145426929862757`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "main", " ", "stuff", " ", "you", " ", "might", " ", "want", 
    " ", "to", " ", "change", " ", "is", " ", "in", " ", "this", " ", 
    RowBox[{"Module", ".", " ", "Defines"}], " ", "various", " ", "functions",
     " ", "and", " ", "lists", " ", "to", " ", "identify", " ", "different", 
    " ", "variable", " ", "types"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coeffList", ",", "fullCppMultVariableList", ",", "scalarCppVars", ",", 
       "vectorCppVars", ",", 
       RowBox[{"ftFactorVar", "=", "\"\<fft2Dfac_\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeffList", "=", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"MapMatrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"coeff_", " ", 
                RowBox[{"Cm", "[", 
                 RowBox[{"i1_", ",", "i2_"}], "]"}]}], "\[RuleDelayed]", 
               "coeff"}], ",", "\[Infinity]"}], "]"}], "&"}], ",", 
           "fullMatrixEquations"}], "]"}], "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"meanFieldsWDerivs", "\[Rule]", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeffList", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"coeff_", "\[RuleDelayed]", 
           RowBox[{"Rule", "[", 
            RowBox[{"coeff", ",", 
             RowBox[{"convertProdToString", "[", "coeff", "]"}]}], "]"}]}]}], 
         "&"}], "/@", "coeffList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coeffList", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"coeffList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", 
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ">", 
            RowBox[{"StringLength", "[", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Make", " ", "sure", " ", "longest", " ", "products", " ", "are", " ",
          "first"}], ",", " ", 
        RowBox[{
        "otherwise", " ", "it", " ", "replaces", " ", "others", " ", "too", 
         " ", "early", " ", "and", " ", "they", " ", 
         RowBox[{"don", "'"}], "t", " ", "get", " ", "recognized"}]}], "*)"}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fullMatrixEquationsC", "=", 
       RowBox[{
        RowBox[{"fullMatrixEquations", "/.", "coeffList"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"str1_String", " ", 
           RowBox[{"Cm", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "+", 
          RowBox[{"str2_String", " ", 
           RowBox[{"Cm", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"str1", ",", "\"\<PLUS\>\"", ",", "str2"}], "]"}], " ", 
          RowBox[{"Cm", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Now", " ", "there", " ", "are", " ", "only"}], ",", " ", 
        RowBox[{"Mean", " ", "fields", " ", 
         RowBox[{"(", 
          RowBox[{"and", " ", "derivatives"}], ")"}]}], ",", " ", 
        RowBox[{"C", " ", "matrices"}], ",", " ", 
        RowBox[{"string", " ", "variables"}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
       "Second", " ", "replacment", " ", "is", " ", "for", " ", "sums"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Before", " ", "going", " ", "on"}], ",", " ", 
        RowBox[{
         RowBox[{
         "keep", " ", "the", " ", "list", " ", "of", " ", "string", " ", 
          "variables"}], " ", "-", " ", 
         RowBox[{
         "some", " ", "of", " ", "these", " ", "get", " ", "rather", " ", 
          RowBox[{"long", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullCppMultVariableList", " ", "=", 
       RowBox[{"Union", "[", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{
         "fullMatrixEquationsC", ",", "str_String", ",", "\[Infinity]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"scalarCppVars", " ", "=", " ", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"coeffList", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"Alternatives", "@@", "vectorVars"}], ",", 
              "\[Infinity]"}], "]"}]}], "&"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Separate", " ", "out", " ", "the", " ", "scalar", " ", "variables"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vectorCppVars", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"fullCppMultVariableList", ",", "scalarCppVars"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", 
       RowBox[{"scalarCppQ", ",", "vectorCppQ"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"scalarCppQ", "[", "_", "]"}], "=", "False"}], ";", 
      RowBox[{
       RowBox[{"vectorCppQ", "[", "_", "]"}], "=", "False"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"scalarCppQ", "[", "#", "]"}], "=", "True"}], ")"}], "&"}], 
       "/@", "scalarCppVars"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vectorCppQ", "[", "#", "]"}], "=", "True"}], ")"}], "&"}], 
       "/@", "vectorCppVars"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Q", " ", "functions", " ", "for", " ", "vectors", " ", "and", " ", 
        "scalars"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "rescaleForFFT", "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Adds", " ", "in", " ", "ftfac", " ", "multiplying", " ", "vector", 
        " ", "for", " ", "more", " ", "efficient", " ", "fft", " ", 
        "rescaling"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rescaleForFFT", "[", "a_", "]"}], ":=", "\[IndentingNewLine]", 
       RowBox[{"a", "/.", 
        RowBox[{
         RowBox[{"var_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"scalarCppQ", "[", "#", "]"}], "||", 
             RowBox[{"vectorCppQ", "[", "#", "]"}]}], "&"}], ")"}]}], 
         "\[RuleDelayed]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"newvar", "=", 
             RowBox[{
             "\"\<(\>\"", "<>", "ftFactorVar", "<>", "\"\<*\>\"", "<>", "var",
               "<>", "\"\<)\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scalarCppQ", "[", "var", "]"}], ",", 
              RowBox[{
               RowBox[{"scalarCppQ", "[", "newvar", "]"}], "=", "True"}], ",", 
              RowBox[{
               RowBox[{"vectorCppQ", "[", "newvar", "]"}], "=", "True"}]}], 
             "]"}], ";", "\[IndentingNewLine]", "newvar"}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Product", " ", "to", " ", "use"}], " ", "-", " ", 
        RowBox[{
        "default", " ", "is", " ", "treating", " ", "object", " ", "as", " ", 
         "a", " ", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "vec2DiagProd", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vec2DiagProd", "[", "]"}], "=", 
       RowBox[{
       "cppProducts", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vec2DiagProd", "[", "a_", "]"}], " ", ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"scalarCppQ", "@", "a"}], ",", 
         RowBox[{
         "cppProducts", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "cppProducts", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Replacement", " ", "rules", " ", "from", " ", 
        RowBox[{"c", "++"}], " ", "variables", " ", "to", " ", "real", " ", 
        "products"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CppToBasicVariables", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"fullCppMultVariableList", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{"fullCppMultVariableList", ",", 
              RowBox[{
               RowBox[{"a__", "~~", "\"\<PLUS\>\"", "~~", "b__"}], 
               "\[RuleDelayed]", 
               RowBox[{"a", "+", "b"}]}]}], "]"}], "/.", 
            RowBox[{"StringExpression", "\[Rule]", "Sequence"}]}], "/.", 
           RowBox[{"coeffList", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Collect", " ", "to", " ", "scalar", " ", "and", " ", "vector", " ", 
        "variables"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"CppToBasicVariables", " ", "=", " ", 
       RowBox[{"Gather", "[", 
        RowBox[{"CppToBasicVariables", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"scalarCppQ", "[", 
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "===", 
           RowBox[{"scalarCppQ", "[", 
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "&"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "FUNCTIONS", " ", "TO", " ", "CONVERT", " ", "TO", " ", "CPP", " ", 
     "CODE"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"First", " ", "-", " ", 
     RowBox[{"convert", " ", "to", " ", "symbolic", " ", 
      RowBox[{"code", ".", " ", "Takes"}], " ", "a", " ", "single", " ", 
      "term", " ", "and", " ", "converts", " ", "it", " ", "to", " ", 
      "symbolic", " ", 
      RowBox[{
       RowBox[{"c", "++"}], "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", 
    RowBox[{"toPseudoCppCode", ",", "$numberOfTempsVars"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$numberOfTempsVars", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toPseudoCppCode", "[", 
     RowBox[{"expr_", ",", "index_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "term", ",", "mfgroups", ",", "pseudoCCode", ",", " ", "ntemps", ",", 
        "FFTpseudoCode"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Operators", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SetAttributes", "[", 
        RowBox[{"CPlus", ",", "Orderless"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"CTimes", ",", "Orderless"}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Set", " ", "these", " ", "as", " ", "commutative", " ", "but", " ", 
         "not", " ", "associative"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Replace", " ", "Times", " ", "and", " ", "Plus", " ", "with", " ", 
         "C", " ", "oeprators"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"term", "=", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{"a___", ",", 
             RowBox[{"B_", "?", "meanFieldQ"}], ",", "b___"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"CTimes", "[", 
            RowBox[{"B", ",", 
             RowBox[{"a", " ", "b"}]}], "]"}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Plus", "\[Rule]", "CPlus"}], ",", 
           RowBox[{"Times", "\[Rule]", "CTimes"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "term", "]"}], "===", "CTimes"}], ",", 
         RowBox[{"term", " ", "=", " ", 
          RowBox[{"CPlus", "[", "term", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Find", " ", "terms", " ", "linear", " ", "in", " ", "the", " ", 
         "mean", " ", "fields"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mfgroups", " ", "=", " ", 
        RowBox[{"Position", "[", 
         RowBox[{"term", ",", 
          RowBox[{"CTimes", "[", 
           RowBox[{
            RowBox[{"B_", "?", "meanFieldQ"}], ",", "subt_"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ntemps", " ", "=", " ", 
        RowBox[{"Length", "@", "mfgroups"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Store", " ", "the", " ", "maximum", " ", "number", " ", "of", " ", 
         "temp", " ", "variables", " ", "for", " ", "memory", " ", 
         "assignment", " ", "later"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"ntemps", ">", "$numberOfTempsVars"}], ",", 
         RowBox[{"$numberOfTempsVars", "=", "ntemps"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"First", " ", "stage"}], " ", "-", " ", 
         RowBox[{
         "assign", " ", "temp", " ", "variables", " ", "to", " ", 
          "groups"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pseudoCCode", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"CAssign", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "#", "]"}], ",", 
            RowBox[{"Extract", "[", 
             RowBox[{"term", ",", 
              RowBox[{
              "mfgroups", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "ntemps", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"term", " ", "=", " ", 
        RowBox[{"term", "/.", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Reverse", "/@", "pseudoCCode"}], "/.", 
           RowBox[{"CAssign", "\[Rule]", "Rule"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Replace", " ", "term", " ", "to", " ", "recognize", " ", "temp", " ",
          "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Next", " ", "stage"}], " ", "-", " ", 
         RowBox[{
         "add", " ", "in", " ", "Fourier", " ", "transforms", " ", "for", " ",
           "pseudospectral", " ", "products"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pseudoCCode", "=", 
        RowBox[{"pseudoCCode", "/.", 
         RowBox[{
          RowBox[{"CAssign", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "n_", "]"}], ",", 
            RowBox[{"CTimes", "[", 
             RowBox[{
              RowBox[{"B_", "?", "meanFieldQ"}], ",", "subt_"}], "]"}]}], 
           "]"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CAssign", "[", 
             RowBox[{
              RowBox[{"CTemp", "[", "n", "]"}], ",", 
              RowBox[{"rescaleForFFT", "@", "subt"}]}], "]"}], ",", 
            RowBox[{"Cifft", "[", 
             RowBox[{"CTemp", "[", "n", "]"}], "]"}], ",", 
            RowBox[{"CAssign", "[", 
             RowBox[{
              RowBox[{"CTemp", "[", "n", "]"}], ",", 
              RowBox[{"CTimes", "[", 
               RowBox[{"B", ",", 
                RowBox[{"CTemp", "[", "n", "]"}]}], "]"}]}], "]"}]}], 
           "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Add", " ", "a", " ", "CPlus", " ", "around", " ", "temp", " ", 
         "variables", " ", "to", " ", "find", " ", "bits", " ", "for", " ", 
         "taking", " ", "forward", " ", "ffts"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"term", " ", "=", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"term", ",", 
            RowBox[{
             RowBox[{"CPlus", "[", "a__", "]"}], "\[RuleDelayed]", 
             RowBox[{"CPlus", "[", 
              RowBox[{
               RowBox[{"CPlus", "[", 
                RowBox[{"CTemp", "[", "0", "]"}], "]"}], ",", "a"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//.", 
          RowBox[{
           RowBox[{"CPlus", "[", 
            RowBox[{
             RowBox[{"CPlus", "[", 
              RowBox[{"a___", ",", 
               RowBox[{"CTemp", "[", "0", "]"}]}], "]"}], ",", "tmp_CTemp", 
             ",", "b___"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"CPlus", "[", 
            RowBox[{
             RowBox[{"CPlus", "[", 
              RowBox[{"a", ",", 
               RowBox[{"CTemp", "[", "0", "]"}], ",", "tmp"}], "]"}], ",", 
             "b"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"CPlus", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "0", "]"}], ",", "tmp__"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"CPlus", "[", "tmp", "]"}]}]}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", " ", "rather", " ", "long"}], "-", 
         RowBox[{"winded", " ", "way", " ", "to", " ", "do", " ", "this"}], 
         " ", "-", " ", 
         RowBox[{"surprisingly", " ", "tricky"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Pseudocode", " ", "for", " ", "taking", " ", "forward", " ", 
         "ffts"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"FFTpseudoCode", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"CAssign", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", "#"}], "]"}], ",", 
             RowBox[{"Cfft", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{"term", ",", 
            RowBox[{"CPlus", "[", "tmp__CTemp", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], "//", 
         "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Replace", " ", "temp", " ", "variables", " ", "in", " ", "term"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"term", " ", "=", " ", 
        RowBox[{"term", "/.", 
         RowBox[{"Cases", "[", 
          RowBox[{"FFTpseudoCode", ",", 
           RowBox[{
            RowBox[{"CAssign", "[", "a__", "]"}], "\[RuleDelayed]", 
            RowBox[{"Rule", "@@", 
             RowBox[{"Reverse", "[", 
              RowBox[{"{", "a", "}"}], "]"}]}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Add", " ", "fft", " ", "and", " ", "dealiasing", " ", "on", " ", 
         "the", " ", "end", " ", "and", " ", "remove", " ", "useless", " ", 
         "assignment"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pseudoCCode", " ", "=", " ", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"Join", "[", 
           RowBox[{"pseudoCCode", ",", "FFTpseudoCode", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"CAssign", "[", 
               RowBox[{
                RowBox[{"CTemp", "[", "ntemps", "]"}], ",", "term"}], "]"}], 
              ",", 
              RowBox[{"CDealias", "[", 
               RowBox[{"CTemp", "[", "ntemps", "]"}], "]"}], ",", 
              RowBox[{"CAssign", "[", 
               RowBox[{
                RowBox[{"CBlock", "@@", "index"}], ",", 
                RowBox[{"CTemp", "[", "ntemps", "]"}]}], "]"}]}], "}"}]}], 
           "]"}]}], "/.", 
         RowBox[{
          RowBox[{"CAssign", "[", 
           RowBox[{
            RowBox[{"CTemp", "[", "i_", "]"}], ",", 
            RowBox[{"CPlus", "[", 
             RowBox[{"CTemp", "[", "i_", "]"}], "]"}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"Sequence", "[", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Function", " ", "to", " ", "store", " ", "c", " ", "variable", " ", 
     "definitions", " ", "for", " ", "other", " ", "stuff"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "toCString", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cm", "/:", 
     RowBox[{"toCString", "[", 
      RowBox[{"Cm", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "]"}], ":=", 
     RowBox[{"\"\<C\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", 
      RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<_\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toCString", "[", "a_String", "]"}], ":=", "a"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CTemp", "/:", 
     RowBox[{"toCString", "[", 
      RowBox[{"CTemp", "[", "n_", "]"}], "]"}], ":=", 
     RowBox[{"\"\<Ctmp_\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<_\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"toCString", "[", 
      RowBox[{"mf_", "?", "meanFieldQ"}], "]"}], ":=", 
     RowBox[{"mf", "/.", "MFcppVariables"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Function", " ", "to", " ", 
     RowBox[{"take", " ", ".", "block"}], 
     RowBox[{"(", ")"}], " ", "method", " ", "of", " ", "Ckl_out", " ", 
     "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "ind2EigenBlock"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ind2EigenBlock", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], ",", "cmat_"}], "]"}], ":=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"cmat", "<>", "\"\<.block( \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "NZ"}], ",", "InputForm"}], "]"}],
         "<>", "\"\<, \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "NZ"}], ",", "InputForm"}], "]"}],
         "<>", "\"\<, NZ, NZ)\>\""}], ",", 
       RowBox[{"\"\<NZ\>\"", "\[Rule]", "\"\<NZ_\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Rules", " ", "to", " ", "change", " ", "pseudoCCode", " ", "into", " ", 
     "real", " ", "Ccode"}], " ", "*)"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Must", " ", "be", " ", "used", " ", "with"}], " ", "//."}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"COperatorRules", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"CTimes", "[", 
         RowBox[{"a_String", ",", "b_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", 
         RowBox[{"vec2DiagProd", "[", "a", "]"}], "<>", 
         RowBox[{"toCString", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CTimes", "[", 
         RowBox[{
          RowBox[{"a_", "?", "meanFieldQ"}], ",", "b_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"toCString", "[", "a", "]"}], "<>", 
         RowBox[{"vec2DiagProd", "[", "a", "]"}], "<>", 
         RowBox[{"toCString", "[", "b", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CPlus", "[", "a__String", "]"}], "\[RuleDelayed]", 
        RowBox[{"ToString", "@", 
         RowBox[{"Row", "[", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", "\"\< + \>\""}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CPlus", "[", 
         RowBox[{"a___", ",", "tmp_CTemp", ",", "b___"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"CPlus", "[", 
         RowBox[{"a", ",", 
          RowBox[{"toCString", "[", "tmp", "]"}], ",", "b"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CAssign", "[", 
         RowBox[{"tmp_", ",", "b_String"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"toCString", "[", "tmp", "]"}], "<>", "\"\< = \>\"", "<>", 
         "b"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CAssign", "[", 
         RowBox[{"str_String", ",", "tmp_CTemp"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"CAssign", "[", 
         RowBox[{"str", ",", 
          RowBox[{"toCString", "[", "tmp", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cfft", "[", "a_CTemp", "]"}], "\[RuleDelayed]", 
        RowBox[{"fft", "<>", "\"\<( \>\"", "<>", 
         RowBox[{"toCString", "@", "a"}], "<>", " ", "\"\< )\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cifft", "[", "a_CTemp", "]"}], "\[RuleDelayed]", 
        RowBox[{"ifft", "<>", "\"\<( \>\"", "<>", 
         RowBox[{"toCString", "@", "a"}], "<>", " ", "\"\< )\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iLapFColl", "[", "str_String", "]"}], "\[RuleDelayed]", 
        RowBox[{"iLapFvar", "<>", 
         RowBox[{"vec2DiagProd", "[", "]"}], "<>", "\"\<(\>\"", "<>", "str", 
         "<>", "\"\<)\>\""}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CBlock", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
        RowBox[{"ind2EigenBlock", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], ",", "CklOut"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CDealias", "[", "tmp_CTemp", "]"}], "\[RuleDelayed]", 
        RowBox[{"dealias", "<>", "\"\<(\>\"", "<>", 
         RowBox[{"toCString", "[", "tmp", "]"}], "<>", "\"\<)\>\""}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.614199820333446*^9, 3.614199973544842*^9}, {
   3.614200154568696*^9, 3.614200177457288*^9}, {3.614203202742343*^9, 
   3.6142032132053423`*^9}, {3.614203687436726*^9, 3.614203694398652*^9}, {
   3.614204078926628*^9, 3.614204079422367*^9}, 3.6142041354989843`*^9, {
   3.614204166229424*^9, 3.6142042190601587`*^9}, {3.614204254561245*^9, 
   3.614204333690789*^9}, {3.614331697718234*^9, 3.61433174227547*^9}, {
   3.614331906693769*^9, 3.614331911117732*^9}, {3.614331987606147*^9, 
   3.614332000077257*^9}, {3.614332466912683*^9, 3.614332469135511*^9}, {
   3.614332812588958*^9, 3.614332843516348*^9}, {3.614332874370685*^9, 
   3.614332874698839*^9}, {3.614332908946308*^9, 3.6143329191369057`*^9}, {
   3.614333144869622*^9, 3.614333156472726*^9}, {3.6143332710284643`*^9, 
   3.614333279858944*^9}, {3.6143622085326366`*^9, 3.614362280097941*^9}, 
   3.614362399974094*^9, {3.614362430655244*^9, 3.614362460967514*^9}, {
   3.6143846802878942`*^9, 3.614384682302619*^9}, 3.614436190971469*^9, {
   3.614436331371933*^9, 3.6144363355680647`*^9}, {3.614437229054408*^9, 
   3.61443728430906*^9}, {3.614437337853598*^9, 3.614437440432015*^9}, {
   3.614437482905383*^9, 3.614437585144912*^9}, {3.614437630726707*^9, 
   3.614437785531118*^9}, {3.614437848964754*^9, 3.614437967122786*^9}, {
   3.6144380848799877`*^9, 3.6144381352511873`*^9}, {3.6144382227794724`*^9, 
   3.614438293388933*^9}, {3.61443989562008*^9, 3.614439938088032*^9}, {
   3.6144401493798637`*^9, 3.61444017699675*^9}, {3.61444021553305*^9, 
   3.614440310323646*^9}, {3.61444036659039*^9, 3.614440615353231*^9}, {
   3.614440664885353*^9, 3.6144407634596643`*^9}, {3.614466811204368*^9, 
   3.614466893555069*^9}, {3.614467338629237*^9, 3.614467397648348*^9}, {
   3.614467447634305*^9, 3.614467566346293*^9}, {3.614467600650503*^9, 
   3.6144676225940247`*^9}, {3.6144676700570917`*^9, 3.614467711185996*^9}, {
   3.614467791283551*^9, 3.614467797969377*^9}, {3.6144679149890614`*^9, 
   3.614467955286832*^9}, {3.614467991859248*^9, 3.6144679928261623`*^9}, {
   3.614504879859517*^9, 3.6145049079875603`*^9}, {3.61454283629358*^9, 
   3.614542837167223*^9}, {3.614542878595272*^9, 3.6145428815772047`*^9}, {
   3.614543175274213*^9, 3.614543217236944*^9}, {3.614543286011907*^9, 
   3.614543330056481*^9}, 3.614543427918807*^9, {3.614544016420259*^9, 
   3.614544016783902*^9}, {3.614545405652108*^9, 3.6145454062903223`*^9}, {
   3.614553685029169*^9, 3.614553713332426*^9}, {3.614553820920223*^9, 
   3.614553821614222*^9}, 3.61461464321903*^9, 3.6146160614501553`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scalarCppQ", "//", "DownValues"}]], "Input",
 CellChangeTimes->{{3.614615624589587*^9, 3.614615659073743*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "\<\"Tkxb\"\>", "]"}], "]"}], 
    "\[RuleDelayed]", "True"}], ",", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "\<\"TkxbP3\"\>", "]"}], "]"}], 
    "\[RuleDelayed]", "True"}], ",", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "\<\"TkxbTkyP2\"\>", "]"}], "]"}], 
    "\[RuleDelayed]", "True"}], ",", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "\<\"Tky\"\>", "]"}], "]"}], "\[RuleDelayed]",
     "True"}], ",", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "\<\"Tm2TkxbTkyTq\"\>", "]"}], "]"}], 
    "\[RuleDelayed]", "True"}], ",", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "\<\"Tmkxb\"\>", "]"}], "]"}], 
    "\[RuleDelayed]", "True"}], ",", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "\<\"Tmky\"\>", "]"}], "]"}], 
    "\[RuleDelayed]", "True"}], ",", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"scalarCppQ", "[", "_", "]"}], "]"}], "\[RuleDelayed]", 
    "False"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.614615630809504*^9, 3.614615659556692*^9}, 
   3.614616071331668*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Split up and assign to Ckl_out", "Subsubsection",
 CellChangeTimes->{{3.6142046790049763`*^9, 3.614204686099799*^9}, {
  3.6142051931686783`*^9, 3.614205195159081*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tmp", ",", "variableDef", ",", "vecPreVarStringList", ",", 
      "scalarPreVarStringList", ",", "vectorPreVarQ", ",", "scalarPreVarQ", 
      ",", "ctempVars", ",", "cmatVars"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Form", " ", "the", " ", "full", " ", "equations", " ", "as", " ", "a", 
      " ", "single", " ", "text", " ", "block"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fullEquations", " ", "=", " ", 
      RowBox[{
       RowBox[{"StringJoin", "@@", 
        RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"StringJoin", "@@", 
              RowBox[{"Riffle", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"toPseudoCppCode", "[", 
                  RowBox[{
                   RowBox[{"fullMatrixEquationsC", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "//.", 
                 "COperatorRules"}], ",", "\"\<;\\n\>\""}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", "\"\<;\\n\\n\\n\\n\>\""}], "]"}]}], "<>", 
       "\"\<;\\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Form", " ", "the", " ", "variable", " ", "definitions"}], " ",
        "-", " ", 
       RowBox[{
       "the", " ", "functions", " ", "here", " ", "are", " ", "for", " ", 
        "pre"}], "-", 
       RowBox[{"defined", " ", "variables", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", ".", "g", "."}], ",", " ", "kxctmp_"}], ")"}], " ", 
        "not", " ", "the", " ", "automatically", " ", "generated", " ", 
        "ones"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vecPreVarStringList", " ", "=", 
      RowBox[{
       RowBox[{"List", "@@", "vectorVars"}], "/.", "variablesInCpp"}]}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "vector", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scalarPreVarStringList", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"variablesInCpp", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        "vecPreVarStringList"}], "]"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "vector", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vectorPreVarQ", " ", "=", " ", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "vecPreVarStringList", "]"}], ";",
            "vecPreVarStringList"}], ")"}], ",", "#"}], "]"}], "&"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Returns", " ", "true", " ", "for", " ", "vector", " ", "variable"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scalarPreVarQ", " ", "=", " ", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "scalarPreVarStringList", "]"}], 
           ";", "scalarPreVarStringList"}], ")"}], ",", "#"}], "]"}], " ", 
       "&"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Returns", " ", "true", " ", "for", " ", "scalar", " ", "variable"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Collect", " ", "matrix", " ", "bits", " ", "together"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CppToBasicVariables", "/.", "variablesInCpp"}], "/.", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "?", "vectorPreVarQ"}], "^", "n_"}], 
          "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tmp", " ", "=", " ", 
             RowBox[{"a", "<>", "\"\<.pow(\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<)\>\""}]}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"vecPreVarStringList", ",", "tmp"}], "]"}], ";", "tmp"}],
            ")"}]}]}], "/.", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"a_", "?", "vectorPreVarQ"}], "  ", 
          RowBox[{"b_", "?", "vectorPreVarQ"}]}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<(\>\"", "<>", "a", "<>", "\"\<*\>\"", "<>", "b", "<>", 
          "\"\<).matrix()\>\""}]}]}], "/.", 
       RowBox[{
        RowBox[{"a_", "?", "vectorPreVarQ"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", "\"\<.matrix()\>\""}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Collect", " ", "scalar", " ", "bits", " ", "together"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fullCppVaribles", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_", "?", "scalarPreVarQ"}], "^", "n_"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{"\"\<pow(\>\"", "<>", 
               RowBox[{"ToString", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
               RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<)\>\""}]}], 
             ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"scalarPreVarStringList", ",", "tmp"}], "]"}], ";", 
             "tmp"}], ")"}]}]}], "/.", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "?", "scalarPreVarQ"}], " ", 
           RowBox[{"b_", "?", "scalarPreVarQ"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"scalarPreVarStringList", ",", 
              RowBox[{
              "\"\<(\>\"", "<>", "a", "<>", "\"\<*\>\"", "<>", "b", "<>", 
               "\"\<)\>\""}]}], "]"}], ";", 
            RowBox[{
            "\"\<(\>\"", "<>", "a", "<>", "\"\<*\>\"", "<>", "b", "<>", 
             "\"\<)\>\""}]}], ")"}]}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"n_", "?", "NumericQ"}], " ", 
          RowBox[{"a_", "?", "scalarPreVarQ"}]}], "\[RuleDelayed]", 
         RowBox[{"\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "n", "]"}], "]"}], "<>", "\"\<*\>\"", "<>", "a", 
          "<>", "\"\<)\>\""}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"n_", "?", "NumericQ"}], " ", "b_String"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"N", "[", "n", "]"}], "]"}], "<>", "\"\<*\>\"", "<>", 
         "b"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{"fullCppVaribles", "/.", 
        RowBox[{
         RowBox[{"a_String", " ", "b_String"}], "\[RuleDelayed]", 
         RowBox[{"a", "<>", "\"\<*\>\"", "<>", "b"}]}]}], "/.", 
       RowBox[{
        RowBox[{"a_String", " ", "+", " ", "b_String"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", "\"\< + \>\"", "<>", "b"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ctempVars", " ", "=", " ", 
      RowBox[{"toCString", "/@", 
       RowBox[{"(", 
        RowBox[{"CTemp", "/@", 
         RowBox[{"Range", "[", "$numberOfTempsVars", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cmatVars", " ", "=", 
      RowBox[{"toCString", "/@", 
       RowBox[{"Flatten", "[", "Cmat", "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"Declare", " ", "variables", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "class", " ", "definition"}], ")"}]}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"classVariableDec", " ", "=", " ", 
      RowBox[{"\"\<dcmplxVecM \>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"CppToBasicVariables", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
          ",", "\"\<, \>\""}], "]"}]}], "<>", "\"\<;\\n\\n\>\"", "<>", 
       "\[IndentingNewLine]", "\"\<dcmplx \>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"CppToBasicVariables", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
          ",", "\"\<, \>\""}], "]"}]}], "<>", "\"\<;\\n\\n\>\"", "<>", 
       "\[IndentingNewLine]", "\"\<dcmplxMat \>\"", "<>", " ", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{"ctempVars", ",", "\"\<, \>\""}], "]"}]}], "<>", 
       "\"\<;\\n\\n\>\"", "<>", "\[IndentingNewLine]", "\"\<dcmplxMat \>\"", "<>",
        " ", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{"cmatVars", ",", "\"\<, \>\""}], "]"}]}], "<>", 
       "\"\<;\\n\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "memory", " ", "to", " ", "variables", " ", "in", " ", 
       "class", " ", "constructor"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"classConstrAssignMem", " ", "=", 
      RowBox[{
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< = dcmplxVecM(NZ_);\\n\>\""}], "&"}], "/@", 
          RowBox[{"CppToBasicVariables", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ")"}]}], "<>", "\"\<\\n\>\"", "<>", "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< = dcmplxMat(NZ_,NZ_);\\n\>\""}], "&"}], "/@",
           "ctempVars"}], ")"}]}], "<>", "\"\<\\n\>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< = dcmplxMat(NZ_,NZ_);\\n\>\""}], "&"}], "/@",
           "cmatVars"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "variables", " ", "inside", " ", "the", " ", 
       "equations"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"assignCppVarsInEqs", " ", "=", 
      RowBox[{
      "\"\<// Vector variable definition (automatic)\\n\>\"", "<>", " ", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "<>", "\"\< = \>\"", " ", "<>", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "<>", "\"\<;\\n\>\""}], "&"}], "/@", 
          RowBox[{
          "fullCppVaribles", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"assignCppVarsInEqs", " ", "=", 
      RowBox[{
      "\"\<// Scalar variable definition (automatic)\\n\>\"", "<>", " ", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "<>", "\"\< = \>\"", " ", "<>", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "<>", "\"\<;\\n\>\""}], "&"}], "/@", 
          RowBox[{
          "fullCppVaribles", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], ")"}]}], "<>", "\"\<\\n\>\"", "<>", 
       "assignCppVarsInEqs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assignCppVarsInEqs", " ", "=", " ", 
      RowBox[{
      "\"\<// Submatrix variable definition (automatic)\\n\>\"", "<>", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"toCString", "[", 
                RowBox[{"Cm", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
               RowBox[{"ind2EigenBlock", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}], ",", "CklIn"}], "]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "numVariables"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "numVariables"}], "}"}]}], "]"}]}], ",", 
           "\"\<;\\n\>\""}], "]"}]}], ")"}], "<>", "\"\<;\\n\\n\>\"", "<>", 
       "assignCppVarsInEqs"}]}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
    "SAVE", " ", "ALL", " ", "THIS", " ", "STUFF", " ", "TO", " ", "FILE"}], 
    " ", "*)"}],
   FontColor->RGBColor[0.5, 0, 0.5]]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<~/Documents/MRIDSS/Mathematica/MMA_Generated_Equations_fullBQlin.cpp\>\
\"", ",", "\[IndentingNewLine]", 
   RowBox[{
   "\"\<// Automatically generated temporary variables - class \
definition\\n\>\"", "<>", "\[IndentingNewLine]", "classVariableDec", "<>", 
    "\"\<\\n\\n\\n\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<// Automatically generated temporary variables - class \
constructor\\n\>\"", "<>", "\[IndentingNewLine]", "classConstrAssignMem", 
    "<>", "\"\<\\n\\n\\n\\n\\n\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<//Assign automatically generated variables in equations \\n\>\"", "<>",
     "\[IndentingNewLine]", "assignCppVarsInEqs", "<>", 
    "\"\<\\n\\n\\n\\n\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
    "\"\<////////////////////////////////////////////////////////\\n\>\"", "<>",
     "\[IndentingNewLine]", 
    "\"\<///       AUTOMATICALLY GENERATED EQUATIONS         /////\\n\>\"", "<>",
     "\[IndentingNewLine]", 
    "\"\<///       see GenerateC++Equations.nb in MMA        /////\\n\\n\>\"",
     "<>", "\[IndentingNewLine]", "fullEquations", "<>", 
    "\[IndentingNewLine]", 
    "\"\<///     AUTOMATICALLY GENERATED EQUATIONS - END       ///\\n\>\"", "<>",
     "\[IndentingNewLine]", 
    "\"\<////////////////////////////////////////////////////////\\n\>\""}], 
   ",", "\[IndentingNewLine]", "\"\<Text\>\""}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6142047962878428`*^9, 3.6142048287650623`*^9}, {
   3.6142048623685904`*^9, 3.614204871407317*^9}, {3.614204927104175*^9, 
   3.614205167284988*^9}, {3.6142056503063517`*^9, 3.61420569620709*^9}, {
   3.614205733874864*^9, 3.6142057372347527`*^9}, {3.614205801605402*^9, 
   3.6142058147158327`*^9}, {3.614205856654711*^9, 3.614205911695675*^9}, {
   3.614206098560555*^9, 3.6142061335704403`*^9}, {3.614206170108762*^9, 
   3.6142061881144047`*^9}, 3.614206293851531*^9, {3.614206461617001*^9, 
   3.614206486966379*^9}, {3.6142065247418213`*^9, 3.614206525340083*^9}, {
   3.6142065934740763`*^9, 3.6142066005860767`*^9}, {3.614206631795189*^9, 
   3.61420665105902*^9}, {3.6142067668503103`*^9, 3.614206811713435*^9}, {
   3.614206859537304*^9, 3.614206860286922*^9}, {3.6142944293493757`*^9, 
   3.6142944433506927`*^9}, {3.614333316719392*^9, 3.6143334120699873`*^9}, {
   3.614333444377398*^9, 3.614333520964388*^9}, {3.614334399437749*^9, 
   3.61433440340563*^9}, {3.6143353683089323`*^9, 3.614335386748166*^9}, {
   3.6143356115565863`*^9, 3.614335642695072*^9}, {3.614335677308119*^9, 
   3.6143357063543158`*^9}, {3.61433586767843*^9, 3.614336158690496*^9}, {
   3.614336266943084*^9, 3.614336291062385*^9}, {3.614336322628447*^9, 
   3.614336357271209*^9}, {3.614336422201798*^9, 3.61433649219413*^9}, {
   3.6143365411420527`*^9, 3.614336642975008*^9}, {3.614336674388867*^9, 
   3.6143367439724493`*^9}, {3.6143368053654327`*^9, 3.614336827572853*^9}, {
   3.614336871824078*^9, 3.6143368722227917`*^9}, {3.614336903252371*^9, 
   3.614336957793364*^9}, {3.614337118801602*^9, 3.614337369809972*^9}, {
   3.6143374183062*^9, 3.614337432720202*^9}, {3.6143375078514223`*^9, 
   3.6143375282046423`*^9}, {3.6143376036820707`*^9, 3.614337849225244*^9}, {
   3.6143384130703163`*^9, 3.6143384249236937`*^9}, {3.614342468760648*^9, 
   3.614342483795895*^9}, {3.614344870214403*^9, 3.6143448765804043`*^9}, {
   3.6144668024268312`*^9, 3.61446680622049*^9}, {3.614468473094071*^9, 
   3.614468475362665*^9}, {3.6144685580405807`*^9, 3.61446858694422*^9}, {
   3.614468765757752*^9, 3.614468940401372*^9}, {3.614468984586191*^9, 
   3.6144689917783127`*^9}, {3.6144690589896708`*^9, 3.614469059077342*^9}, {
   3.6144691527364483`*^9, 3.6144693667898083`*^9}, {3.614469425367859*^9, 
   3.614469464109496*^9}, {3.6144695490098*^9, 3.6144695491606627`*^9}, {
   3.6144696598494787`*^9, 3.614469660520706*^9}, {3.614469930003291*^9, 
   3.614469937711336*^9}, {3.6144705198149643`*^9, 3.6144705200068417`*^9}, {
   3.6144706655301447`*^9, 3.614470681320969*^9}, {3.614504720143795*^9, 
   3.614504863524947*^9}, {3.614505100915875*^9, 3.614505121919724*^9}, {
   3.614505152906884*^9, 3.614505155503438*^9}, {3.614505221394732*^9, 
   3.614505221833407*^9}, {3.614505263530373*^9, 3.614505263936371*^9}, 
   3.614505308586783*^9, {3.614542746037664*^9, 3.6145427529093513`*^9}, {
   3.61461405830389*^9, 3.614614058847625*^9}, {3.614614417854628*^9, 
   3.614614458527823*^9}, {3.6146144956214952`*^9, 3.614614625662765*^9}, {
   3.6150297979412947`*^9, 3.615029816415002*^9}, 3.6150304053572807`*^9}],

Cell[BoxData["\<\"~/Documents/MRIDSS/Mathematica/MMA_Generated_Equations_\
fullBQlin.cpp\"\>"], "Output",
 CellChangeTimes->{
  3.6143387121822042`*^9, 3.614342337188706*^9, 3.614342486239141*^9, {
   3.6143448771742496`*^9, 3.61434488321599*^9}, 3.6143450218542852`*^9, 
   3.6143451076824017`*^9, 3.6144684790958347`*^9, 3.614469003670755*^9, 
   3.614469059822981*^9, {3.614469192413805*^9, 3.6144692034064283`*^9}, 
   3.614469373655657*^9, 3.6144694649976387`*^9, 3.614469550711421*^9, 
   3.6144696641046753`*^9, 3.614469938679933*^9, 3.614470523412774*^9, {
   3.614505127983507*^9, 3.6145051571376143`*^9}, 3.6145052231571608`*^9, 
   3.614505266300125*^9, 3.614505313529387*^9, {3.6145427143213997`*^9, 
   3.614542725540413*^9}, 3.614542757103635*^9, 3.614542844817013*^9, 
   3.614542885049453*^9, 3.614543449184469*^9, {3.614545738357164*^9, 
   3.614545751438102*^9}, 3.6145539650685472`*^9, 3.6146140636151257`*^9, 
   3.61461428924856*^9, 3.6146146289457407`*^9, 3.6146157553981752`*^9, 
   3.6146160734655457`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reynolds stresses", "Section",
 CellChangeTimes->{{3.614953263774658*^9, 3.614953267580805*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "conj", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conj", "[", 
   RowBox[{"Dot", "[", 
    RowBox[{"b_", ",", "a__"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"conj", "[", 
    RowBox[{"Dot", "[", "a", "]"}], "]"}], ".", 
   RowBox[{"conj", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conj", "[", "1", "]"}], ":=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"redvars", " ", "=", 
   RowBox[{"{", 
    RowBox[{"u", ",", "\[Zeta]", ",", "b", ",", "\[Eta]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vectorVars", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"iLap2", ",", "dz", ",", "iLapFColl"}], "}"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Variables", " ", "that", " ", "are", " ", "vectors", " ", "in", " ", 
    RowBox[{"c", "++"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"variablesInCpp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ky", "\[Rule]", "\"\<kyctmp_\>\""}], ",", 
     RowBox[{"kxb", "\[Rule]", "\"\<kxctmp_\>\""}], ",", 
     RowBox[{"dz", "\[Rule]", "\"\<kz_\>\""}], ",", 
     RowBox[{"q", "\[Rule]", "\"\<q_\>\""}], ",", 
     RowBox[{"iLap2", "\[Rule]", "\"\<ilap2tmp_.cast<dcmplx>()\>\""}]}], 
    "}"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.614968353291263*^9, 3.614968356609688*^9}, {
  3.614968839320692*^9, 3.614968842306284*^9}, {3.61496997567763*^9, 
  3.614969980805501*^9}, {3.6150280583916807`*^9, 3.615028080506551*^9}, {
  3.615032673957727*^9, 3.61503269163594*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["k", "y"], "\[Rule]", "\<\"kyctmp_\"\>"}], ",", 
   RowBox[{
    OverscriptBox[
     SubscriptBox["k", "x"], "\[LongDash]"], "\[Rule]", "\<\"kxctmp_\"\>"}], 
   ",", 
   RowBox[{
    SubscriptBox["\[PartialD]", "z"], "\[Rule]", "\<\"kz_\"\>"}], ",", 
   RowBox[{"q", "\[Rule]", "\<\"q_\"\>"}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[EmptyUpTriangle]", "2"], 
     RowBox[{"-", "1"}]], "\[Rule]", "\<\"ilap2tmp_.cast<dcmplx>()\"\>"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.615028082251027*^9, 3.6150326932688217`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xv", ",", "xpv", ",", "uv", ",", "bv", ",", "\[IndentingNewLine]", 
      "reynoldsStressesLabels", ",", "\[IndentingNewLine]", "kfun", ",", 
      "fourierRules", ",", "derivRules", ",", "dot1Rule", ",", "conjRules", 
      ",", "\[IndentingNewLine]", "toOrrSomerVarsReynolds", ",", "toCijRules",
       ",", "\[IndentingNewLine]", "coeffList", ",", "cppVariables", ",", 
      "\[IndentingNewLine]", "vecPreVarStringList", ",", 
      "scalarPreVarStringList", ",", "vectorPreVarQ", ",", "scalarPreVarQ", 
      ",", "\[IndentingNewLine]", "CppToBasicVariables", ",", 
      "fullCppVaribles", ",", "tmp", ",", "\[IndentingNewLine]", 
      "classVariableDec", ",", "classConstrAssignMem", ",", 
      "assignCppVarsInEqs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"xv", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xpv", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uv", " ", "=", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ux", ",", "uy", ",", "uz"}], "}"}], "@@", "#"}], "]"}], 
        "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bv", " ", "=", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bx", ",", "by", ",", "bz"}], "}"}], "@@", "#"}], "]"}], 
        "&"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"reynoldsStressesLabels", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<// Bx reynolds stress\\n\>\"", ",", 
         "\"\<// By reynolds stress\\n\>\"", ",", 
         "\"\<// Ux reynolds stress\\n\>\"", ",", 
         "\"\<// Uy reynolds stress\\n\>\""}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reynoldsStresses", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"bz", "@@", "xv"}], " ", 
            RowBox[{"ux", "@@", "xpv"}]}], "-", 
           RowBox[{
            RowBox[{"bx", "@@", "xv"}], " ", 
            RowBox[{"uz", "@@", "xpv"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"bz", "@@", "xv"}], " ", 
            RowBox[{"uy", "@@", "xpv"}]}], "-", 
           RowBox[{
            RowBox[{"by", "@@", "xv"}], " ", 
            RowBox[{"uz", "@@", "xpv"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               RowBox[{"Grad", "[", 
                RowBox[{
                 RowBox[{"uv", "[", "xv", "]"}], ",", "xv"}], "]"}], ".", 
               RowBox[{"uv", "[", "xpv", "]"}]}]}], "+", 
             RowBox[{
              RowBox[{"Grad", "[", 
               RowBox[{
                RowBox[{"bv", "[", "xv", "]"}], ",", "xv"}], "]"}], ".", 
              RowBox[{"bv", "[", "xpv", "]"}]}]}], ")"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               RowBox[{"Grad", "[", 
                RowBox[{
                 RowBox[{"uv", "[", "xv", "]"}], ",", "xv"}], "]"}], ".", 
               RowBox[{"uv", "[", "xpv", "]"}]}]}], "+", 
             RowBox[{
              RowBox[{"Grad", "[", 
               RowBox[{
                RowBox[{"bv", "[", "xv", "]"}], ",", "xv"}], "]"}], ".", 
              RowBox[{"bv", "[", "xpv", "]"}]}]}], ")"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}], 
        "\[IndentingNewLine]", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"f_", "@@", "xv"}], " ", 
          RowBox[{"g_", "@@", "xpv"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"f", "@@", "xv"}], " ", ".", " ", 
          RowBox[{"g", "@@", "xpv"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kfun", "[", 
        RowBox[{"xn_", ",", "yn_", ",", "zn_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"kxb", "^", "xn"}], ".", 
        RowBox[{"ky", "^", "yn"}], ".", 
        RowBox[{"dz", "^", "zn"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fourierRules", " ", "=", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "ds__", "]"}], "[", "f_", "]"}], "@@", 
           "xv"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"kfun", "[", "ds", "]"}], ".", 
           RowBox[{"f", "@@", "xv"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", "ds__", "]"}], "[", "f_", "]"}], "@@", 
           "xpv"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"f", "@@", "xpv"}], ".", 
           RowBox[{"conj", "[", 
            RowBox[{"kfun", "[", "ds", "]"}], "]"}]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dot1Rule", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"1", ",", "k__"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Dot", "[", "k", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"k__", ",", "1"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Dot", "[", "k", "]"}]}]}], "}"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Removes", " ", "1", " ", "from", " ", "dot", " ", "product"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Reynolds", " ", "stress", " ", "in", " ", "original", " ", 
        "variables", " ", "n"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reynoldsStresses", "=", 
       RowBox[{
        RowBox[{"reynoldsStresses", "/.", "fourierRules"}], "//.", 
        "dot1Rule"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Rules", " ", "to", " ", "put", " ", "into", " ", "reduced", " ", 
        "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"toOrrSomerVarsReynolds", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ux", "@@", "xv"}], "\[Rule]", "u"}], ",", 
         RowBox[{
          RowBox[{"uy", "@@", "xv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"kxb", ".", "ky", ".", "iLap2", ".", "u"}]}], "+", 
           RowBox[{"dz", ".", "iLap2", ".", "\[Zeta]"}]}]}], ",", 
         RowBox[{
          RowBox[{"uz", "@@", "xv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"kxb", ".", "dz", ".", "iLap2", ".", "u"}]}], "-", 
           RowBox[{"ky", ".", "iLap2", ".", "\[Zeta]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bx", "@@", "xv"}], "\[Rule]", "b"}], ",", 
         RowBox[{
          RowBox[{"by", "@@", "xv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"kxb", ".", "ky", ".", "iLap2", ".", "b"}]}], "+", 
           RowBox[{"dz", ".", "iLap2", ".", "\[Eta]"}]}]}], ",", 
         RowBox[{
          RowBox[{"bz", "@@", "xv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"kxb", ".", "dz", ".", "iLap2", ".", "b"}]}], "-", 
           RowBox[{"ky", ".", "iLap2", ".", "\[Eta]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ux", "@@", "xpv"}], "\[Rule]", "u"}], ",", 
         RowBox[{
          RowBox[{"uy", "@@", "xpv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"u", ".", 
             RowBox[{"conj", "[", 
              RowBox[{"kxb", ".", "ky", ".", "iLap2"}], "]"}]}]}], "+", 
           RowBox[{"\[Zeta]", ".", 
            RowBox[{"conj", "[", 
             RowBox[{"dz", ".", "iLap2"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"uz", "@@", "xpv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"u", ".", 
             RowBox[{"conj", "[", 
              RowBox[{"kxb", ".", "dz", ".", "iLap2"}], "]"}]}]}], "-", 
           RowBox[{"\[Zeta]", ".", 
            RowBox[{"conj", "[", 
             RowBox[{"ky", ".", "iLap2"}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bx", "@@", "xpv"}], "\[Rule]", "b"}], ",", 
         RowBox[{
          RowBox[{"by", "@@", "xpv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"b", ".", 
             RowBox[{"conj", "[", 
              RowBox[{"kxb", ".", "ky", ".", "iLap2"}], "]"}]}]}], "+", 
           RowBox[{"\[Eta]", ".", 
            RowBox[{"conj", "[", 
             RowBox[{"dz", ".", "iLap2"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"bz", "@@", "xpv"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"b", ".", 
             RowBox[{"conj", "[", 
              RowBox[{"kxb", ".", "dz", ".", "iLap2"}], "]"}]}]}], "-", 
           RowBox[{"\[Eta]", ".", 
            RowBox[{"conj", "[", 
             RowBox[{"ky", ".", "iLap2"}], "]"}]}]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conjRules", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"conj", "[", "kxb", "]"}], "\[Rule]", 
          RowBox[{"-", "kxb"}]}], ",", 
         RowBox[{
          RowBox[{"conj", "[", "ky", "]"}], "\[Rule]", 
          RowBox[{"-", "ky"}]}], ",", 
         RowBox[{
          RowBox[{"conj", "[", "dz", "]"}], "\[Rule]", 
          RowBox[{"-", "dz"}]}], ",", 
         RowBox[{
          RowBox[{"conj", "[", "iLap2", "]"}], "\[Rule]", "iLap2"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Put", " ", "into", " ", "Orr"}], "-", 
        RowBox[{"Somerfeld", " ", "variables"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"reynoldsStresses", " ", "=", " ", 
       RowBox[{"TensorExpand", "[", 
        RowBox[{
         RowBox[{"reynoldsStresses", "/.", "toOrrSomerVarsReynolds"}], "/.", 
         "conjRules"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Convert", " ", "to", " ", "Cij"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"toCijRules", " ", "=", " ", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"a___", ",", "v1", ",", "v2", ",", "b___"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"v1", ",", "redvars"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v2", ",", "redvars"}], "}"}]}], "]"}]}], 
         "\[RuleDelayed]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Dot", "[", 
              RowBox[{"a", ",", 
               RowBox[{"Cm", "[", 
                RowBox[{"i", ",", "j"}], "]"}], ",", "b"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "redvars", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "redvars", "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Put", " ", "into", " ", "canonical", " ", "form", " ", "by", " ", 
        "converting", " ", "dot", " ", "to", " ", "times"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"reynoldsStresses", "=", 
       RowBox[{
        RowBox[{"reynoldsStresses", "/.", "toCijRules"}], "/.", 
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"Cm", "[", "i__", "]"}], ",", "b___"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"Times", "[", "a", "]"}], ",", 
           RowBox[{"Cm", "[", "i", "]"}], ",", 
           RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Find", " ", "coefficients", " ", "to", " ", "precalculate"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"coeffList", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Union", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{"reynoldsStresses", ",", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"coeff1_", ",", " ", 
                RowBox[{"Cm", "[", 
                 RowBox[{"i1_", ",", "i2_"}], "]"}], ",", "coeff2_"}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"coeff1", ",", "coeff2"}], "}"}]}], ",", 
             "\[Infinity]"}], "]"}]}]}], ",", 
         RowBox[{"1", "|", 
          RowBox[{"-", "1"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coeffList", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{"coeff_", "\[RuleDelayed]", 
           RowBox[{"Rule", "[", 
            RowBox[{"coeff", ",", 
             RowBox[{"\"\<rey_\>\"", "<>", 
              RowBox[{"convertProdToString", "[", "coeff", "]"}]}]}], 
            "]"}]}]}], "&"}], "/@", "coeffList"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeffList", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"coeffList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", 
             RowBox[{
             "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ">", 
            RowBox[{"StringLength", "[", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}]}], "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cppVariables", " ", "=", " ", 
       RowBox[{"coeffList", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Cm", "/:", 
       RowBox[{"toCString", "[", 
        RowBox[{"Cm", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], "]"}], ":=", 
       RowBox[{"\"\<C\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<_\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Convert", " ", "everything", " ", "to", " ", "a", " ", "cpp", " ", 
        "string"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reynoldsStresses", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"reynoldsStresses", "/.", "coeffList"}], "/.", 
          RowBox[{
           RowBox[{"Cm", "[", "i__", "]"}], "\[RuleDelayed]", 
           RowBox[{"toCString", "[", 
            RowBox[{"Cm", "[", "i", "]"}], "]"}]}]}], "//.", "dot1Rule"}], "/.", 
        RowBox[{
         RowBox[{"a_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"cppVariables", ",", "a"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"a", "<>", "\"\<.asDiagonal()\>\""}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reynoldsStresses", " ", "=", " ", 
       RowBox[{
        RowBox[{"reynoldsStresses", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"a_", ",", "C_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{
            "a", "<>", "\"\<*\>\"", "<>", "C", "<>", "\"\<*\>\"", "<>", 
             "b"}]}], ",", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"C_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"C", "<>", "\"\<*\>\"", "<>", "b"}]}], ",", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{"a_", ",", "C_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"a", "<>", "\"\<*\>\"", "<>", "C"}]}]}], "}"}]}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"a_String", "+", "b_String"}], "\[RuleDelayed]", 
           RowBox[{"a", "<>", "\"\<+\>\"", "<>", "b"}]}], ",", 
          RowBox[{
           RowBox[{"a_String", "-", "b_String"}], "\[RuleDelayed]", 
           RowBox[{"a", "<>", "\"\<-\>\"", "<>", "b"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Assign", " ", "to", " ", "reynolds_mat", "_tmp", " ", 
        RowBox[{"(", 
         RowBox[{"need", " ", "to", " ", "take", " ", "fft", " ", "later"}], 
         ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reynoldsStresses", "=", 
       RowBox[{
        RowBox[{"StringJoin", "@@", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#1", "<>", "\"\<reynolds_mat_tmp_ = \>\"", "<>", "#2"}], "&"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"reynoldsStressesLabels", ",", "reynoldsStresses"}], 
              "}"}]}], "]"}], ",", "\"\<;\\n\\n\\n\>\""}], "]"}]}], "<>", 
        "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Now", " ", "assign", " ", "to", " ", "the", " ", "temporary", " ", 
       "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Form", " ", "the", " ", "variable", " ", "definitions"}], " ",
        "-", " ", 
       RowBox[{
       "the", " ", "functions", " ", "here", " ", "are", " ", "for", " ", 
        "pre"}], "-", 
       RowBox[{"defined", " ", "variables", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", ".", "g", "."}], ",", " ", "kxctmp_"}], ")"}], " ", 
        "not", " ", "the", " ", "automatically", " ", "generated", " ", 
        "ones"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vecPreVarStringList", " ", "=", 
      RowBox[{
       RowBox[{"List", "@@", "vectorVars"}], "/.", "variablesInCpp"}]}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "vector", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scalarPreVarStringList", " ", "=", " ", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"variablesInCpp", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        "vecPreVarStringList"}], "]"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "vector", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vectorPreVarQ", " ", "=", " ", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "vecPreVarStringList", "]"}], ";",
            "vecPreVarStringList"}], ")"}], ",", "#"}], "]"}], "&"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Returns", " ", "true", " ", "for", " ", "vector", " ", "variable"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scalarPreVarQ", " ", "=", " ", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", "scalarPreVarStringList", "]"}], 
           ";", "scalarPreVarStringList"}], ")"}], ",", "#"}], "]"}], " ", 
       "&"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Returns", " ", "true", " ", "for", " ", "scalar", " ", "variable"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Collect", " ", "matrix", " ", "bits", " ", "together"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{"Reverse", "/@", "coeffList"}], ")"}], "/.", 
          "variablesInCpp"}], "/.", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "?", "vectorPreVarQ"}], "^", "n_"}], 
          "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tmp", " ", "=", " ", 
             RowBox[{"a", "<>", "\"\<.pow(\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<)\>\""}]}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"vecPreVarStringList", ",", "tmp"}], "]"}], ";", "tmp"}],
            ")"}]}]}], "/.", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"a_", "?", "vectorPreVarQ"}], "  ", 
          RowBox[{"b_", "?", "vectorPreVarQ"}]}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<(\>\"", "<>", "a", "<>", "\"\<*\>\"", "<>", "b", "<>", 
          "\"\<).matrix()\>\""}]}]}], "/.", 
       RowBox[{
        RowBox[{"a_", "?", "vectorPreVarQ"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", "\"\<.matrix()\>\""}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Collect", " ", "scalar", " ", "bits", " ", "together"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"fullCppVaribles", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"a_", "?", "scalarPreVarQ"}], "^", "n_"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"tmp", "=", 
              RowBox[{"\"\<pow(\>\"", "<>", 
               RowBox[{"ToString", "[", "a", "]"}], "<>", "\"\<,\>\"", "<>", 
               RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<)\>\""}]}], 
             ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"scalarPreVarStringList", ",", "tmp"}], "]"}], ";", 
             "tmp"}], ")"}]}]}], "/.", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "?", "scalarPreVarQ"}], " ", 
           RowBox[{"b_", "?", "scalarPreVarQ"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"scalarPreVarStringList", ",", 
              RowBox[{
              "\"\<(\>\"", "<>", "a", "<>", "\"\<*\>\"", "<>", "b", "<>", 
               "\"\<)\>\""}]}], "]"}], ";", 
            RowBox[{
            "\"\<(\>\"", "<>", "a", "<>", "\"\<*\>\"", "<>", "b", "<>", 
             "\"\<)\>\""}]}], ")"}]}]}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{"n_", "?", "NumericQ"}], " ", 
          RowBox[{"a_", "?", "scalarPreVarQ"}]}], "\[RuleDelayed]", 
         RowBox[{"\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "n", "]"}], "]"}], "<>", "\"\<*\>\"", "<>", "a", 
          "<>", "\"\<)\>\""}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"n_", "?", "NumericQ"}], " ", "b_String"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"N", "[", "n", "]"}], "]"}], "<>", "\"\<*\>\"", "<>", 
         "b"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fullCppVaribles", " ", "=", " ", 
      RowBox[{"fullCppVaribles", "/.", 
       RowBox[{
        RowBox[{"a_String", " ", "b_String"}], "\[RuleDelayed]", 
        RowBox[{"a", "<>", "\"\<*\>\"", "<>", "b"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Declare", " ", "in", " ", "class", " ", "definition"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"classVariableDec", " ", "=", " ", 
      RowBox[{"\"\<dcmplxVecM \>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"Row", "[", 
         RowBox[{"cppVariables", ",", "\"\<, \>\""}], "]"}]}], "<>", 
       "\"\<;\\n\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "memory", " ", "to", " ", "variables", " ", "in", " ", 
       "class", " ", "constructor"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"classConstrAssignMem", " ", "=", 
      RowBox[{
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< = dcmplxVecM(NZ_);\\n\>\""}], "&"}], "/@",
           "cppVariables"}], ")"}]}], "<>", "\"\<\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "variables", " ", "inside", " ", "the", " ", 
       "equations"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"assignCppVarsInEqs", " ", "=", 
      RowBox[{
      "\"\<// Vector variable definition Reynolds stress (automatic)\\n\>\"", 
       "<>", " ", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "<>", "\"\< = \>\"", " ", "<>", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "<>", "\"\<;\\n\>\""}], "&"}], "/@", "fullCppVaribles"}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"fullSavedOutputReynolds", " ", "=", " ", 
      RowBox[{
      "\"\<// Automatically generated temporary variables - class \
definition\\n\>\"", "<>", "\[IndentingNewLine]", "classVariableDec", "<>", 
       "\"\<\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
       "\"\<// Automatically generated temporary variables - class \
constructor\\n\>\"", "<>", "\[IndentingNewLine]", "classConstrAssignMem", 
       "<>", "\"\<\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
       "\"\<//Assign automatically generated variables in equations \\n\>\"", 
       "<>", "\[IndentingNewLine]", "assignCppVarsInEqs", "<>", 
       "\"\<\\n\\n\\n\>\"", "<>", "\[IndentingNewLine]", 
       "\"\<////////////////////////////////////////////////////////\\n\>\"", 
       "<>", "\[IndentingNewLine]", 
       "\"\<///  AUTOMATICALLY GENERATED REYNOLDS STRESSES      /////\\n\>\"",
        "<>", "\[IndentingNewLine]", 
       "\"\<///       see GenerateC++Equations.nb in MMA        /////\\n\\n\>\
\"", "<>", "\[IndentingNewLine]", "reynoldsStresses", "<>", 
       "\[IndentingNewLine]", 
       "\"\</// AUTOMATICALLY GENERATED REYNOLDS STRESSES - END /////\\n\>\"",
        "<>", "\[IndentingNewLine]", 
       "\"\<////////////////////////////////////////////////////////\\n\>\""}]\
}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
    "SAVE", " ", "ALL", " ", "THIS", " ", "STUFF", " ", "TO", " ", "FILE"}], 
    " ", "*)"}],
   FontColor->RGBColor[0.5, 0, 0.5]]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<~/Documents/MRIDSS/Mathematica/MMA_Generated_ReynoldsStresses.cpp\>\"",
    ",", "\[IndentingNewLine]", "fullSavedOutputReynolds", ",", 
   "\[IndentingNewLine]", "\"\<Text\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.614954140890256*^9, 3.614954254156444*^9}, {
   3.614954297234413*^9, 3.614954359170815*^9}, {3.614954507173497*^9, 
   3.614954691598151*^9}, {3.614966271743904*^9, 3.614966384474889*^9}, {
   3.614966420658431*^9, 3.614966468833269*^9}, {3.614966521538568*^9, 
   3.614966525648926*^9}, {3.614966556973939*^9, 3.614966558812303*^9}, {
   3.614966893756914*^9, 3.614966978883154*^9}, {3.614967025194991*^9, 
   3.614967070065365*^9}, {3.614967106601871*^9, 3.614967109658472*^9}, {
   3.614967212517124*^9, 3.614967254546564*^9}, {3.614967327599065*^9, 
   3.6149674446627607`*^9}, {3.614967513779579*^9, 3.6149676977936573`*^9}, {
   3.6149678355333023`*^9, 3.614967862002326*^9}, {3.614968897435368*^9, 
   3.6149689936592093`*^9}, 3.614969101219598*^9, {3.614969195092318*^9, 
   3.614969286658963*^9}, {3.614969553946069*^9, 3.6149697213403883`*^9}, {
   3.614969752777896*^9, 3.614969757008914*^9}, {3.614969792086261*^9, 
   3.6149698527982073`*^9}, {3.614970138027603*^9, 3.6149701684432383`*^9}, {
   3.614970361085209*^9, 3.614970361555359*^9}, {3.6149705706398973`*^9, 
   3.6149705940414667`*^9}, {3.614970634895241*^9, 3.614970642807794*^9}, {
   3.614970698416541*^9, 3.614970709359087*^9}, {3.61497091702547*^9, 
   3.6149709201656637`*^9}, {3.614971058131727*^9, 3.6149711955476437`*^9}, {
   3.614971242060709*^9, 3.614971355236931*^9}, {3.614971472920533*^9, 
   3.6149716486922626`*^9}, {3.6149717360409603`*^9, 3.614971737671545*^9}, 
   3.614971773686449*^9, {3.6149718752630367`*^9, 3.61497205271235*^9}, {
   3.614972131149613*^9, 3.614972284262714*^9}, {3.614972315801504*^9, 
   3.614972318552045*^9}, {3.614972379225976*^9, 3.6149723837526283`*^9}, {
   3.614972414206048*^9, 3.614972423614871*^9}, {3.6149869890088453`*^9, 
   3.61498704598812*^9}, {3.6149873751290197`*^9, 3.614987468381742*^9}, {
   3.614987538417439*^9, 3.614987566004695*^9}, {3.614987615994206*^9, 
   3.6149876199139*^9}, {3.614987669528802*^9, 3.6149877570853233`*^9}, {
   3.614987850734271*^9, 3.6149878879390907`*^9}, {3.6150274066311073`*^9, 
   3.615027666723768*^9}, {3.615027702115666*^9, 3.615027755156046*^9}, {
   3.615028018055396*^9, 3.615028047983551*^9}, {3.615028093241024*^9, 
   3.6150283358942623`*^9}, {3.615028394058867*^9, 3.615028687939126*^9}, {
   3.615028731522182*^9, 3.615028731672833*^9}, {3.615028784139933*^9, 
   3.615028814207711*^9}, {3.615028892339262*^9, 3.615028922359234*^9}, {
   3.6150293281934977`*^9, 3.615029344930874*^9}, {3.6150294321851873`*^9, 
   3.6150294882932367`*^9}, {3.615029551919859*^9, 3.615029595320745*^9}, {
   3.615029695557748*^9, 3.6150297378843193`*^9}, {3.615029869125358*^9, 
   3.6150298723884563`*^9}, {3.615029912896887*^9, 3.615029925075115*^9}, {
   3.61502995690983*^9, 3.615029971830276*^9}, 3.615030249915057*^9, {
   3.6150302990319557`*^9, 3.6150303154977713`*^9}, {3.615030358476726*^9, 
   3.615030367335416*^9}, {3.615030410950201*^9, 3.615030528064905*^9}, {
   3.615030560444873*^9, 3.615030676804809*^9}, {3.615031455139426*^9, 
   3.615031528050686*^9}, {3.615031566790921*^9, 3.6150315683092747`*^9}, {
   3.615036379847866*^9, 3.6150364794466343`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.615029595993595*^9, {3.615029712175734*^9, 3.615029738702917*^9}, 
   3.6150298308186693`*^9, 3.615030536672903*^9, {3.615030568803341*^9, 
   3.6150305833510027`*^9}, 3.615030644992588*^9, 3.615030678927168*^9, 
   3.615031531480201*^9, 3.615031569368704*^9, 3.6150326956315928`*^9, 
   3.615036537181931*^9}],

Cell[BoxData["\<\"~/Documents/MRIDSS/Mathematica/MMA_Generated_\
ReynoldsStresses.cpp\"\>"], "Output",
 CellChangeTimes->{
  3.615029595993595*^9, {3.615029712175734*^9, 3.615029738702917*^9}, 
   3.6150298308186693`*^9, 3.615030536672903*^9, {3.615030568803341*^9, 
   3.6150305833510027`*^9}, 3.615030644992588*^9, 3.615030678927168*^9, 
   3.615031531480201*^9, 3.615031569368704*^9, 3.6150326956315928`*^9, 
   3.615036537185924*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.615031428745222*^9, 3.615031439820664*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1404, 1062},
WindowMargins->{{1345, Automatic}, {Automatic, 18}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 105, 1, 92, "Title"],
Cell[687, 25, 239, 4, 81, "Subtitle"],
Cell[CellGroupData[{
Cell[951, 33, 179, 3, 80, "Section",
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[1155, 40, 271, 5, 35, "Subsubsection",
 InitializationGroup->True],
Cell[1429, 47, 17484, 447, 1554, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18950, 499, 207, 3, 29, "Subsubsection",
 InitializationGroup->True],
Cell[19160, 504, 8230, 214, 369, "Input",
 InitializationGroup->True],
Cell[27393, 720, 355, 7, 49, "Text"],
Cell[27751, 729, 4867, 129, 335, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[32655, 863, 107, 1, 29, "Subsubsection"],
Cell[32765, 866, 4665, 116, 335, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37479, 988, 105, 1, 80, "Section"],
Cell[37587, 991, 299, 8, 34, "Text"],
Cell[CellGroupData[{
Cell[37911, 1003, 104, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[38040, 1008, 20323, 503, 893, "Input"],
Cell[58366, 1513, 8593, 238, 113, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[67008, 1757, 223, 4, 36, "Subsection"],
Cell[CellGroupData[{
Cell[67256, 1765, 3564, 86, 148, "Input"],
Cell[70823, 1853, 2281, 51, 28, "Output"],
Cell[73107, 1906, 26441, 688, 267, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[99597, 2600, 165, 3, 36, "Subsection"],
Cell[CellGroupData[{
Cell[99787, 2607, 176, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[99988, 2614, 2634, 68, 182, "Input"],
Cell[102625, 2684, 1175, 26, 35, "Output"],
Cell[103803, 2712, 1220, 27, 42, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105072, 2745, 282, 5, 35, "Subsubsection"],
Cell[105357, 2752, 30431, 709, 1814, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135825, 3466, 174, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[136024, 3472, 18319, 397, 1202, "Input"],
Cell[154346, 3871, 951, 14, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[155370, 3893, 156, 2, 80, "Section"],
Cell[155529, 3897, 398, 10, 34, "Text"],
Cell[CellGroupData[{
Cell[155952, 3911, 104, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[156081, 3916, 20707, 510, 893, "Input"],
Cell[176791, 4428, 19932, 553, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[196772, 4987, 223, 4, 36, "Subsection"],
Cell[CellGroupData[{
Cell[197020, 4995, 3564, 86, 148, "Input"],
Cell[200587, 5083, 2350, 52, 70, "Output"],
Cell[202940, 5137, 59146, 1522, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[262135, 6665, 165, 3, 36, "Subsection"],
Cell[CellGroupData[{
Cell[262325, 6672, 176, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[262526, 6679, 2634, 68, 182, "Input"],
Cell[265163, 6749, 2985, 80, 57, "Output"],
Cell[268151, 6831, 1290, 28, 42, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[269490, 6865, 282, 5, 29, "Subsubsection"],
Cell[269775, 6872, 30380, 708, 1797, "Input"],
Cell[CellGroupData[{
Cell[300180, 7584, 134, 2, 28, "Input"],
Cell[300317, 7588, 1318, 36, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[301684, 7630, 174, 2, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[301883, 7636, 18562, 400, 1151, "Input"],
Cell[320448, 8038, 1030, 15, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[321551, 8061, 102, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[321678, 8066, 1624, 40, 148, "Input"],
Cell[323305, 8108, 611, 17, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323953, 8130, 30927, 711, 1815, "Input"],
Cell[354883, 8843, 370, 6, 28, "Output"],
Cell[355256, 8851, 437, 7, 28, "Output"]
}, Open  ]],
Cell[355708, 8861, 92, 1, 28, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
