(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    102039,       2767]
NotebookOptionsPosition[    100276,       2701]
NotebookOutlinePosition[    100631,       2717]
CellTagsIndexPosition[    100588,       2714]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generate c++ equations", "Title",
 CellChangeTimes->{{3.613285659385439*^9, 3.613285672183166*^9}}],

Cell["\<\
A notebook to automatically generate the complex equations (in c++ syntax) \
required for CE2 implementations of the shearing box MHD equations\
\>", "Subtitle",
 CellChangeTimes->{{3.613285678399642*^9, 3.6132857387259073`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.61328575477813*^9, 3.6132857579772587`*^9}, {
  3.613289305138309*^9, 3.6132893099360237`*^9}}],

Cell[CellGroupData[{

Cell["Load packages, set notation", "Subsubsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.61328647880902*^9, 3.6132864845926*^9}, {
  3.61328657764961*^9, 3.613286579073427*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "Notation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Notation`AutoLoadNotationPalette", "}"}], ",", "\n", "\t", 
     
     RowBox[{
      RowBox[{"Notation`AutoLoadNotationPalette", "=", "False"}], ";", "\n", 
      "\t", 
      RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], ";"}]}], "\n", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{OverscriptBox["\[Nu]", "\[Dash]"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"\[Nu]b"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{OverscriptBox["\[Eta]", "\[LongDash]"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"\[Eta]b"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"iLap2"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"iLapF"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["\[PartialD]", "z"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"dz"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["\[PartialD]", "t"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"dt"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[ScriptCapitalR]", "x"], "B"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ReyBx"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SuperscriptBox[
         SubscriptBox["\[ScriptCapitalR]", "y"], "B"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ReyBy"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["B", "x"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"Bx"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["B", "y"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"By"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["B", "z0"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"B0z"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["k", "y"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ky"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["k", "x"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"kx"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"kxb"},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{"\[SmallCircle]"},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{"ph"},
       "NotationTemplateTag"]}], "]"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Place", "-", 
     RowBox[{
     "holder", " ", "for", " ", "the", " ", "operator", " ", "matrix"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"C", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Notation", "[", 
     RowBox[{
      TemplateBox[{SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"a_", "\[InvisibleComma]", "b_"}]]},
       "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
      TemplateBox[{RowBox[{"Cm", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}]},
       "NotationTemplateTag"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "iLapF", ",", " ", "iLap2", ",", " ", "dz", ",", " ", "dt", ",", " ", 
     "properties"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "iLap2"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"iLap2", "[", "a", "]"}], "+", " ", 
      RowBox[{"iLap2", "[", "b", "]"}]}]}], ";", " ", 
    RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"kxb", "^", "n"}], " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
      "security"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"ky", "^", "n"}], " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"iLap2", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLap2", "[", 
      RowBox[{"dz", "[", "a_", "]"}], "]"}], ":=", 
     RowBox[{"dz", "[", 
      RowBox[{"iLap2", "[", "a", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "dz"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"dz", "[", "a", "]"}], "+", " ", 
      RowBox[{"dz", "[", "b", "]"}]}]}], ";", " ", 
    RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["kxb", "n"], " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
      "security"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"ky", "^", "n"}], " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"dz", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Product", " ", 
     RowBox[{"rule", " ", "--"}], " ", "could", " ", "add", " ", "this"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "dt"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"dt", "[", "a", "]"}], "+", " ", 
      RowBox[{"dt", "[", "b", "]"}]}]}], ";", " ", 
    RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"dt", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"kxb", "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"q", " ", "ky", " ", "a"}], "+", " ", 
      RowBox[{"kxb", " ", 
       RowBox[{"dt", "[", "a", "]"}]}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
      "security"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["ky", "n"], " ", 
      RowBox[{"dt", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"dt", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Goes", " ", "inside", " ", "iLap2", " ", "and", " ", "dz"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"dz", "[", "a_", "]"}], "]"}], ":=", 
     RowBox[{"dz", "[", 
      RowBox[{"dt", "[", "a", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", "[", 
      RowBox[{"iLap2", "[", "a_", "]"}], "]"}], ":=", 
     RowBox[{"iLap2", "[", 
      RowBox[{"dt", "[", "a", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "iLapF"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{"a_", "+", "b_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"iLapF", "[", "a", "]"}], "+", " ", 
      RowBox[{"iLapF", "[", "b", "]"}]}]}], ";", " ", 
    RowBox[{"(*", "Linear", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"c_", "?", "NumericQ"}], " ", "a_"}], "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Commutes", " ", "with", " ", "derivatives"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"kxb", "^", "n"}], " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Put", " ", "down", " ", "ks", " ", "explicitly", " ", "for", " ", 
      "security"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"ky", "^", "n_."}], "  ", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"ky", "^", "n"}], " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{"q", "  ", "a_"}], "]"}], ":=", 
     RowBox[{"q", " ", 
      RowBox[{"iLapF", "[", "a", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.613286581090721*^9, 3.613286689545772*^9}, {
   3.613286889064035*^9, 3.613286908104281*^9}, {3.6132869482086487`*^9, 
   3.613287077374654*^9}, {3.613287138618946*^9, 3.613287140299769*^9}, {
   3.613287639148213*^9, 3.61328770120146*^9}, {3.613287743803678*^9, 
   3.613287773644068*^9}, {3.613288296843178*^9, 3.6132883066816053`*^9}, {
   3.613289870472352*^9, 3.6132898912000837`*^9}, {3.61328995953846*^9, 
   3.613290012328433*^9}, {3.613290091978758*^9, 3.613290110587739*^9}, {
   3.613291002983233*^9, 3.613291016787397*^9}, {3.613291128786306*^9, 
   3.613291140328432*^9}, {3.613291418191675*^9, 3.6132914298902397`*^9}, {
   3.613291787958507*^9, 3.613291883632246*^9}, {3.6132919180813*^9, 
   3.613291942156289*^9}, {3.613292008007991*^9, 3.613292106813635*^9}, {
   3.613293045356043*^9, 3.6132930675783167`*^9}, 3.613293376925857*^9, 
   3.613294621138084*^9, {3.613294694017054*^9, 3.6132947784060097`*^9}, {
   3.613294902803031*^9, 3.6132949806439133`*^9}, 3.6132950396930437`*^9, {
   3.613295346076227*^9, 3.613295481543404*^9}, {3.6132960472516212`*^9, 
   3.613296061097188*^9}, {3.6132961003100023`*^9, 3.613296118980667*^9}, {
   3.613297482407709*^9, 3.6132974934385366`*^9}, {3.613300728518897*^9, 
   3.613300783695135*^9}, {3.613304633293589*^9, 3.613304670793342*^9}, {
   3.613305007338643*^9, 3.613305011424444*^9}, {3.613305054166004*^9, 
   3.613305169291284*^9}, {3.6133262584563932`*^9, 3.613326328142644*^9}, {
   3.613327278627614*^9, 3.613327286046043*^9}, {3.613327328030073*^9, 
   3.613327350931031*^9}, {3.613327392030846*^9, 3.613327432040532*^9}, {
   3.6133292064048977`*^9, 3.613329250947644*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Full incompressible nonlinear equations\
\>", "Subsubsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.613285885535736*^9, 3.613285889538149*^9}, {
  3.613286361952444*^9, 3.613286368230513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Standard", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xtv", "=", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xv", "=", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fullNLvars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "ux", ",", "uy", ",", "uz", ",", "bx", ",", "by", ",", "bz", ",", "p"}],
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"momeqn", ",", "adveqn", ",", "uv", ",", "Bv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uv", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "q"}], " ", "x"}], ",", "0"}], "}"}], "+", 
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ux", ",", "uy", ",", "uz"}], "}"}], "@@", "xtv"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "B0z"}], "}"}], "+", 
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bx", ",", "by", ",", "bz"}], "}"}], "@@", "xtv"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"momeqn", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"uv", ",", "t"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{"uv", ",", "xv"}], "]"}], ".", "uv"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "uv"}], 
            "]"}]}]}], "\[Equal]", 
         RowBox[{
          RowBox[{"-", " ", 
           RowBox[{"Grad", "[", 
            RowBox[{
             RowBox[{"p", "@@", "xtv"}], ",", "xv"}], "]"}]}], "+", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"Grad", "[", 
             RowBox[{"Bv", ",", "xv"}], "]"}], ".", "Bv"}], ")"}], "+", 
          RowBox[{"2", " ", "q", " ", "x", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "+", 
          RowBox[{"\[Nu]b", " ", 
           RowBox[{"Laplacian", "[", 
            RowBox[{"uv", ",", "xv"}], "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"adveqn", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Bv", ",", "t"}], "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"Curl", "[", 
             RowBox[{
              RowBox[{"Cross", "[", 
               RowBox[{"uv", ",", "Bv"}], "]"}], ",", "xv"}], "]"}], "+", 
            RowBox[{
             RowBox[{"1", "/", "ReB"}], " ", 
             RowBox[{"Laplacian", "[", 
              RowBox[{"Bv", ",", "xv"}], "]"}]}]}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"adveqn", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"Bv", ",", "t"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{"Bv", ",", "xv"}], "]"}], ".", "uv"}]}], "==", 
         RowBox[{
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{"uv", ",", "xv"}], "]"}], ".", "Bv"}], "+", 
          RowBox[{"\[Eta]b", " ", 
           RowBox[{"Laplacian", "[", 
            RowBox[{"Bv", ",", "xv"}], "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullNLeqns", " ", "=", " ", 
       RowBox[{"Subtract", "@@@", 
        RowBox[{"Join", "[", 
         RowBox[{"momeqn", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Div", "[", 
             RowBox[{"uv", ",", "xv"}], "]"}], "\[Equal]", "0"}], "}"}], ",", 
          "adveqn", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Div", "[", 
             RowBox[{"Bv", ",", "xv"}], "]"}], "\[Equal]", "0"}], "}"}]}], 
         "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Translation", " ", "to", " ", "Orr"}], "-", 
     RowBox[{"Somerfeld", " ", "variables"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toOrrSomerVars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ux", "\[Rule]", "u"}], ",", "\[IndentingNewLine]", 
       RowBox[{"uy", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", "ky", " ", 
             RowBox[{"u", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}], "+", 
            RowBox[{"dz", "[", 
             RowBox[{"\[Zeta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "]"}]}], "  ", "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"uz", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", 
             RowBox[{"dz", "[", 
              RowBox[{"u", "[", 
               RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
            RowBox[{"ky", " ", 
             RowBox[{"\[Zeta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}]}], "]"}]}], "  ", "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"bx", "\[Rule]", "b"}], ",", "\[IndentingNewLine]", 
       RowBox[{"by", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", "ky", " ", 
             RowBox[{"b", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}], "+", 
            RowBox[{"dz", "[", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "]"}]}], "  ", "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"bz", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "t"}], "}"}], ",", 
          RowBox[{"iLap2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "kxb"}], " ", 
             RowBox[{"dz", "[", 
              RowBox[{"b", "[", 
               RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
            RowBox[{"ky", " ", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"z", ",", "t"}], "]"}]}]}], "]"}]}], "  ", "]"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.6132862687853317`*^9, 3.613286292131226*^9}, {
   3.613286330331258*^9, 3.613286331235854*^9}, {3.613286373825049*^9, 
   3.613286475100573*^9}, {3.613286523742776*^9, 3.613286574022657*^9}, {
   3.6132867177659683`*^9, 3.613286844785708*^9}, {3.6132873426960707`*^9, 
   3.613287392767021*^9}, {3.613287431872316*^9, 3.613287444161961*^9}, {
   3.61328749525042*^9, 3.6132874981609697`*^9}, 3.6132875535430107`*^9, {
   3.613287602021194*^9, 3.613287632745328*^9}, {3.613287713936445*^9, 
   3.61328773864904*^9}, {3.6132877787380657`*^9, 3.613288005757513*^9}, {
   3.613288060071485*^9, 3.6132881345693483`*^9}, {3.613288346385255*^9, 
   3.6132883794041157`*^9}, {3.613288504050708*^9, 3.6132885207745028`*^9}, {
   3.6132887600893497`*^9, 3.613288768182979*^9}, {3.6132888149004593`*^9, 
   3.613288846333804*^9}, {3.613291099035706*^9, 3.613291118427603*^9}, {
   3.613291553896966*^9, 3.6132916298613873`*^9}, {3.613291661000248*^9, 
   3.6132917251562147`*^9}, {3.613294580957465*^9, 3.613294612091785*^9}}],

Cell["\<\
Generate rules to cancel iLap2 with kz and ky -- This \
doesn\[CloseCurlyQuote]t manage (ky^2+kz^2)^2 *iLap2^2 but only in diffusion?
Also, write down rule for iLapF\
\>", "Text",
 CellChangeTimes->{{3.613300877715733*^9, 3.613300900090197*^9}, {
  3.613301616734581*^9, 3.613301651038678*^9}, {3.613305186229371*^9, 
  3.6133052083324423`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"baseExplicitLap2Rule", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"dz", "[", 
      RowBox[{"dz", "[", 
       RowBox[{"iLap2", "[", "f_", "]"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"ky", "^", "2"}], " ", 
      RowBox[{"iLap2", "[", "f_", "]"}]}]}], "\[RuleDelayed]", " ", "f"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", "combinations", ",", "r2l", ",", 
      "l2r", ",", "kyf", ",", "baseRule", ",", "operateOnRule"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Operates", " ", "with", " ", "dz", " ", "and", " ", "ky", " ", "to", 
      " ", "generalize", " ", "rule"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Generate", " ", "the", " ", "possible", " ", "combinations"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r2l", " ", "=", " ", 
      RowBox[{"RuleDelayed", "\[Rule]", "List"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"l2r", " ", "=", " ", 
      RowBox[{"List", "\[Rule]", "RuleDelayed"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kyf", " ", "=", " ", 
      RowBox[{
       RowBox[{"ky", " ", "#"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"combinations", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "order"}], "]"}], ",", "2"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a_", ",", "b_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"a", "+", "b"}], "\[LessEqual]", "order"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"combinations", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"dz", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"kyf", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "]"}]}], "}"}], "]"}], "&"}], "/@", "combinations"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "combinations", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"#", "&"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Function", " ", "to", " ", "operate", " ", "on", " ", "both", " ", 
       "sides", " ", "of", " ", "base", " ", "rule", " ", "with", " ", "a", 
       " ", "chosen", " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"baseRule", "=", 
      RowBox[{"baseExplicitLap2Rule", "/.", "r2l"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"operateOnRule", " ", "=", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rule", ",", "func"}], "}"}], ",", 
        RowBox[{"(*", " ", 
         RowBox[{
         "func", " ", "is", " ", "function", " ", "with", " ", "which", " ", 
          "to", " ", "operate", " ", "of", " ", "each", " ", "side"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "/@", 
         RowBox[{"Expand", "/@", 
          RowBox[{"func", "/@", "rule"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"explicitLap2Rule", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "/.", "l2r"}], "&"}], "/@", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c_.", ",", "c"}], "}"}], " ", "#"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Fold", "[", 
             RowBox[{"operateOnRule", ",", "baseRule", ",", "#"}], "]"}], 
            "&"}], "/@", "combinations"}], ")"}]}], "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"explicitLapFRule", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"kxb", "^", "2"}], " ", "f_"}], "]"}], "+", 
     RowBox[{"iLapF", "[", 
      RowBox[{
       RowBox[{"ky", "^", "2"}], " ", "f_"}], "]"}], "+", 
     RowBox[{"iLapF", "[", 
      RowBox[{"dz", "[", 
       RowBox[{"dz", "[", "f_", "]"}], "]"}], "]"}]}], "\[RuleDelayed]", 
    "f"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.613301578032633*^9, 3.613301578138397*^9}, {
  3.6133016143342333`*^9, 3.613301614494217*^9}, {3.613305212858172*^9, 
  3.6133052855307627`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Useful functions", "Subsubsection",
 CellChangeTimes->{{3.613289315465055*^9, 3.613289319164629*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Better", " ", "version", " ", "of", " ", "linearize"}], ",", " ", 
    RowBox[{
    "works", " ", "on", " ", "expressions", " ", "in", " ", "denominator", 
     " ", "and", " ", "multiple", " ", "variables"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"Remove", "[", "linearize", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"linearize", "[", 
     RowBox[{"expr_", ",", "vars_List", ",", "indvars_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dlist", ",", "fullvars", ",", "t"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"create", " ", "full", " ", "list"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dlist", "=", 
        RowBox[{"Permutations", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"indvars", ",", "4"}], "]"}], "]"}], ",", "4"}], "]"}]}], 
       ";", 
       RowBox[{"fullvars", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"vars", "@@", "indvars"}], "]"}], ",", 
             RowBox[{"Sequence", "@@", "#"}]}], "]"}], "&"}], "/@", "dlist"}],
          "]"}]}], ";", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"expr", "/.", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "->", 
                 RowBox[{"t", " ", "#"}]}], "&"}], "/@", "fullvars"}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
         RowBox[{"t", "->", "1"}]}], "]"}]}]}], "\n", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "@", "plusToList"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plusToList", "::", "unrecExpr"}], " ", "=", " ", 
     "\"\<Warning: head is not Times, Plus or Symbol\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plusToList", "[", "expr_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "expr", "]"}], "===", "Plus"}], ",", " ", 
       RowBox[{"List", "@@", "expr"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "expr", "]"}], "===", "Times"}], " ", "||", 
          RowBox[{
           RowBox[{"Head", "[", "expr", "]"}], "===", "Symbol"}]}], ",", 
         RowBox[{"{", "expr", "}"}], ",", " ", 
         RowBox[{"Message", "[", 
          RowBox[{"plusToList", "::", "unrecExpr"}], "]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.61328934611686*^9, 3.613289382147559*^9}, {
  3.613291155498661*^9, 3.6132911618903112`*^9}, {3.6133280970501957`*^9, 
  3.6133283216730957`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic Quasi-linear", "Section",
 CellChangeTimes->{{3.6132857813215227`*^9, 3.613285785435519*^9}}],

Cell[TextData[{
 "Quasi-linear equations including only interactions of fluctuations with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "y"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.613285788264741*^9, 3.613285816975567*^9}, {
  3.6132858538148127`*^9, 3.613285857694859*^9}}],

Cell[CellGroupData[{

Cell["Derive equations", "Subsection",
 CellChangeTimes->{{3.613285862743395*^9, 3.613285865310978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zt", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"z", ",", "t"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanFields", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "By", ",", "0", ",", "0"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullMFeqns", " ", "=", " ", 
    RowBox[{"Subtract", "@@@", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"Bx", "@@", "zt"}], ",", "t"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"ReyBx", "@@", "zt"}], "+", 
         RowBox[{"\[Eta]b", " ", 
          RowBox[{"Bx", "@@", "zt"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"By", "@@", "zt"}], ",", "t"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q"}], " ", 
          RowBox[{"Bx", "@@", "zt"}]}], "+", 
         RowBox[{"ReyBy", "@@", "zt"}], "+", 
         RowBox[{"\[Eta]b", " ", 
          RowBox[{"By", "@@", "zt"}]}]}]}], ",", "0"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plug", " ", "in", " ", "mean", " ", "field"}], " ", "+", " ", 
    RowBox[{
    "fluctuations", " ", "into", " ", "NL", " ", "equations", " ", "and", " ",
      "linearize"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NL2fluct", ",", "fourierRules"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NL2fluct", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "fullNLvars", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "meanFields", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "@@", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "t"}], "}"}]}], "+", 
               RowBox[{
                RowBox[{
                "fullNLvars", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "@@", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}]}]}], "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0", "[", "__", "]"}], ")"}], "\[Rule]", "0"}]}], 
             "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "fullNLvars", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Plug", " ", "in", " ", "to", " ", "full", " ", "equations", " ", 
        "and", " ", "linearize"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"linearize", "[", 
          RowBox[{"#", ",", "fullNLvars", ",", "xtv"}], "]"}], "&"}], "/@", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"fullNLeqns", "/.", "NL2fluct"}], "/.", 
          RowBox[{"B0z", "\[Rule]", "0"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "fullFluctEqs", " ", "still", " ", "contain", " ", "a", " ", "mean", 
        " ", "field", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Shearing", " ", "wave", " ", "expansion"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fourierRules", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "var", "}"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"var", "\[Rule]", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"Evaluate", "@", "xtv"}], ",", 
              RowBox[{
               RowBox[{"var", "[", 
                RowBox[{"z", ",", "t"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"kx", "+", 
                    RowBox[{"q", " ", "t", " ", "ky"}]}], ")"}], "x"}], " ", 
                 "+", " ", 
                 RowBox[{"\[ImaginaryI]", " ", "ky", " ", "y"}]}], "]"}]}]}], 
             "]"}]}], "]"}]}], "]"}], "/@", "fullNLvars"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fullFluctEqs", "/.", "fourierRules"}], ")"}], "/", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"kx", "+", 
              RowBox[{"q", " ", "t", " ", "ky"}]}], ")"}], "x"}], " ", "+", 
           " ", 
           RowBox[{"\[ImaginaryI]", " ", "ky", " ", "y"}]}], "]"}]}], "]"}]}],
       ";", 
      RowBox[{"(*", 
       RowBox[{
       "Shearing", " ", "wave", " ", "in", " ", "x", " ", "and", " ", "y"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{"fullFluctEqs", "/.", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["k", "x"], "+", 
              RowBox[{
               SubscriptBox["k", "y"], " ", "q", " ", "t"}]}], ")"}], " ", 
            "x"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            SubscriptBox["k", "y"], " ", "y"}]}]], "\[Rule]", "0"}]}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Remove", " ", "mean", " ", "components"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fullFluctEqs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"fullFluctEqs", "/.", 
          RowBox[{"kx", "\[Rule]", 
           RowBox[{"kxb", "-", 
            RowBox[{"q", " ", "t", " ", "ky"}]}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kxb", "\[Rule]", 
            RowBox[{"kxb", "/", "\[ImaginaryI]"}]}], ",", 
           RowBox[{"ky", "\[Rule]", 
            RowBox[{"ky", "/", "\[ImaginaryI]"}]}]}], "}"}]}], "//", 
        "Expand"}]}]}]}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Use", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "_"]}], "=", 
      RowBox[{
       SubscriptBox["k", "x"], "+", 
       RowBox[{
        SubscriptBox["qtk", "y"], " ", "as", " ", "in", " ", 
        RowBox[{"c", "++"}], " ", "code"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Derive", " ", "Orr"}], "-", 
     RowBox[{"Somerfeld", " ", "like", " ", "equations"}]}], ",", " ", 
    RowBox[{
     RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "reduce", " ", 
     "other", " ", "equations"}], ",", " ", 
    RowBox[{
    "just", " ", "write", " ", "down", " ", "equations", " ", "for", " ", 
     RowBox[{"Lap", "[", "u", "]"}]}], ",", "\[Zeta]", ",", "b", ",", 
    "\[Eta]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"derivRules", ",", "LapMGradDiv1", ",", "manualSub"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"derivRules", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"n_", ",", "m_"}], "]"}], "[", "a_", "]"}], "[", "vs__", 
         "]"}], "\[RuleDelayed]", 
        RowBox[{"Nest", "[", 
         RowBox[{"dt", ",", 
          RowBox[{"Nest", "[", 
           RowBox[{"dz", ",", 
            RowBox[{"a", "[", "vs", "]"}], ",", "n"}], "]"}], ",", "m"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LapMGradDiv1", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kxb", "^", "2"}], "+", 
            RowBox[{"ky", "^", "2"}]}], ")"}], 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "z", ",", "z"}], "]"}], "-", 
         RowBox[{"kxb", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kxb", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"ky", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              ",", "z"}], "]"}]}], ")"}]}]}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"finalEqs", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"iLapF", "[", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"LapMGradDiv1", "[", 
                 RowBox[{"fullFluctEqs", "/.", 
                  RowBox[{"\[Nu]b", "\[Rule]", "0"}]}], "]"}], "/.", 
                "derivRules"}], "/.", "toOrrSomerVars"}], "]"}], "//.", 
             "explicitLap2Rule"}], "]"}], "/.", "explicitLapFRule"}], "//", 
          "Expand"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                 "fullFluctEqs", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "-", 
               RowBox[{"ky", " ", 
                RowBox[{
                "fullFluctEqs", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Nu]b", "\[Rule]", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "fullFluctEqs", "\[LeftDoubleBracket]", "5", 
               "\[RightDoubleBracket]"}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Eta]b", "\[Rule]", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                 "fullFluctEqs", "\[LeftDoubleBracket]", "6", 
                  "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "-", 
               RowBox[{"ky", " ", 
                RowBox[{
                "fullFluctEqs", "\[LeftDoubleBracket]", "7", 
                 "\[RightDoubleBracket]"}]}]}], "/.", "derivRules"}], "/.", 
             "toOrrSomerVars"}], "]"}], "//.", "explicitLap2Rule"}], "/.", 
          RowBox[{"\[Eta]b", "\[Rule]", "0"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Fix", " ", "these", " ", "up", " ", "manually"}], " ", "-", 
        " ", 
        RowBox[{"sometimes", " ", "much", " ", "easier"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"This", " ", "is", " ", "plugging", " ", "in", " ", 
         RowBox[{"iLapF", "[", "lapF", "]"}]}], " ", "=", " ", 
        RowBox[{
        "1", " ", "in", " ", "the", " ", "more", " ", "complicated", " ", 
         "situation"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"finalEqs", "=", 
       RowBox[{"finalEqs", "/.", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"-", "ky"}], " ", 
           RowBox[{"iLapF", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["kxb", "2"], " ", "#"}], "+", 
                  RowBox[{
                   RowBox[{"ky", "^", "2"}], " ", "#"}], "+", 
                  RowBox[{"D", "[", 
                   RowBox[{"#", ",", "z", ",", "z"}], "]"}]}], ")"}], "&"}], 
               "[", 
               RowBox[{
                RowBox[{"b", "[", 
                 RowBox[{"z", ",", "t"}], "]"}], " ", 
                RowBox[{"By", "[", 
                 RowBox[{"z", ",", "t"}], "]"}]}], "]"}], ")"}], "/.", 
             "derivRules"}], "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"-", " ", "ky"}], " ", 
          RowBox[{"b", "[", 
           RowBox[{"z", ",", "t"}], "]"}], 
          RowBox[{"By", "[", 
           RowBox[{"z", ",", "t"}], "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", ",", " ", 
    RowBox[{"form", " ", "the", " ", "A", " ", "matrix"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"redvars", " ", "=", 
   RowBox[{"{", 
    RowBox[{"u", ",", "\[Zeta]", ",", "b", ",", "\[Eta]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"finalEqs", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"finalEqs", "\[Equal]", "0"}], "]"}], ",", 
       RowBox[{"dt", "/@", 
        RowBox[{"(", 
         RowBox[{"Through", "[", 
          RowBox[{"redvars", "@@", 
           RowBox[{"{", 
            RowBox[{"z", ",", "t"}], "}"}]}], "]"}], ")"}]}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Solve", " ", "for", " ", "time"}], "-", "derivatives"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Aop", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "var", "}"}], ",", 
           RowBox[{
            RowBox[{"Plus", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"var", "[", 
                    RowBox[{"z", ",", "t"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
                  "#", ",", 
                  RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"plusToList", "@", 
                 RowBox[{
                 "finalEqs", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], "]"}]}], "/.", 
            RowBox[{
             RowBox[{"var", "[", 
              RowBox[{"z", ",", "t"}], "]"}], "\[Rule]", "ph"}]}]}], "]"}], "/@",
          "redvars"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}], "//", 
    "MatrixForm"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "matches", " ", "my", " ", "previously", " ", "derived", " ", 
    
    RowBox[{"(", 
     RowBox[{"by", " ", "hand"}], ")"}], " ", "version"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.613288323045455*^9, 3.613288326117752*^9}, {
   3.613288389643783*^9, 3.613288407039393*^9}, {3.613288479968417*^9, 
   3.613288487728981*^9}, {3.613288573589717*^9, 3.613288752358992*^9}, {
   3.613288852631976*^9, 3.613288916198966*^9}, {3.613288986990489*^9, 
   3.6132891926695137`*^9}, {3.613289423308837*^9, 3.613289432319971*^9}, {
   3.613289540309534*^9, 3.613289551704471*^9}, {3.613289593180532*^9, 
   3.613289597516069*^9}, {3.6132897828569527`*^9, 3.613289799551094*^9}, {
   3.613289832684938*^9, 3.613289857392364*^9}, {3.613289899387167*^9, 
   3.613289949003064*^9}, {3.613290022566579*^9, 3.613290072980708*^9}, {
   3.6132901333440037`*^9, 3.6132902277049723`*^9}, {3.613290347360075*^9, 
   3.613290348877283*^9}, {3.613290407662169*^9, 3.6132904199021072`*^9}, {
   3.613290617515009*^9, 3.613290693570179*^9}, {3.6132907374778633`*^9, 
   3.613290807808112*^9}, {3.6132911924799023`*^9, 3.613291195598812*^9}, {
   3.6132912379815063`*^9, 3.613291248693972*^9}, {3.613291280284522*^9, 
   3.613291408458893*^9}, {3.613291458080309*^9, 3.613291470927746*^9}, {
   3.6132915090035563`*^9, 3.613291525286358*^9}, {3.6132921232255783`*^9, 
   3.613292144859001*^9}, {3.613292297867838*^9, 3.613292316012755*^9}, 
   3.6132930883268547`*^9, {3.613293312306075*^9, 3.61329333079275*^9}, {
   3.6133006141405077`*^9, 3.61330070673322*^9}, {3.613300799309185*^9, 
   3.613300851120187*^9}, {3.613300912016116*^9, 3.6133009327016172`*^9}, {
   3.6133010023231773`*^9, 3.613301012699256*^9}, {3.6133010441561947`*^9, 
   3.613301156627*^9}, 3.6133013078550577`*^9, {3.613301447081024*^9, 
   3.613301449877001*^9}, {3.6133015415117207`*^9, 3.6133015541220617`*^9}, {
   3.6133016618658733`*^9, 3.613301704111124*^9}, {3.61330185743235*^9, 
   3.613301871088355*^9}, {3.613301910782558*^9, 3.6133019246441307`*^9}, {
   3.613301999871911*^9, 3.6133020708752737`*^9}, {3.61330239110786*^9, 
   3.613302487596188*^9}, {3.613302551646475*^9, 3.61330262406814*^9}, {
   3.6133045173899403`*^9, 3.6133045479377737`*^9}, {3.6133047488389683`*^9, 
   3.6133047694867353`*^9}, {3.613304829996623*^9, 3.613304868581319*^9}, {
   3.613304943519965*^9, 3.613304948407606*^9}, {3.6133053005957613`*^9, 
   3.613305319748056*^9}, {3.6133261571880493`*^9, 3.613326178299334*^9}, {
   3.613326367599222*^9, 3.613326560664708*^9}, {3.613326591582814*^9, 
   3.613326696955864*^9}, {3.613327160076173*^9, 3.613327161075317*^9}, {
   3.61332757642347*^9, 3.613327611115761*^9}, {3.613327657453199*^9, 
   3.613327813791049*^9}, {3.61332805091748*^9, 3.6133280531810827`*^9}, {
   3.613328083202976*^9, 3.613328090811761*^9}, 3.613328347059229*^9, {
   3.613328833019064*^9, 3.6133288553167562`*^9}, {3.6133291560666847`*^9, 
   3.613329177719489*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["k", "y"], " ", "q", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}], 
        "]"}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "F"], 
          RowBox[{"-", "1"}]], "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SubscriptBox["B", "y"], "[", 
            RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "z"], "[", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["\[EmptyUpTriangle]", "2"], 
             RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], 
         "]"}]}]}], 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}], 
       "+", 
       RowBox[{"q", " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}]}], 
      "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         OverscriptBox[
          SubscriptBox["k", "x"], "\[LongDash]"]}], " ", "\[SmallCircle]", 
        " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "-", 
       RowBox[{
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}]},
     {
      RowBox[{
       SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}]}], "0", "0", "0"},
     {
      RowBox[{
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}], "]"}]}],
        "+", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "-", 
       RowBox[{
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], " ", 
        SubsuperscriptBox["k", "y", "2"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["k", "y"], " ", "\[SmallCircle]", " ", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}], "]"}]}], "+", 
       RowBox[{
        SubscriptBox["k", "y"], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", "\[SmallCircle]", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "q"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", "\[SmallCircle]", "]"}]}], 
      "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.613304869590173*^9, 3.6133049495007257`*^9, 3.6133053207405367`*^9, {
   3.613326485387342*^9, 3.613326561490202*^9}, {3.613326595815199*^9, 
   3.6133266040226097`*^9}, 3.613326660026622*^9, 3.61332716201223*^9, {
   3.6133275947793913`*^9, 3.613327612121537*^9}, {3.613327744727991*^9, 
   3.613327815555489*^9}, 3.613328054239262*^9, 3.613328356531164*^9, 
   3.613328856170669*^9, {3.613329165606255*^9, 3.613329178601987*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Working out the matrix product, and getting things into a \
\[OpenCurlyDoubleQuote]code convenient\[CloseCurlyDoubleQuote] form\
\>", "Subsection",
 CellChangeTimes->{{3.613329080723421*^9, 3.613329105297495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Cmat", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Cm", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "redvars"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "redvars"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Aop", "\[LeftDoubleBracket]", 
       RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "/.", 
      RowBox[{"ph", "->", 
       RowBox[{"Cmat", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "4"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.613329190586266*^9, 3.6133292017039127`*^9}, {
   3.61332925694532*^9, 3.613329273682445*^9}, 3.613329310966958*^9, {
   3.613329357281271*^9, 3.613329377913746*^9}, {3.613329411297574*^9, 
   3.6133294207854643`*^9}, {3.613329494526471*^9, 3.613329541412135*^9}, {
   3.613329620555998*^9, 3.613329725917181*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"u", "\[InvisibleComma]", "u"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"u", "\[InvisibleComma]", "b"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Zeta]", "\[InvisibleComma]", "u"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Zeta]", "\[InvisibleComma]", "b"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Eta]"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"u", "\[InvisibleComma]", "u"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"b", "\[InvisibleComma]", "b"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Eta]", "\[InvisibleComma]", "u"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Zeta]"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Eta]", "\[InvisibleComma]", "b"}]], ",", 
     SubscriptBox["\[ScriptCapitalC]", 
      RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.613329261804503*^9, 3.613329378653151*^9, {3.613329414156465*^9, 
   3.613329421491866*^9}, 3.613329541853962*^9, 3.6133296794782133`*^9, {
   3.61332971641582*^9, 3.61332972665462*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"u", "\[InvisibleComma]", "u"}]]}], "-", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["k", "y"], " ", "q", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "u"}]], "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", 
           SubscriptBox["\[ScriptCapitalC]", 
            RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}], "]"}]}], "]"}]}],
       "+", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"\[Eta]", "\[InvisibleComma]", "u"}]], "]"}]}], "]"}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]]}], "-", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["k", "y"], " ", "q", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}], 
        "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", 
           SubscriptBox["\[ScriptCapitalC]", 
            RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}], 
          "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}], 
        "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"b", "\[InvisibleComma]", "b"}]]}], "-", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["k", "y"], " ", "q", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "b"}]], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "b"}]], "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", 
           SubscriptBox["\[ScriptCapitalC]", 
            RowBox[{"b", "\[InvisibleComma]", "b"}]], "]"}], "]"}]}], "]"}]}],
       "+", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"\[Eta]", "\[InvisibleComma]", "b"}]], "]"}]}], "]"}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]]}], "-", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["k", "y"], " ", "q", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}], "]"}]}],
       "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        OverscriptBox[
         SubscriptBox["k", "x"], "\[LongDash]"], "2"], " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[EmptyUpTriangle]", "2"], 
            RowBox[{"-", "1"}]], "[", 
           SubscriptBox["\[ScriptCapitalC]", 
            RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}], 
          "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "F"], 
         RowBox[{"-", "1"}]], "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "[", 
          RowBox[{
           SubscriptBox["B", "y"], "[", 
           RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}], 
        "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Eta]", "\[InvisibleComma]", "u"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"u", "\[InvisibleComma]", "u"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}]}], "+", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}], "]"}]}], "-", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Eta]", "\[InvisibleComma]", "u"}]], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Zeta]"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}], "+", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}], 
        "]"}]}], "-", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}]}], ",", 
     
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Eta]", "\[InvisibleComma]", "b"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"b", "\[InvisibleComma]", "b"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "b"}]], "]"}]}], "+", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "b"}]], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"b", "\[InvisibleComma]", "b"}]], "]"}], "]"}]}], "-", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Eta]", "\[InvisibleComma]", "b"}]], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}], "+", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}], "]"}]}], 
      "-", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["k", "y"], " ", 
      RowBox[{
       SubscriptBox["B", "y"], "[", 
       RowBox[{"z", ",", "t"}], "]"}], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"u", "\[InvisibleComma]", "u"}]]}], ",", 
     RowBox[{
      SubscriptBox["k", "y"], " ", 
      RowBox[{
       SubscriptBox["B", "y"], "[", 
       RowBox[{"z", ",", "t"}], "]"}], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]]}], ",", 
     RowBox[{
      SubscriptBox["k", "y"], " ", 
      RowBox[{
       SubscriptBox["B", "y"], "[", 
       RowBox[{"z", ",", "t"}], "]"}], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"u", "\[InvisibleComma]", "b"}]]}], ",", 
     RowBox[{
      SubscriptBox["k", "y"], " ", 
      RowBox[{
       SubscriptBox["B", "y"], "[", 
       RowBox[{"z", ",", "t"}], "]"}], " ", 
      SubscriptBox["\[ScriptCapitalC]", 
       RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Zeta]", "\[InvisibleComma]", "u"}]]}], "-", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}]}], "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}], "]"}], "]"}]}], 
      "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "u"}]], "]"}], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "u"}]], "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Zeta]", "\[InvisibleComma]", "u"}]], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]]}], "-", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}], "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]], "]"}], "]"}], 
        "]"}]}], "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]], "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}], 
        "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Zeta]"}]], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Zeta]", "\[InvisibleComma]", "b"}]]}], "-", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"b", "\[InvisibleComma]", "b"}]], "]"}]}], "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"u", "\[InvisibleComma]", "b"}]], "]"}], "]"}], "]"}]}], 
      "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"u", "\[InvisibleComma]", "b"}]], "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "b"}]], "]"}], "]"}]}], "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "b"}]], "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Zeta]", "\[InvisibleComma]", "b"}]], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["B", "y"], "[", 
        RowBox[{"z", ",", "t"}], "]"}], " ", 
       SubscriptBox["\[ScriptCapitalC]", 
        RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Eta]"}]]}], "-", 
      RowBox[{"q", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Eta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}], "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[EmptyUpTriangle]", "2"], 
           RowBox[{"-", "1"}]], "[", 
          SubscriptBox["\[ScriptCapitalC]", 
           RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]], "]"}], "]"}], 
        "]"}]}], "+", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]], "]"}], "]"}]}], "+", 
      
      RowBox[{"2", " ", 
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[EmptyUpTriangle]", "2"], 
          RowBox[{"-", "1"}]], "[", 
         SubscriptBox["\[ScriptCapitalC]", 
          RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}], "]"}]}],
       "-", 
      RowBox[{
       OverscriptBox[
        SubscriptBox["k", "x"], "\[LongDash]"], " ", 
       SubsuperscriptBox["k", "y", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["B", "y"], "[", 
         RowBox[{"z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"u", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "y"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "[", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "[", 
         RowBox[{
          SubscriptBox["B", "y"], "[", 
          RowBox[{"z", ",", "t"}], "]"}], "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[EmptyUpTriangle]", "2"], 
         RowBox[{"-", "1"}]], "[", 
        SubscriptBox["\[ScriptCapitalC]", 
         RowBox[{"\[Zeta]", "\[InvisibleComma]", "\[Eta]"}]], "]"}]}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.613329261804503*^9, 3.613329378653151*^9, {3.613329414156465*^9, 
   3.613329421491866*^9}, 3.613329541853962*^9, 3.6133296794782133`*^9, {
   3.61332971641582*^9, 3.613329726660356*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cmat", "//", "InputForm"}]], "Input",
 CellChangeTimes->{{3.613330074509778*^9, 3.613330090996269*^9}}],

Cell["\<\
{{Cm[u, u], Cm[u, \[Zeta]], Cm[u, b], Cm[u, \[Eta]]}, {Cm[\[Zeta], u], Cm[\
\[Zeta], \[Zeta]], Cm[\[Zeta], b], Cm[\[Zeta], \[Eta]]}, 
 {Cm[u, u], Cm[\[Zeta], \[Zeta]], Cm[b, b], Cm[\[Eta], \[Eta]]}, {Cm[\[Eta], \
u], Cm[\[Eta], \[Zeta]], Cm[\[Eta], b], Cm[\[Eta], \[Eta]]}}\
\>", "Output",
 CellChangeTimes->{{3.613330076044711*^9, 3.613330091329919*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SubValues", "[", "Cm", "]"}]], "Input",
 CellChangeTimes->{{3.613330144152809*^9, 3.613330160299967*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.6133301474209547`*^9, 3.613330161022643*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1171, 807},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 105, 1, 92, "Title"],
Cell[687, 25, 239, 4, 81, "Subtitle"],
Cell[CellGroupData[{
Cell[951, 33, 179, 3, 80, "Section",
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[1155, 40, 191, 3, 35, "Subsubsection",
 InitializationGroup->True],
Cell[1349, 45, 14608, 370, 1326, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[15994, 420, 215, 5, 35, "Subsubsection",
 InitializationGroup->True],
Cell[16212, 427, 8230, 214, 403, "Input",
 InitializationGroup->True],
Cell[24445, 643, 355, 7, 49, "Text"],
Cell[24803, 652, 4867, 129, 335, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29707, 786, 107, 1, 35, "Subsubsection"],
Cell[29817, 789, 3112, 82, 216, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32978, 877, 105, 1, 80, "Section"],
Cell[33086, 880, 332, 9, 34, "Text"],
Cell[CellGroupData[{
Cell[33443, 893, 104, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[33572, 898, 19243, 476, 842, "Input"],
Cell[52818, 1376, 8329, 234, 124, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61196, 1616, 223, 4, 44, "Subsection"],
Cell[CellGroupData[{
Cell[61444, 1624, 1188, 30, 46, "Input"],
Cell[62635, 1656, 2026, 47, 35, "Output"],
Cell[64664, 1705, 34746, 964, 442, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99447, 2674, 127, 2, 28, "Input"],
Cell[99577, 2678, 365, 6, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99979, 2689, 129, 2, 28, "Input"],
Cell[100111, 2693, 113, 2, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
